<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>PKIX Evidence for Remote Attestation of Hardware Security Modules</title>
<meta content="Mike Ounsworth" name="author">
<meta content="Jean-Pierre Fiset" name="author">
<meta content="Hannes Tschofenig" name="author">
<meta content="Henk Birkholz" name="author">
<meta content="Monty Wiseman" name="author">
<meta content="Ned Smith" name="author">
<meta content="
       This document specifies a vendor-agnostic format for evidence produced and verified within a PKIX context.
The evidence produced this way includes claims collected in a cryptographic module about itself and elements
found within it such as cryptographic keys. 
       One scenario envisaged is that the state information about the cryptographic module can be securely presented
to a remote operator or auditor in a vendor-agnostic verifiable format.
A more complex scenario would be to submit this evidence to a Certification Authority to aid in determining
whether the storage properties of this key meets the requirements of a given certificate profile. 
       This specification also offers a format for requesting a cryptographic module to produce evidence tailored for
expected use. 
    " name="description">
<meta content="xml2rfc 3.28.1" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-ietf-rats-pkix-key-attestation-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.28.1
    Python 3.12.11
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.6
    lxml 5.3.1
    platformdirs 4.3.8
    pycountry 24.6.1
    PyYAML 6.0.2
    requests 2.32.4
    setuptools 80.9.0
    wcwidth 0.2.13
-->
<link href="draft-ietf-rats-pkix-key-attestation.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl:not(.dlNewline) > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">PKIX Evidence for Remote Attestation of </td>
<td class="right">June 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Ounsworth, et al.</td>
<td class="center">Expires 18 December 2025</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">RATS</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-rats-pkix-key-attestation-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-06-16" class="published">16 June 2025</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2025-12-18">18 December 2025</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">M. Ounsworth</div>
<div class="org">Entrust</div>
</div>
<div class="author">
      <div class="author-name">J.-P. Fiset</div>
<div class="org">Crypto4A</div>
</div>
<div class="author">
      <div class="author-name">H. Tschofenig</div>
<div class="org">H-BRS</div>
</div>
<div class="author">
      <div class="author-name">H. Birkholz</div>
<div class="org">Fraunhofer SIT</div>
</div>
<div class="author">
      <div class="author-name">M. Wiseman</div>
</div>
<div class="author">
      <div class="author-name">N. Smith</div>
<div class="org">Intel Corporation</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">PKIX Evidence for Remote Attestation of Hardware Security Modules</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document specifies a vendor-agnostic format for evidence produced and verified within a PKIX context.
The evidence produced this way includes claims collected in a cryptographic module about itself and elements
found within it such as cryptographic keys.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">One scenario envisaged is that the state information about the cryptographic module can be securely presented
to a remote operator or auditor in a vendor-agnostic verifiable format.
A more complex scenario would be to submit this evidence to a Certification Authority to aid in determining
whether the storage properties of this key meets the requirements of a given certificate profile.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
<p id="section-abstract-3">This specification also offers a format for requesting a cryptographic module to produce evidence tailored for
expected use.<a href="#section-abstract-3" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        The latest revision of this draft can be found at <span><a href="https://ietf-rats-wg.github.io/key-attestation/draft-ietf-rats-pkix-key-attestation.html">https://ietf-rats-wg.github.io/key-attestation/draft-ietf-rats-pkix-key-attestation.html</a></span>.
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-ietf-rats-pkix-key-attestation/">https://datatracker.ietf.org/doc/draft-ietf-rats-pkix-key-attestation/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        RATS Working Group mailing list (<span><a href="mailto:rats@ietf.org">mailto:rats@ietf.org</a></span>),
        which is archived at <span><a href="https://datatracker.ietf.org/wg/rats/about/">https://datatracker.ietf.org/wg/rats/about/</a></span>.
        Subscribe at <span><a href="https://www.ietf.org/mailman/listinfo/rats/">https://www.ietf.org/mailman/listinfo/rats/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
<p id="section-note.1-4">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/ietf-rats-wg/key-attestation">https://github.com/ietf-rats-wg/key-attestation</a></span>.<a href="#section-note.1-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 18 December 2025.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-use-cases" class="internal xref">Use Cases</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-remote-audit-of-a-hardware-" class="internal xref">Remote audit of a Hardware Security Module (HSM)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1" class="keepWithNext"><a href="#section-2.2" class="auto internal xref">2.2</a>.  <a href="#name-key-import-and-hsm-clusteri" class="internal xref">Key import and HSM clustering</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="auto internal xref">2.3</a>.  <a href="#name-attesting-subject-of-a-cert" class="internal xref">Attesting subject of a certificate issuance</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-attestation-key-certificate" class="internal xref">Attestation Key Certificate Chain</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-information-model" class="internal xref">Information Model</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-entity" class="internal xref">Entity</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-entity-type" class="internal xref">Entity Type</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-attribute-and-attribute-typ" class="internal xref">Attribute and Attribute Type</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-data-model" class="internal xref">Data Model</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-platform-entity" class="internal xref">Platform Entity</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.1">
                    <p id="section-toc.1-1.5.2.1.2.1.1"><a href="#section-5.1.1" class="auto internal xref">5.1.1</a>.  <a href="#name-vendor" class="internal xref">vendor</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.2">
                    <p id="section-toc.1-1.5.2.1.2.2.1"><a href="#section-5.1.2" class="auto internal xref">5.1.2</a>.  <a href="#name-oemid-hwmodel-swversion-dbg" class="internal xref">oemid, hwmodel, swversion, dbgstat, uptime, bootcount</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.3">
                    <p id="section-toc.1-1.5.2.1.2.3.1"><a href="#section-5.1.3" class="auto internal xref">5.1.3</a>.  <a href="#name-hwserial" class="internal xref">hwserial</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.4">
                    <p id="section-toc.1-1.5.2.1.2.4.1"><a href="#section-5.1.4" class="auto internal xref">5.1.4</a>.  <a href="#name-usermods" class="internal xref">usermods</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.5">
                    <p id="section-toc.1-1.5.2.1.2.5.1"><a href="#section-5.1.5" class="auto internal xref">5.1.5</a>.  <a href="#name-fipsboot-fipsver-and-fipsle" class="internal xref">fipsboot, fipsver and fipslevel</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.6">
                    <p id="section-toc.1-1.5.2.1.2.6.1"><a href="#section-5.1.6" class="auto internal xref">5.1.6</a>.  <a href="#name-envid" class="internal xref">envid</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.7">
                    <p id="section-toc.1-1.5.2.1.2.7.1"><a href="#section-5.1.7" class="auto internal xref">5.1.7</a>.  <a href="#name-envdesc" class="internal xref">envdesc</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-key-entity" class="internal xref">Key Entity</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.1">
                    <p id="section-toc.1-1.5.2.2.2.1.1"><a href="#section-5.2.1" class="auto internal xref">5.2.1</a>.  <a href="#name-identifier" class="internal xref">identifier</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.2">
                    <p id="section-toc.1-1.5.2.2.2.2.1"><a href="#section-5.2.2" class="auto internal xref">5.2.2</a>.  <a href="#name-spki" class="internal xref">spki</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3">
                    <p id="section-toc.1-1.5.2.2.2.3.1"><a href="#section-5.2.3" class="auto internal xref">5.2.3</a>.  <a href="#name-purpose-extractable-sensiti" class="internal xref">purpose, extractable, sensitive, never-extractable, local</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.4">
                    <p id="section-toc.1-1.5.2.2.2.4.1"><a href="#section-5.2.4" class="auto internal xref">5.2.4</a>.  <a href="#name-expiry" class="internal xref">expiry</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.5">
                    <p id="section-toc.1-1.5.2.2.2.5.1"><a href="#section-5.2.5" class="auto internal xref">5.2.5</a>.  <a href="#name-protection" class="internal xref">protection</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-transaction-entity" class="internal xref">Transaction Entity</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.1">
                    <p id="section-toc.1-1.5.2.3.2.1.1"><a href="#section-5.3.1" class="auto internal xref">5.3.1</a>.  <a href="#name-nonce" class="internal xref">nonce</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.2">
                    <p id="section-toc.1-1.5.2.3.2.2.1"><a href="#section-5.3.2" class="auto internal xref">5.3.2</a>.  <a href="#name-timestamp" class="internal xref">timestamp</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="auto internal xref">5.4</a>.  <a href="#name-additional-entity-and-attri" class="internal xref">Additional Entity and Attribute Types</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5">
                <p id="section-toc.1-1.5.2.5.1"><a href="#section-5.5" class="auto internal xref">5.5</a>.  <a href="#name-encoding" class="internal xref">Encoding</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-signing-procedure" class="internal xref">Signing Procedure</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-verification-procedure" class="internal xref">Verification Procedure</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-appraisal-policies-and-prof" class="internal xref">Appraisal Policies and Profiles</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-key-import-into-an-hsm" class="internal xref">Key Import into an HSM</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-ca-browser-forum-code-signi" class="internal xref">CA/Browser Forum Code-Signing</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-attestation-requests" class="internal xref">Attestation Requests</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-request-attributes-with-spe" class="internal xref">Request Attributes with Specified Values</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1.2.1">
                    <p id="section-toc.1-1.9.2.1.2.1.1"><a href="#section-9.1.1" class="auto internal xref">9.1.1</a>.  <a href="#name-key-identifiers" class="internal xref">Key Identifiers</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1.2.2">
                    <p id="section-toc.1-1.9.2.1.2.2.1"><a href="#section-9.1.2" class="auto internal xref">9.1.2</a>.  <a href="#name-nonce-2" class="internal xref">Nonce</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1.2.3">
                    <p id="section-toc.1-1.9.2.1.2.3.1"><a href="#section-9.1.3" class="auto internal xref">9.1.3</a>.  <a href="#name-custom-key-selection" class="internal xref">Custom Key Selection</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1.2.4">
                    <p id="section-toc.1-1.9.2.1.2.4.1"><a href="#section-9.1.4" class="auto internal xref">9.1.4</a>.  <a href="#name-custom-transaction-attribut" class="internal xref">Custom Transaction Attribute</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.  <a href="#name-processing-an-attestation-r" class="internal xref">Processing an Attestation Request</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a href="#section-9.3" class="auto internal xref">9.3</a>.  <a href="#name-verification-by-presenter" class="internal xref">Verification by Presenter</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-asn1-module" class="internal xref">ASN.1 Module</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="auto internal xref">12</a>. <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#section-12.1" class="auto internal xref">12.1</a>.  <a href="#name-policies-relating-to-verifi" class="internal xref">Policies relating to Verifier and Relying Party</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#section-12.2" class="auto internal xref">12.2</a>.  <a href="#name-simple-to-implement" class="internal xref">Simple to Implement</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.3">
                <p id="section-toc.1-1.12.2.3.1"><a href="#section-12.3" class="auto internal xref">12.3</a>.  <a href="#name-detached-signatures" class="internal xref">Detached Signatures</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.4">
                <p id="section-toc.1-1.12.2.4.1"><a href="#section-12.4" class="auto internal xref">12.4</a>.  <a href="#name-privacy" class="internal xref">Privacy</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.5">
                <p id="section-toc.1-1.12.2.5.1"><a href="#section-12.5" class="auto internal xref">12.5</a>.  <a href="#name-authenticating-and-authoriz" class="internal xref">Authenticating and Authorizing the Presenter</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.6">
                <p id="section-toc.1-1.12.2.6.1"><a href="#section-12.6" class="auto internal xref">12.6</a>.  <a href="#name-proof-of-possession-of-user" class="internal xref">Proof-of-Possession of User Keys</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="auto internal xref">13</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a href="#section-13.1" class="auto internal xref">13.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a href="#section-13.2" class="auto internal xref">13.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-samples" class="internal xref">Samples</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-acknowledgements" class="internal xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#appendix-C" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">This specification defines a format to transmit Evidence from an Attester to a Verifer within a PKIX
environment. This environment refers to the components generally used to support a PKI applications
such as Certification Authorities and their clients, or more generally that relies upon X.509 certificates.
As outlined in <a href="#sec-terminology" class="auto internal xref">Section 3</a>, this specification uses a necessary mixture of RATS and PKI terminology
in order to map concepts between the two domains.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">Within this specification, the concepts found in the Remote Attestation Procedures (RATS <span>[<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>) are
mapped to the PKIX environment. There are many other specifications that are based on the RATS architecture
which offer formats to carry evidence. This specification deals with peculiar aspects of the PKIX environment
which make the existing evidence formats inappropriate:<a href="#section-1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-3.1">
          <p id="section-1-3.1.1">ASN.1 is the preferred encoding format in this environment. X.509 certificates (<span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>) are used
widely within this environment and the majority of tools are designed to support ASN.1. There are
many specialized devices (Hardware Security Modules) that are inflexible in adopting other formats because
of internal constraints or validation difficulties. This specification defines the format in ASN.1 to ease the
adoption within the community.<a href="#section-1-3.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-3.2">
          <p id="section-1-3.2.1">The claims within the Evidence are about internal entities such as "platforms" and "keys" which are not
necessarily distinct from the Attesting Environment. Therefore, although the concept
of "measurement" is present within the PKIX environment, it is not always clear that you have one attesting environment
measuring another distinct target environment the way it is envisioned in the RATS Architecture.
Therefore, the emphasis and structure of this specifications is adjusted accordingly.
Specifically, this specification assumes that the Attesting Environment and the Target Environment,
as outlined in <span>[<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>, are the same. This might not be the case for all devices encountered, but is
sufficient for the proposed specification.<a href="#section-1-3.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-1-4">This specification also aims at providing an extensible framework to encode within Evidence claims other than
the one proposed in this document. This allows implementations to introduce new claims and their associated
semantics to the Evidence produced.<a href="#section-1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="use-cases">
<section id="section-2">
      <h2 id="name-use-cases">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-use-cases" class="section-name selfRef">Use Cases</a>
      </h2>
<p id="section-2-1">This section covers use cases that motivated the development of this specification.<a href="#section-2-1" class="pilcrow">¶</a></p>
<div id="remote-audit-of-a-hardware-security-module-hsm">
<section id="section-2.1">
        <h3 id="name-remote-audit-of-a-hardware-">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-remote-audit-of-a-hardware-" class="section-name selfRef">Remote audit of a Hardware Security Module (HSM)</a>
        </h3>
<p id="section-2.1-1">There are situations where it is necessary to verify the current running state of a HSM as part of operational or
auditing procedures. For example, there are devices that are certified to work in an environment only if certain
versions of the firmware are loaded or only if application keys are protected in with a certain set of protection policies.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1-2">The Evidence format offered by this specification allows a platform to report its firmware level along with
other collected claims necessary in critical deployments.<a href="#section-2.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="key-import-and-hsm-clustering">
<section id="section-2.2">
        <h3 id="name-key-import-and-hsm-clusteri">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-key-import-and-hsm-clusteri" class="section-name selfRef">Key import and HSM clustering</a>
        </h3>
<p id="section-2.2-1">Consider that an HSM is being added to a logical HSM cluster. Part of the onboarding process could involve
the newly-added HSM providing proof of its running state, for example that it is a genuine device from
the same manufacturer as the existing clustered HSMs, firmware patch level, FIPS mode, etc.
It could also be required to provide attestation of any system-level keys required for secure establishment
of cluster communication. In this scenario, the Verifier and Relying Party will be the other HSMs in the cluster
deciding whether or not to admit the new HSM.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<p id="section-2.2-2">A related scenario is when performing a key export-import across HSMs.
If the key is being imported with certain properties, for example an environment running in FIPS mode at
FIPS Level 3, and the key is set to certain protection properties such as Non-Exportable and Dual-Control,
then the HSM might wish to verify that the key was previously stored under the same properties.
This specification provides a way to do this across HSM vendors.<a href="#section-2.2-2" class="pilcrow">¶</a></p>
<p id="section-2.2-3">These scenarios motivate the design requirements to have an ASN.1 based Evidence format and a data model that
more closely matches typical HSM architecture since in both scenarios
an HSM is acting as Verifier and Relying Party.<a href="#section-2.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="attesting-subject-of-a-certificate-issuance">
<section id="section-2.3">
        <h3 id="name-attesting-subject-of-a-cert">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-attesting-subject-of-a-cert" class="section-name selfRef">Attesting subject of a certificate issuance</a>
        </h3>
<p id="section-2.3-1">Prior to a Certification Authority (CA) issuing a certificate on behalf of a subject, a number of procedures
are required to verify that the subject of the certificate is associated with the key that is certified.
In some cases, such as issuing a code signing certificate <span>[<a href="#CNSA2.0" class="cite xref">CNSA2.0</a>]</span>, <span>[<a href="#codesigningbrsv3.8" class="cite xref">codesigningbrsv3.8</a>]</span>, a CA must ensure that
the subject key is located in a Hardware Security Module (HSM).<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<p id="section-2.3-2">The Evidence format offered by this specification is designed to carry the information necessary for a CA to
assess the location of the subject key along a number of commonly-required attributes. More specifically, a CA could
determine which HSM was used to generate the subject key, whether this device adheres
to certain jurisdiction policies (such as FIPS mode) and the constraints applied to the key (such as whether is it extractable).<a href="#section-2.3-2" class="pilcrow">¶</a></p>
<p id="section-2.3-3">For relatively simple HSM devices such as TPM-like devices, storage properties such as "extractable" may always be true for all keys
since the devices is not capable of key export and so the attestation could be essentially a hard-coded template asserting these
immutable attributes. However, more complex HSM devices require a more complex key attestation format that encompaseses the
mutability of these attributes.
Also, the client requesting the key attestation might wish to scope-down the content of the key attestation as
the HSM contains many keys and only a certain subset are relevant for attesting a given transaction, or only
certain claims are relevant.
Lack of ability to scope-down the key attestation contents could, in some scenarios, constitute a privacy violation.
This motivates the design choice for a key attestation request mechanism.
The same objective could have been accomplished via a selective disclosure mechanism. However, since a request
is necessary to transmit the attestation nonce to the HSM, a standardized request format fits the use case better
and is generally simpler.<a href="#section-2.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-terminology">
<section id="section-3">
      <h2 id="name-terminology">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
      </h2>
<p id="section-3-1">This specification uses a necessary mixture of RATS and PKI terminology
in order to map concepts between the two domains.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">The reader is assumed to be familiar with the vocabulary and concepts
defined in the RATS architecture (<span>[<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>) such as Attester,
Relying Party, Verifier.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">The reader is assumed to be familiar with common vocabulary and concepts
defined in <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span> such as certificate, signature, attribute, verifier.<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4">In order to avoid confusion, this document generally
capitalizes RATS terms such as Attester, Relying Party, and Claim.
Therefore, for example, a "Verifier"
should be assumed to be an entity that checks the validity of Evidence as per <span>[<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>,
whereas a "verifier" could be a more general reference to a PKI entity that checks
the validity of an X.509 certificate or other digital signature as per <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>.<a href="#section-3-4" class="pilcrow">¶</a></p>
<p id="section-3-5">The following terms are used in this document:<a href="#section-3-5" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-3-6">
        <dt id="section-3-6.1">Attestation Key (AK):</dt>
        <dd style="margin-left: 1.5em" id="section-3-6.2">
          <p id="section-3-6.2.1">Cryptographic key controlled solely by the Attester and used only for the purpose
of producing Evidence. In other words, it is used to digitally sign the claims collected by
the Attester.<a href="#section-3-6.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-3-6.3">Attestation Service (AttS):</dt>
        <dd style="margin-left: 1.5em" id="section-3-6.4">
          <p id="section-3-6.4.1">A logical module within the HSM that is responsible for generating Evidence compatible with the
format outlined in this specification. It collects claims from the platform and uses the Attestation
Key to digitally sign the collection.<a href="#section-3-6.4.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-3-6.5">Attester :</dt>
        <dd style="margin-left: 1.5em" id="section-3-6.6">
          <p id="section-3-6.6.1">The term Attester respects the definition offered in <span>[<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>. In this specification, it
is also interchangeable with "platform" or "HSM".<a href="#section-3-6.6.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-3-6.7">Evidence :</dt>
        <dd style="margin-left: 1.5em" id="section-3-6.8">
          <p id="section-3-6.8.1">The term Evidence respects the definition offered in <span>[<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>. In this specification, it
refers to claims, encoded according to the format defined within this document, and signed using
the Attestation Key.<a href="#section-3-6.8.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-3-6.9">Hardware Security Module (HSM):</dt>
        <dd style="margin-left: 1.5em" id="section-3-6.10">
          <p id="section-3-6.10.1">A physical computing device that safeguards and manages secrets, such as cryptographic keys,
and performs cryptographic operations based on those secrets.
This specification takes a broad definition of what counts as an HSM to include smartcards,
USB tokens, TPMs, cryptographic co-processors (PCI cards) and "enterprise-grade" or "cloud-service grade" HSMs
(possibly rack mounted). In this specification, it is interchangeable with "platform" or "Attester".<a href="#section-3-6.10.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-3-6.11">Key Attestation:</dt>
        <dd style="margin-left: 1.5em" id="section-3-6.12">
          <p id="section-3-6.12.1">Process of producing Evidence containing claims pertaining to application keys found within a HSM. In
general, the claims includes enough information about an application key and its hosting platform to allow
a Relying Party to make judicial decisions about the key, such as issuing a certificate.<a href="#section-3-6.12.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-3-6.13">Platform:</dt>
        <dd style="margin-left: 1.5em" id="section-3-6.14">
          <p id="section-3-6.14.1">The module or device that embodies the Attester. In this specification, it is interchangeable with
"Attester" or "HSM".<a href="#section-3-6.14.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-3-6.15">Platform Attestation:</dt>
        <dd style="margin-left: 1.5em" id="section-3-6.16">
          <p id="section-3-6.16.1">Evidence containing claims pertaining to attributes associated with the platform, itself. In general, the claims includes
enough information about the platform to allow a Relying Party to make judicial decisions about the
platform, such as audit reviews.<a href="#section-3-6.16.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-3-6.17">Presenter</dt>
        <dd style="margin-left: 1.5em" id="section-3-6.18">
          <p id="section-3-6.18.1">Role that join the HSM, in this case the Attester, and the Verifier. The
Presenter initiates the operation of generating evidence at the HSM and
passing it to the Verifier. This role is supported by a combination of
one or multiple human operators or automated processes.<a href="#section-3-6.18.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-3-6.19">Trust Anchor:</dt>
        <dd style="margin-left: 1.5em" id="section-3-6.20">
          <p id="section-3-6.20.1">As defined in <span>[<a href="#RFC6024" class="cite xref">RFC6024</a>]</span> and <span>[<a href="#RFC9019" class="cite xref">RFC9019</a>]</span>, a Trust Anchor
"represents an authoritative entity via a public key and
associated data.  The public key is used to verify digital
signatures, and the associated data is used to constrain the types
of information for which the trust anchor is authoritative." The
Trust Anchor may be a certificate, a raw public key, or other
structure, as appropriate.  It can be a non-root certificate when
it is a certificate.<a href="#section-3-6.20.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-3-6.21">Usage Protocol</dt>
        <dd style="margin-left: 1.5em" id="section-3-6.22">
          <p id="section-3-6.22.1">A (security) protocol that requires demonstrating possession of
the private component of the application key.<a href="#section-3-6.22.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-3-6.23">User Key:</dt>
        <dd style="margin-left: 1.5em" id="section-3-6.24">
          <p id="section-3-6.24.1">A user key consists of a key hosted by a HSM (the platform) and intended to be used by a client
of the HSM. Other terms used for a user key is "application key", "client key" or "operational key".
The access and operations on a user key is controlled by the HSM.<a href="#section-3-6.24.1" class="pilcrow">¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-3-7">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-3-7" class="pilcrow">¶</a></p>
<div id="sec-ak-chain">
<section id="section-3.1">
        <h3 id="name-attestation-key-certificate">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-attestation-key-certificate" class="section-name selfRef">Attestation Key Certificate Chain</a>
        </h3>
<p id="section-3.1-1">The data format in this specification represents attestation evidence and
requires third-party endorsement in order to establish trust. Part of this
endorsement is a trust anchor that chains to the HSM's attestation key (AK)
which signs the evidence. In practice the trust anchor will usually be a
manufacturing CA belonging to the device vendor which proves
that the device is genuine and not counterfeit. The trust anchor can also belong
to the device operator as would be the case when the AK certificate is replaced
as part of onboarding the device into a new operational network.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">The AK certificate that signs the evidence <span class="bcp14">MUST</span> have the Extended Key Usage
<code>id-kp-attest</code> defined in [TODO-submit-2-pager-to-lamps].<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<p id="section-3.1-3">Note that the data format specified in <a href="#sec-data-model" class="auto internal xref">Section 5</a> allows for zero, one, or multiple
'SignatureBlock's, so a single evidence statement could be un-protected, or could be endorsed by multiple
AK chains leading to different trust anchors. See <a href="#sec-verif-proc" class="auto internal xref">Section 7</a> for a discussion of handling multiple SignatureBlocks.<a href="#section-3.1-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-info-model">
<section id="section-4">
      <h2 id="name-information-model">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-information-model" class="section-name selfRef">Information Model</a>
      </h2>
<p id="section-4-1">The PKIX Evidence format is composed of two main sections:<a href="#section-4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-2.1">
          <p id="section-4-2.1.1">A claim description section which describes the information transmitted as Evidence.<a href="#section-4-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-2.2">
          <p id="section-4-2.2.1">A signature section where one ore  more digital signatures are offered to prove the origin of the
claims and maintain their integrity.<a href="#section-4-2.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-4-3">The details of the signature section is left to the data model. The remainder of this section
deals with the way the information is organized to form the claims.<a href="#section-4-3" class="pilcrow">¶</a></p>
<p id="section-4-4">The claims are organized into a set of entities to help with the organization and comprehension
of the information. Entities are elements observed in the Target Environment by the Attester.
Each entity, in turn, is associated with a set of attributes.<a href="#section-4-4" class="pilcrow">¶</a></p>
<p id="section-4-5">Therefore, the Claim description section is a set of entities and each entity is composed
of a set of attributes.<a href="#section-4-5" class="pilcrow">¶</a></p>
<div id="entity">
<section id="section-4.1">
        <h3 id="name-entity">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-entity" class="section-name selfRef">Entity</a>
        </h3>
<p id="section-4.1-1">An entity is composed of a type, the entity type, and a set of attributes. The entity type
describes the class of the entity while its attributes defines its state.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">An entity <span class="bcp14">SHOULD</span> be reported only once in a claim description. The claim description can
have multiple entities of the same type (for example reporting multiple keys), but each
entity <span class="bcp14">MUST</span> be relating to different elements.
For example, if a given application public key appears in two different entities, these
<span class="bcp14">MUST</span> be interpreted as two distinct and independent entities that happen to have the
same public key, and <span class="bcp14">MUST NOT</span> be interpreted as adding additional attributes to the
already-described entity.
This restriction is to ease the implementation of Verifiers for the provided Evidence.<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<p id="section-4.1-3">The number of entities reported in a claim description, and their respective type, is
left to the implementer. For a simple device where there is only one key, the list of
reported entities could be fixed. For larger and more complex devices, the list of
reported entities should be tailored to the demands of the Presenter.<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<p id="section-4.1-4">In particular, note that the nonce attribute contained with the Transaction entity is optional,
and therefore it is possible that an extremely simple device that holds one static key
could have its key attestation object generated at manufacture time and injected
statically into the device and acting as a kind of certificate instead of
being generated on-demand. This model would essentially
off-board the Attesting Environment to being part of the manufacturing infrastructure.<a href="#section-4.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="entity-type">
<section id="section-4.2">
        <h3 id="name-entity-type">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-entity-type" class="section-name selfRef">Entity Type</a>
        </h3>
<p id="section-4.2-1">An entity is defined by its type. This specification defines three entity types:<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-2.1">
            <p id="section-4.2-2.1.1">Platform : This entity holds attributes relating to the state of the platform, or device,
where the Attester is located. Entities of this type holds attributes that are global
in nature within the Target Environment.<a href="#section-4.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.2-2.2">
            <p id="section-4.2-2.2.1">Key : The entities of this type represent a cryptographic key protected within the
Target Environment and hold attributes relating to that key.<a href="#section-4.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.2-2.3">
            <p id="section-4.2-2.3.1">Transaction : This is an entity logical in nature since it is associated with attributes
that are not found in the Target Environment. The attributes found in this entity relate
to the current request for Evidence such as a nonce to support freshness.<a href="#section-4.2-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.2-3">Although this document defines a short list of entity types, this list should be extensible
to allow implementers to report on entities found in their implementation and not
covered by this specification. By using an Object Identifier (OID) for identifying both entity types
and the attribute types that they contain, this format is inherently extensible;
implementers of Attesters <span class="bcp14">MAY</span> define new custom or proprietary entity types and
place them along-side the standardized entities, or define new attribute types
and place them inside standardized entities.<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<p id="section-4.2-4">Verifiers <span class="bcp14">SHOULD</span> ignore and skip over
unrecognized entity or attribute types and continue processing normally.
In other words, if a given Evidence would have been acceptable without the
unrecognized entity or attribute, then it <span class="bcp14">SHOULD</span> still be acceptable.
In PKI terminology, all custom entities and attributes not defined in this document
<span class="bcp14">SHOULD</span> be considered non-critical unless a further specification indicates differently.<a href="#section-4.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="attribute-and-attribute-type">
<section id="section-4.3">
        <h3 id="name-attribute-and-attribute-typ">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-attribute-and-attribute-typ" class="section-name selfRef">Attribute and Attribute Type</a>
        </h3>
<p id="section-4.3-1">Each attribute found in an entity is composed of a type, the attribute type, and a value.
Each attribute describes a portion of the state of the associated entity. For example,
a platform entity could have an attribute which indicates the firmware version currently running.
Another example is a key entity with an attribute that reports whether the key is extractable
or not.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">A value provided by an attribute is to be interpreted within the context
of its entity and in relation to the attribute type.<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<p id="section-4.3-3">It is <span class="bcp14">RECOMMENDED</span> that an attribute type be defined for a specific entity type, to reduce
confusion when it comes to interpretation of the value. In other words, an attribute type <span class="bcp14">SHOULD</span>
not be used by multiple entity types. For example, if a concept of "revision" is applicable to a platform
and a key, the attribute for one entity type (platform revision) should have a different identifier
than the one for the other entity type (key revision).<a href="#section-4.3-3" class="pilcrow">¶</a></p>
<p id="section-4.3-4">The nature of the value (boolean, integer, string, bytes) is dependent on the attribute type.<a href="#section-4.3-4" class="pilcrow">¶</a></p>
<p id="section-4.3-5">This specification defines a limited number of attribute types. However, this list should be
extensible to allow implementers to report attributes not covered by this specification.<a href="#section-4.3-5" class="pilcrow">¶</a></p>
<p id="section-4.3-6">The number of attributes reported within an entity, and their respective type, is
left to the implementer. For a simple device, the reported list of attributes for an entity
might be fixed. However, larger and more complex devices, the list of reported attributes
should be tailored to the demands of the Presenter.<a href="#section-4.3-6" class="pilcrow">¶</a></p>
<p id="section-4.3-7">Some attributes <span class="bcp14">MAY</span> be repeated within an entity while others <span class="bcp14">MUST NOT</span>. For example, for a
platform entity, there can only be one "firmware version" attribute. Therefore, the associated attribute
<span class="bcp14">MUST NOT</span> be repeated as it may lead to confusion. However, an attribute relating to
a "loaded module" <span class="bcp14">MAY</span> be repeated, each attribute describing a different loaded module.
Therefore, the definition of an attribute specifies whether or not multiple copies of that
attribute are allowed.<a href="#section-4.3-7" class="pilcrow">¶</a></p>
<p id="section-4.3-8">If a Verifier encounters, within a single entity, multiple copies of an attribute specified as
"Multiple Allowed: No", it <span class="bcp14">MUST</span> reject the evidence as malformed.<a href="#section-4.3-8" class="pilcrow">¶</a></p>
<p id="section-4.3-9">If a Verifier encounters, within the context of an entity, a repeated attribute for a type where
multiple attributes are allowed, it <span class="bcp14">MUST</span> treat each one as an independent attribute and <span class="bcp14">MUST NOT</span>
consider later ones to overwrite or extend the previous one.<a href="#section-4.3-9" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-data-model">
<section id="section-5">
      <h2 id="name-data-model">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-data-model" class="section-name selfRef">Data Model</a>
      </h2>
<p id="section-5-1">This section describes the data model associated with PKIX Evidence. For ease of
deployment within the target ecosystem, ASN.1 definitions and DER encoding
are used. A complete ASN.1 module is provided in <a href="#sec-asn1-mod" class="auto internal xref">Section 10</a>.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">The top-level structures are:<a href="#section-5-2" class="pilcrow">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-5-3">
<pre>
PkixEvidence ::= SEQUENCE {
    tbs ClaimDescriptionTbs,
    signatures SEQUENCE SIZE (0..MAX) of SignatureBlock
}

ClaimDescriptionTbs ::= SEQUENCE {
    version INTEGER,
    reportedEntities SEQUENCE SIZE (1..MAX) OF ReportedEntity
}

SignatureBlock ::= SEQUENCE {
   certChain SEQUENCE of Certificate,
   signatureAlgorithm AlgorithmIdentifier,
   signatureValue OCTET STRING
}
</pre><a href="#section-5-3" class="pilcrow">¶</a>
</div>
<p id="section-5-4">A PkixEvidence message is composed of a protected section known as the To-Be-Signed (TBS) where the claim
description is reported. The integrity of the TBS section is ensured with one or multiple cryptographic signatures
over the content of the section. There is a provision to carry the X.509 certificates supporting each signature.
The SEQUENCE OF SignatureBlock allows for both multi-algorithm protection and for counter-signatures
of the evidence.
In an effort to keep the evidence format simple, distinguishing between these two cases is left up to Verifier policy,
potentially by making use of the certificates that accompany each signature.
This design also does not prevent against stripping attacks where an attacker removes a signature without leaving evidence
in the message that an additional signature had been there or signature re-ordering attacks.
Again, this is left up to Verifier policy to know how many
algorithms or counter-signatures it is expecting.
Consequently, Verifiers <span class="bcp14">MUST NOT</span> make any inferences about the lack of a signature. For example, enumerating
counter-signatures on an Evidence <span class="bcp14">MUST NOT</span> be considered to be a complete list of HSMs in a given cluster.
Similarly, the presence and order of counter-signatures <span class="bcp14">MUST NOT</span> be taken as proof of the path that the evidence traversed
over the network.<a href="#section-5-4" class="pilcrow">¶</a></p>
<p id="section-5-5">The TBS section is composed of a version number, to ensure future extensibility, and a sequence of reported entities.<a href="#section-5-5" class="pilcrow">¶</a></p>
<p id="section-5-6">For compliance with this specification, <code>ClaimDescriptionTbs.version</code> <span class="bcp14">MUST</span> be <code>1</code>.
This envelope format is not extensible; future specifications which make compatibility-breaking changes <span class="bcp14">MUST</span> increment the version number.<a href="#section-5-6" class="pilcrow">¶</a></p>
<p id="section-5-7">EDNOTE: do we want extension marks on the TbsAttestation object? I can see pros and cons to doing that.
JPF: This is a strong statement as there are many ways of extending a ASN.1 structure without breaking backwards compatibility.<a href="#section-5-7" class="pilcrow">¶</a></p>
<p id="section-5-8"><code>SignatureBlock.certChain</code> <span class="bcp14">MUST</span> contain at least one X.509 certificate as per <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>.
While there might exist attesting environments which use out-of-band or non-X.509 mechanisms for communicating
the AK public key to the Verifier, these <span class="bcp14">SHALL</span> be considered non-compliant with this specification.<a href="#section-5-8" class="pilcrow">¶</a></p>
<p id="section-5-9">As described in the <a href="#sec-info-model" class="auto internal xref">Section 4</a> section, the claim description is a set of entities. Each entity
is associated with a type that defines its class. The entity types are represented by object identifiers
(OIDs). The following ASN.1 definition defines the structures associated with entities:<a href="#section-5-9" class="pilcrow">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-5-10">
<pre>
ReportedEntity ::= SEQUENCE {
    entityType         OBJECT IDENTIFIER,
    reportedAttributes SEQUENCE SIZE (1..MAX) OF ReportedAttribute
}

id-pkix-attest                    OBJECT IDENTIFIER ::= { 1 2 3 999 }
id-pkix-attest-entity-type        OBJECT IDENTIFIER ::= { id-pkix-attest 0 }
id-pkix-attest-entity-transaction OBJECT IDENTIFIER ::= { id-pkix-attest-entity-type 0 }
id-pkix-attest-entity-platform    OBJECT IDENTIFIER ::= { id-pkix-attest-entity-type 1 }
id-pkix-attest-entity-key         OBJECT IDENTIFIER ::= { id-pkix-attest-entity-type 2 }
</pre><a href="#section-5-10" class="pilcrow">¶</a>
</div>
<p id="section-5-11">In turn, entities are composed of attributes. Each attribute is composed of a type and a value.
The attribute types are represented by object identifiers (OIDs). The
following ASN.1 definition defines the structures associated with attributes:<a href="#section-5-11" class="pilcrow">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-5-12">
<pre>
ReportedAttribute ::= SEQUENCE {
    attributeType      OBJECT IDENTIFIER,
    value              OPTIONAL AttributeValue
}

AttributeValue :== CHOICE {
   bytes       [0] IMPLICIT OCTET STRING
   utf8String  [1] IMPLICIT UTF8String,
   bool        [2] IMPLICIT BOOLEAN,
   time        [3] IMPLICIT GeneralizedTime,
   int         [4] IMPLICIT INTEGER,
   oid         [5] IMPLICIT OBJECT IDENTIFIER
}
</pre><a href="#section-5-12" class="pilcrow">¶</a>
</div>
<p id="section-5-13">The attributes associated with an entity are dependent on the type of entity. Therefore, it is encouraged
to define attribute types grouped with their respective entity type.<a href="#section-5-13" class="pilcrow">¶</a></p>
<p id="section-5-14">The type of an attribute value is dictated by the attribute type. When an attribute type is defined, the
definition must include the type of the value, its semantic and interpretation.<a href="#section-5-14" class="pilcrow">¶</a></p>
<p id="section-5-15">The remainder of this section describes the entity types and their associated attributes.<a href="#section-5-15" class="pilcrow">¶</a></p>
<div id="platform-entity">
<section id="section-5.1">
        <h3 id="name-platform-entity">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-platform-entity" class="section-name selfRef">Platform Entity</a>
        </h3>
<p id="section-5.1-1">A platform entity is associated with the type identifier <code>id-pkix-attest-entity-platform</code>. It is composed
of a set of attributes that are global to the Target Environment.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">A platform entity, if provided, <span class="bcp14">MUST</span> be included only once within the reported entities. If a
Verifier encounters multiple entities of type <code>id-pkix-attest-entity-platform</code>, it <span class="bcp14">MUST</span>
reject the Evidence as malformed.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<p id="section-5.1-3">The following table lists the attributes for a platform entity (platform attributes) defined
within this specification. In cases where the attribute is borrowed from another specification,
the "Reference" column refers to the specification where the semantics
for the attribute value can be found.
Attributes defined in this specification have further details below.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
<table class="center" id="table-1">
          <caption><a href="#table-1" class="selfRef">Table 1</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Attribute</th>
              <th class="text-left" rowspan="1" colspan="1">AttributeValue</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
              <th class="text-left" rowspan="1" colspan="1">Multiple?</th>
              <th class="text-left" rowspan="1" colspan="1">OID</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">vendor</td>
              <td class="text-left" rowspan="1" colspan="1">utf8String</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
              <td class="text-left" rowspan="1" colspan="1">No</td>
              <td class="text-left" rowspan="1" colspan="1">id-pkix-evidence-attribute-platform-vendor</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">oemid</td>
              <td class="text-left" rowspan="1" colspan="1">bytes</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#RFC9711" class="cite xref">RFC9711</a>]</span>
</td>
              <td class="text-left" rowspan="1" colspan="1">No</td>
              <td class="text-left" rowspan="1" colspan="1">id-pkix-evidence-attribute-platform-oemid</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">hwmodel</td>
              <td class="text-left" rowspan="1" colspan="1">utf8String</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#RFC9711" class="cite xref">RFC9711</a>]</span>
</td>
              <td class="text-left" rowspan="1" colspan="1">No</td>
              <td class="text-left" rowspan="1" colspan="1">id-pkix-evidence-attribute-platform-model</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">hwserial</td>
              <td class="text-left" rowspan="1" colspan="1">utf8String</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
              <td class="text-left" rowspan="1" colspan="1">No</td>
              <td class="text-left" rowspan="1" colspan="1">id-pkix-evidence-attribute-platform-hwserial</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">swversion</td>
              <td class="text-left" rowspan="1" colspan="1">utf8String</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#RFC9711" class="cite xref">RFC9711</a>]</span>
</td>
              <td class="text-left" rowspan="1" colspan="1">No</td>
              <td class="text-left" rowspan="1" colspan="1">id-pkix-evidence-attribute-platform-swversion</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">dbgstat</td>
              <td class="text-left" rowspan="1" colspan="1">int</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#RFC9711" class="cite xref">RFC9711</a>]</span>
</td>
              <td class="text-left" rowspan="1" colspan="1">No</td>
              <td class="text-left" rowspan="1" colspan="1">id-pkix-evidence-attribute-platform-debugstat</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">uptime</td>
              <td class="text-left" rowspan="1" colspan="1">int</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#RFC9711" class="cite xref">RFC9711</a>]</span>
</td>
              <td class="text-left" rowspan="1" colspan="1">No</td>
              <td class="text-left" rowspan="1" colspan="1">id-pkix-evidence-attribute-platform-uptime</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">bootcount</td>
              <td class="text-left" rowspan="1" colspan="1">int</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#RFC9711" class="cite xref">RFC9711</a>]</span>
</td>
              <td class="text-left" rowspan="1" colspan="1">No</td>
              <td class="text-left" rowspan="1" colspan="1">id-pkix-evidence-attribute-platform-bootcount</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">usermods</td>
              <td class="text-left" rowspan="1" colspan="1">utf8String</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
              <td class="text-left" rowspan="1" colspan="1">Yes</td>
              <td class="text-left" rowspan="1" colspan="1">id-pkix-evidence-attribute-platform-usermods</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">fipsboot</td>
              <td class="text-left" rowspan="1" colspan="1">bool</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#FIPS.140-3" class="cite xref">FIPS.140-3</a>]</span>
</td>
              <td class="text-left" rowspan="1" colspan="1">No</td>
              <td class="text-left" rowspan="1" colspan="1">id-pkix-evidence-attribute-platform-fipsboot</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">fipsver</td>
              <td class="text-left" rowspan="1" colspan="1">utf8String</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#FIPS.140-3" class="cite xref">FIPS.140-3</a>]</span>
</td>
              <td class="text-left" rowspan="1" colspan="1">No</td>
              <td class="text-left" rowspan="1" colspan="1">id-pkix-evidence-attribute-platform-fipsver</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">fipslevel</td>
              <td class="text-left" rowspan="1" colspan="1">int</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#FIPS.140-3" class="cite xref">FIPS.140-3</a>]</span>
</td>
              <td class="text-left" rowspan="1" colspan="1">No</td>
              <td class="text-left" rowspan="1" colspan="1">id-pkix-evidence-attribute-platform-fipslevel</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">envid</td>
              <td class="text-left" rowspan="1" colspan="1">utf8String</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
              <td class="text-left" rowspan="1" colspan="1">Yes</td>
              <td class="text-left" rowspan="1" colspan="1">id-pkix-evidence-attribute-platform-envid</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">envdesc</td>
              <td class="text-left" rowspan="1" colspan="1">utf8String</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
              <td class="text-left" rowspan="1" colspan="1">Yes</td>
              <td class="text-left" rowspan="1" colspan="1">id-pkix-evidence-attribute-platform-envdesc</td>
            </tr>
          </tbody>
        </table>
<p id="section-5.1-5">TODO: find the actual reference for "FIPS Mode" -- FIPS 140-3 does not define it (at least not the 11 page useless version of 140-3 that I found).<a href="#section-5.1-5" class="pilcrow">¶</a></p>
<p id="section-5.1-6">Each attribute defined in the table above is described in the following sub-sections.<a href="#section-5.1-6" class="pilcrow">¶</a></p>
<div id="vendor">
<section id="section-5.1.1">
          <h4 id="name-vendor">
<a href="#section-5.1.1" class="section-number selfRef">5.1.1. </a><a href="#name-vendor" class="section-name selfRef">vendor</a>
          </h4>
<p id="section-5.1.1-1">A human-readable string that reports the name of the device's manufacturer.<a href="#section-5.1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="oemid-hwmodel-swversion-dbgstat-uptime-bootcount">
<section id="section-5.1.2">
          <h4 id="name-oemid-hwmodel-swversion-dbg">
<a href="#section-5.1.2" class="section-number selfRef">5.1.2. </a><a href="#name-oemid-hwmodel-swversion-dbg" class="section-name selfRef">oemid, hwmodel, swversion, dbgstat, uptime, bootcount</a>
          </h4>
<p id="section-5.1.2-1">These attributes are defined in <span>[<a href="#RFC9711" class="cite xref">RFC9711</a>]</span> and reused in this specification for interoperability. Small
descriptions are offered for each to ease the reading of this specification. In case of confusion between the
description offered here and the one in <span>[<a href="#RFC9711" class="cite xref">RFC9711</a>]</span>, the definition offered in the latter shall prevail.<a href="#section-5.1.2-1" class="pilcrow">¶</a></p>
<p id="section-5.1.2-2">The attribute "oemid" uniquely identifies the Original Equipment Manufacturer (OEM) of the HSM. This is a
sequence of bytes and is not meant to be a human readable string.<a href="#section-5.1.2-2" class="pilcrow">¶</a></p>
<p id="section-5.1.2-3">The attribute "hwmodel" differentiates models, products and variants manufactured by a particular OEM. A model
must be unique within a given "oemid". This is a sequence of bytes and is not meant to be a human readable string.<a href="#section-5.1.2-3" class="pilcrow">¶</a></p>
<p id="section-5.1.2-4">EDNOTE: JPF: "hwmodel" in EAT is not human readbale. We have "vendor" that duplicates in human readable for "oemid".
Should we duplicate "hwmodel" in a human readable form? Should we define it here for ourselves?<a href="#section-5.1.2-4" class="pilcrow">¶</a></p>
<p id="section-5.1.2-5">The attribute "swversion" differentiates between the various revisions of a firmware offered for the HSM. This
is a string that is expected to be human readable.<a href="#section-5.1.2-5" class="pilcrow">¶</a></p>
<p id="section-5.1.2-6">EDNOTE: JPF: In EAT, "swversion" requires "swname". Should we add "swname" or disaassociate from the EAT definition?<a href="#section-5.1.2-6" class="pilcrow">¶</a></p>
<p id="section-5.1.2-7">The attribute "dbgstat" refers to the state of the debug facilities offered by the HSM. This is an integer
value describing the current state as described in <span>[<a href="#RFC9711" class="cite xref">RFC9711</a>]</span>.<a href="#section-5.1.2-7" class="pilcrow">¶</a></p>
<p id="section-5.1.2-8">The attribute "uptime" reports the number of seconds that have elapsed since the HSM was last booted.<a href="#section-5.1.2-8" class="pilcrow">¶</a></p>
<p id="section-5.1.2-9">The attribute "bootcount" reported the number of times the HSM was booted.<a href="#section-5.1.2-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="hwserial">
<section id="section-5.1.3">
          <h4 id="name-hwserial">
<a href="#section-5.1.3" class="section-number selfRef">5.1.3. </a><a href="#name-hwserial" class="section-name selfRef">hwserial</a>
          </h4>
<p id="section-5.1.3-1">A human-readable string that reports the serial number of the hardware module. This serial number often matches the number engraved
on the case or on an applied sticker.<a href="#section-5.1.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="usermods">
<section id="section-5.1.4">
          <h4 id="name-usermods">
<a href="#section-5.1.4" class="section-number selfRef">5.1.4. </a><a href="#name-usermods" class="section-name selfRef">usermods</a>
          </h4>
<p id="section-5.1.4-1">Most HSMs have some concept of trusted execution environment where user software modules can be loaded inside the HSM to run with some level of privileged access to the application keys. This attribute lists user modules currently loaded onto the HSM in a human readable format, preferably JSON.<a href="#section-5.1.4-1" class="pilcrow">¶</a></p>
<p id="section-5.1.4-2">EDNOTE: JPF if JSON, why have multiple attributes.<a href="#section-5.1.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="fipsboot-fipsver-and-fipslevel">
<section id="section-5.1.5">
          <h4 id="name-fipsboot-fipsver-and-fipsle">
<a href="#section-5.1.5" class="section-number selfRef">5.1.5. </a><a href="#name-fipsboot-fipsver-and-fipsle" class="section-name selfRef">fipsboot, fipsver and fipslevel</a>
          </h4>
<p id="section-5.1.5-1">FIPS 140-3 CMVP validation places stringent requirements on the mode of operation of the device and the cryptography offered by the module, including only enabling FIPS-approved algorithms, certain requirements on entropy sources, and extensive start-up self-tests. FIPS 140-3 offers compliance levels 1 through 4 with increasingly strict requirements. Many HSMs include a configuration setting that allows the device to be taken out of FIPS mode and thus enable additional functionality or performance, and some offer configuration settings to change between compliance levels.<a href="#section-5.1.5-1" class="pilcrow">¶</a></p>
<p id="section-5.1.5-2">The boolean attribute <code>fipsboot</code> indicates whether the device is currently operating in FIPS mode. When the attribute value is "true", the HSM is running in compliance with the
FIPS 140 restrictions. Among other restrictions, it means that only FIPS-approved algorithms are available. If the value of this attribute is "false", then the HSM is not
restricted to the behavior limited by compliance.<a href="#section-5.1.5-2" class="pilcrow">¶</a></p>
<p id="section-5.1.5-3">The UTF8String attribute <code>fipsver</code> indicates the version of the FIPS CMVP specification with which the device's operational mode is compliant. At the time of writing, the strings "FIPS 140-2" or "FIPS 140-3" <span class="bcp14">SHOULD</span> be used.<a href="#section-5.1.5-3" class="pilcrow">¶</a></p>
<p id="section-5.1.5-4">The integer attribute <code>fipslevel</code> indicates the compliance level to which the device is currently operating and <span class="bcp14">MUST</span> only be 1, 2, 3, or 4. The <code>fipslevel</code> attribute has no meaning if <code>fipsboot</code> is absent or <code>false</code>.<a href="#section-5.1.5-4" class="pilcrow">¶</a></p>
<p id="section-5.1.5-5">The FIPS status information in PKIX Evidence indicates only the mode of operation of the device and is not authoritative of its validation status.
This information is available on the NIST CMVP website or by contacting the device vendor.
As an example, some devices may have the option to enable FIPS mode in configuration even if the vendor has not submitted this model for validation. As another example, a device may be running in a mode consistent with FIPS Level 3 but the device was only validated and certified to Level 2.
A Relying Party wishing to know the validation status of the device <span class="bcp14">MUST</span> couple the device state information contained in the Evidence with a valid FIPS CMVP certificate for the device.<a href="#section-5.1.5-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="envid">
<section id="section-5.1.6">
          <h4 id="name-envid">
<a href="#section-5.1.6" class="section-number selfRef">5.1.6. </a><a href="#name-envid" class="section-name selfRef">envid</a>
          </h4>
<p id="section-5.1.6-1">An identifier for an environment to which the attested keys belong. These will be an a vendor-chosen format, but are constrained to ASCII as URIs, UUID, and similar types of identifiers are envisioned.<a href="#section-5.1.6-1" class="pilcrow">¶</a></p>
<p id="section-5.1.6-2">There <span class="bcp14">MAY</span> be multiple envid attributes if the attested keys simultaneously belong to multiple environments.<a href="#section-5.1.6-2" class="pilcrow">¶</a></p>
<p id="section-5.1.6-3">Note that by including envid as a platform attribute, this implies that it applies to all attested key entities. If the HSM needs to attest multiple keys across multiple disjoint environments, then multiple PkixEvidences are required. This naturally enforces privacy constraints of only attesting a single environment at a time.<a href="#section-5.1.6-3" class="pilcrow">¶</a></p>
<p id="section-5.1.6-4">EDNOTE: JPF I do not understand this sub-section<a href="#section-5.1.6-4" class="pilcrow">¶</a></p>
<p id="section-5.1.6-5">If an envdid request attribute contains a value, this means that the Presenter is requesting that only keys belogning to the given environment be included in the returned attestation.<a href="#section-5.1.6-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="envdesc">
<section id="section-5.1.7">
          <h4 id="name-envdesc">
<a href="#section-5.1.7" class="section-number selfRef">5.1.7. </a><a href="#name-envdesc" class="section-name selfRef">envdesc</a>
          </h4>
<p id="section-5.1.7-1">Further description of the environment beyond hwvendor, hwmodel, hwserial, swversion; for example if there is a need to describe multiple logical partitions within the same device. Contents could be a human-readable description or other identifiers.<a href="#section-5.1.7-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="key-entity">
<section id="section-5.2">
        <h3 id="name-key-entity">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-key-entity" class="section-name selfRef">Key Entity</a>
        </h3>
<p id="section-5.2-1">A key entity is associated with the type <code>id-pkix-attest-entity-key</code>. Each instance of a
key entity represents a different cryptographic key found in the Target Environment. There can
be multiple key entities found in claim description, but each reported key entity <span class="bcp14">MUST</span>
described a different cryptographic key.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">A key entity is composed of a set of attributes relating to the related cryptographic key. At
minimum, a key entity <span class="bcp14">MUST</span> report the attribute "identifier" to uniquely identify this cryptographic
key from any others found in the same Target Environment.<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<p id="section-5.2-3">A Verifier that encounters a claim description with multiple key entities referring to the
same cryptographic key <span class="bcp14">MUST</span> reject the Evidence.<a href="#section-5.2-3" class="pilcrow">¶</a></p>
<p id="section-5.2-4">The following table lists the attributes for a key entity (key attributes) defined
within this specification. The "Reference" column refers to the specification where the semantics
for the attribute value can be found.<a href="#section-5.2-4" class="pilcrow">¶</a></p>
<table class="center" id="table-2">
          <caption><a href="#table-2" class="selfRef">Table 2</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Attribute</th>
              <th class="text-left" rowspan="1" colspan="1">AttributeValue</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
              <th class="text-left" rowspan="1" colspan="1">Multiple?</th>
              <th class="text-left" rowspan="1" colspan="1">OID</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">identifier</td>
              <td class="text-left" rowspan="1" colspan="1">utf8String</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
              <td class="text-left" rowspan="1" colspan="1">Yes</td>
              <td class="text-left" rowspan="1" colspan="1">id-pkix-evidence-attribute-key-identifier</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">spki</td>
              <td class="text-left" rowspan="1" colspan="1">bytes</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
              <td class="text-left" rowspan="1" colspan="1">No</td>
              <td class="text-left" rowspan="1" colspan="1">id-pkix-evidence-attribute-key-spki</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">purpose</td>
              <td class="text-left" rowspan="1" colspan="1">bytes</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#PKCS11" class="cite xref">PKCS11</a>]</span>
</td>
              <td class="text-left" rowspan="1" colspan="1">No</td>
              <td class="text-left" rowspan="1" colspan="1">id-pkix-evidence-attribute-key-purpose</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">extractable</td>
              <td class="text-left" rowspan="1" colspan="1">bool</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#PKCS11" class="cite xref">PKCS11</a>]</span>
</td>
              <td class="text-left" rowspan="1" colspan="1">No</td>
              <td class="text-left" rowspan="1" colspan="1">id-pkix-evidence-attribute-key-extractable</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">sensitive</td>
              <td class="text-left" rowspan="1" colspan="1">bool</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#PKCS11" class="cite xref">PKCS11</a>]</span>
</td>
              <td class="text-left" rowspan="1" colspan="1">No</td>
              <td class="text-left" rowspan="1" colspan="1">id-pkix-evidence-attribute-key-sensitive</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">never-extractable</td>
              <td class="text-left" rowspan="1" colspan="1">bool</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#PKCS11" class="cite xref">PKCS11</a>]</span>
</td>
              <td class="text-left" rowspan="1" colspan="1">No</td>
              <td class="text-left" rowspan="1" colspan="1">id-pkix-evidence-attribute-key-never-extractable</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">local</td>
              <td class="text-left" rowspan="1" colspan="1">bool</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#PKCS11" class="cite xref">PKCS11</a>]</span>
</td>
              <td class="text-left" rowspan="1" colspan="1">No</td>
              <td class="text-left" rowspan="1" colspan="1">id-pkix-evidence-attribute-key-local</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">expiry</td>
              <td class="text-left" rowspan="1" colspan="1">time</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
              <td class="text-left" rowspan="1" colspan="1">No</td>
              <td class="text-left" rowspan="1" colspan="1">id-pkix-evidence-attribute-key-expiry</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">protection</td>
              <td class="text-left" rowspan="1" colspan="1">bytes</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
              <td class="text-left" rowspan="1" colspan="1">No</td>
              <td class="text-left" rowspan="1" colspan="1">id-pkix-evidence-attribute-key-protection</td>
            </tr>
          </tbody>
        </table>
<p id="section-5.2-6">An attestation key might be visible to a client of the device and be reported along with other cryptographic keys. Therefore,
it is acceptable to include a key entity providing claims about an attestation key like any other cryptographic key. An
implemention <span class="bcp14">MAY</span> reject the generation of PKIX Evidence if it relates to an attestation key.<a href="#section-5.2-6" class="pilcrow">¶</a></p>
<div id="identifier">
<section id="section-5.2.1">
          <h4 id="name-identifier">
<a href="#section-5.2.1" class="section-number selfRef">5.2.1. </a><a href="#name-identifier" class="section-name selfRef">identifier</a>
          </h4>
<p id="section-5.2.1-1">A human-readable string that uniquely identifies the cryptographic key. This value often contains
a UUID but could also have a numeric value expressed as text or any other textual description.<a href="#section-5.2.1-1" class="pilcrow">¶</a></p>
<p id="section-5.2.1-2">This attribute <span class="bcp14">MAY</span> be repeated as some environments have more than one way to refer to a
cryptographic key.<a href="#section-5.2.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="spki">
<section id="section-5.2.2">
          <h4 id="name-spki">
<a href="#section-5.2.2" class="section-number selfRef">5.2.2. </a><a href="#name-spki" class="section-name selfRef">spki</a>
          </h4>
<p id="section-5.2.2-1">The value of this attribute contains the DER-encoded field SubjectPublicKeyInfo (see <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>) associated with the cryptographic
key.<a href="#section-5.2.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="purpose-extractable-sensitive-never-extractable-local">
<section id="section-5.2.3">
          <h4 id="name-purpose-extractable-sensiti">
<a href="#section-5.2.3" class="section-number selfRef">5.2.3. </a><a href="#name-purpose-extractable-sensiti" class="section-name selfRef">purpose, extractable, sensitive, never-extractable, local</a>
          </h4>
<p id="section-5.2.3-1">These attributes are defined in <span>[<a href="#PKCS11" class="cite xref">PKCS11</a>]</span> and reused in this specification for interoperability. Small
descriptions are offered for each to ease the reading of this specification. In case of confusion between the
description offered here and the one in <span>[<a href="#PKCS11" class="cite xref">PKCS11</a>]</span>, the definition offered in the latter shall prevail.<a href="#section-5.2.3-1" class="pilcrow">¶</a></p>
<p id="section-5.2.3-2">The attribute "purpose" defines the intended usage for the key.<a href="#section-5.2.3-2" class="pilcrow">¶</a></p>
<p id="section-5.2.3-3">EDNOTE: JPF: I do not see "purpose" as part of PKCS#11<a href="#section-5.2.3-3" class="pilcrow">¶</a></p>
<p id="section-5.2.3-4">The attribute "extractable" indicates that the key can be exported from the HSM. Corresponds directly to the attribute CKA_EXTRACTABLE
found in PKCS#11.<a href="#section-5.2.3-4" class="pilcrow">¶</a></p>
<p id="section-5.2.3-5">The attribute "sensitive" indicates that the key cannot leave the HSM in plaintext. Corresponds directly to the attribute CKA_SENSITIVE
found in PKCS#11.<a href="#section-5.2.3-5" class="pilcrow">¶</a></p>
<p id="section-5.2.3-6">The attribute "never-extractable" indicates if the key was never extractable from the HSM throughout the life of the key. Corresponds
directly to the attribute CKA_NEVER_EXTRACTABLE found in PKCS#11.<a href="#section-5.2.3-6" class="pilcrow">¶</a></p>
<p id="section-5.2.3-7">The attribute "local" indicates whether the key was generated locally or imported.. Corresponds directly to the attribute CKA_LOCAL
found in PKCS#11.<a href="#section-5.2.3-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="expiry">
<section id="section-5.2.4">
          <h4 id="name-expiry">
<a href="#section-5.2.4" class="section-number selfRef">5.2.4. </a><a href="#name-expiry" class="section-name selfRef">expiry</a>
          </h4>
<p id="section-5.2.4-1">Reports a time after which the key is not to be used. The device <span class="bcp14">MAY</span> enforce this policy based on its internal clock.<a href="#section-5.2.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="protection">
<section id="section-5.2.5">
          <h4 id="name-protection">
<a href="#section-5.2.5" class="section-number selfRef">5.2.5. </a><a href="#name-protection" class="section-name selfRef">protection</a>
          </h4>
<p id="section-5.2.5-1">Indicates any additional key protection properties around use or modification of this key. These are generalized properties and will not apply the same way to all HSM vendors. Consult vendor documentation for the in-context meaning of these flags.<a href="#section-5.2.5-1" class="pilcrow">¶</a></p>
<p id="section-5.2.5-2">TODO: define a bit-indexed byte array<a href="#section-5.2.5-2" class="pilcrow">¶</a></p>
<p id="section-5.2.5-3">BIT MASK / Boolean Array {DualControl (0), CardControl (1), PasswordControl (2), ...}<a href="#section-5.2.5-3" class="pilcrow">¶</a></p>
<p id="section-5.2.5-4">We may need to say that the first X are reserved for use by future RFCs that update this specification, and beyond that is private use.<a href="#section-5.2.5-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="transaction-entity">
<section id="section-5.3">
        <h3 id="name-transaction-entity">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-transaction-entity" class="section-name selfRef">Transaction Entity</a>
        </h3>
<p id="section-5.3-1">A transaction entity is associated with the type <code>id-pkix-attest-entity-transaction</code>. This is
a logical entity and does not relate to an element found in the Target Environment. Instead, it
groups together attributes that relate to the request of generating the Evidence.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<p id="section-5.3-2">For example, it is possible to include a "nonce" as part of the request to produce Evidence. This
nonce is repeated as part of the Evidence, within the portion protected for integrity, to prove
the freshness of the claims. This "nonce" is not related to any element in the Target Environment
and the transaction entity is used to gather those values into attributes.<a href="#section-5.3-2" class="pilcrow">¶</a></p>
<p id="section-5.3-3">A transaction entity, if provided, should be included only once within the reported entities. If a
Verifier encounters multiple entities of type <code>id-pkix-attest-entity-transaction</code>, it <span class="bcp14">MUST</span>
reject the Evidence.<a href="#section-5.3-3" class="pilcrow">¶</a></p>
<p id="section-5.3-4">The following table lists the attributes for a transaction entity (transaction attributes) defined
within this specification. The "Reference" column refers to the specification where the semantics
for the attribute value can be found.<a href="#section-5.3-4" class="pilcrow">¶</a></p>
<p id="section-5.3-5">A default and vendor-agnostic set of transaction attributes is defined in this section.<a href="#section-5.3-5" class="pilcrow">¶</a></p>
<p id="section-5.3-6">These attribute types <span class="bcp14">MAY</span> be contained within a transaction entity; i.e. an entity identified by <code>id-pkix-attest-entity-transaction</code>.<a href="#section-5.3-6" class="pilcrow">¶</a></p>
<table class="center" id="table-3">
          <caption><a href="#table-3" class="selfRef">Table 3</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Attribute</th>
              <th class="text-left" rowspan="1" colspan="1">AttributeValue</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
              <th class="text-left" rowspan="1" colspan="1">Multiple?</th>
              <th class="text-left" rowspan="1" colspan="1">OID</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">nonce</td>
              <td class="text-left" rowspan="1" colspan="1">bytes</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#RFC9711" class="cite xref">RFC9711</a>]</span>
</td>
              <td class="text-left" rowspan="1" colspan="1">Yes</td>
              <td class="text-left" rowspan="1" colspan="1">id-pkix-evidence-attribute-transaction-nonce</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">timestamp</td>
              <td class="text-left" rowspan="1" colspan="1">time</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#RFC9711" class="cite xref">RFC9711</a>]</span>
</td>
              <td class="text-left" rowspan="1" colspan="1">No</td>
              <td class="text-left" rowspan="1" colspan="1">id-pkix-evidence-attribute-transaction-timestamp</td>
            </tr>
          </tbody>
        </table>
<div id="nonce">
<section id="section-5.3.1">
          <h4 id="name-nonce">
<a href="#section-5.3.1" class="section-number selfRef">5.3.1. </a><a href="#name-nonce" class="section-name selfRef">nonce</a>
          </h4>
<p id="section-5.3.1-1">The attribute "nonce" is used to provide "freshness" quality as to the claims provided in the PkixEvidence message. A Presenter requesting a PkixEvidence message <span class="bcp14">MAY</span> provide a nonce value as part of the request. This nonce value, if provided, <span class="bcp14">SHOULD</span> be repeated as an attribute to the transaction entity.<a href="#section-5.3.1-1" class="pilcrow">¶</a></p>
<p id="section-5.3.1-2">This is similar to the attribute "eat_nonce" as defined in <span>[<a href="#RFC9711" class="cite xref">RFC9711</a>]</span>. According to this specification, this attribute may be specified multiple times with
different values. In that case, all different values shall be repeated in the PKIXEvidence.<a href="#section-5.3.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="timestamp">
<section id="section-5.3.2">
          <h4 id="name-timestamp">
<a href="#section-5.3.2" class="section-number selfRef">5.3.2. </a><a href="#name-timestamp" class="section-name selfRef">timestamp</a>
          </h4>
<p id="section-5.3.2-1">The time at which the PKIX Evidence was generated, according to the internal system clock of the Attester. This is similar to the
"iat" claim in <span>[<a href="#RFC9711" class="cite xref">RFC9711</a>]</span>.<a href="#section-5.3.2-1" class="pilcrow">¶</a></p>
<p id="section-5.3.2-2">EDNOTE: JPF: Does the following paragraph belong to Security Considerations?<a href="#section-5.3.2-2" class="pilcrow">¶</a></p>
<p id="section-5.3.2-3">Note that it is common for HSMs to not have an accurate system clock; consider an HSM for a root CA kept offline and booted up infrequently in an local network segregated from all other network, or a smart card which boots up only when held against an NFC reader.
Implementers of emitters <span class="bcp14">SHOULD</span> include this attribute only if the device reliably knows its own time (for example has had recent contact with an NTP server).
Implementers of parsers <span class="bcp14">SHOULD</span> be wary of trusting the contents of this attribute. A challenge-response protocol that makes use of the nonce attribute is a far more reliable way of establishing freshness.<a href="#section-5.3.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-additional-attr-types">
<section id="section-5.4">
        <h3 id="name-additional-entity-and-attri">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-additional-entity-and-attri" class="section-name selfRef">Additional Entity and Attribute Types</a>
        </h3>
<p id="section-5.4-1">It is expected that HSM vendors will register additional Entity and Attribute types by assigning OIDs from their own proprietary OID arcs to hold data describing additional proprietary key properties.<a href="#section-5.4-1" class="pilcrow">¶</a></p>
<p id="section-5.4-2">An Attester (HSM) which is requested to provide information about unrecognized Entity or Attribute types <span class="bcp14">MUST</span> fail the operation.<a href="#section-5.4-2" class="pilcrow">¶</a></p>
<p id="section-5.4-3">A Verifier which encounters an unrecognized Entity or Attribute type <span class="bcp14">MAY</span> ignore it.<a href="#section-5.4-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="encoding">
<section id="section-5.5">
        <h3 id="name-encoding">
<a href="#section-5.5" class="section-number selfRef">5.5. </a><a href="#name-encoding" class="section-name selfRef">Encoding</a>
        </h3>
<p id="section-5.5-1">A PkixEvidence is to be DER encoded <span>[<a href="#X.690" class="cite xref">X.690</a>]</span>.<a href="#section-5.5-1" class="pilcrow">¶</a></p>
<p id="section-5.5-2">If a textual representation is required, then the DER encoding <span class="bcp14">MAY</span> be subsequently encoded into Base64.<a href="#section-5.5-2" class="pilcrow">¶</a></p>
<p id="section-5.5-3">EDNOTE: I think we have to be precise about which flavour of Base64 we are referring to.<a href="#section-5.5-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="signing-procedure">
<section id="section-6">
      <h2 id="name-signing-procedure">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-signing-procedure" class="section-name selfRef">Signing Procedure</a>
      </h2>
<p id="section-6-1">The <code>SignatureBlock.signatureValue</code> signs over the DER-encoded to-be-signed attestation data
<code>PkixEvidence.tbs</code> and <span class="bcp14">MUST</span> be validated with the subject public key of the leaf
X.509 certificate contained in the <code>SignatureBlock.certChain</code>.<a href="#section-6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-verif-proc">
<section id="section-7">
      <h2 id="name-verification-procedure">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-verification-procedure" class="section-name selfRef">Verification Procedure</a>
      </h2>
<p id="section-7-1">The <code>SignatureBlock.signatureValue</code> signs over the DER-encoded to-be-signed attestation data
<code>PkixEvidence.tbs</code> and <span class="bcp14">MUST</span> be validated with the subject public key of the leaf
X.509 certificate contained in the <code>SignatureBlock.certChain</code>.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">Note that a PkixEvidence <span class="bcp14">MAY</span> contain zero or more SignatureBlocks.
A PkixEvidence with zero SignatureBlocks is unsigned, <span class="bcp14">MUST</span> be treated as un-protected and un-trusted,
and any signature validation procedure <span class="bcp14">MUST</span> fail.<a href="#section-7-2" class="pilcrow">¶</a></p>
<p id="section-7-3">More than one SignatureBlocks <span class="bcp14">MAY</span> be used to convey a number of different semantics.
For example, the HSM's Attesting Service might hold multiple Attestation Keys on different cryptographic
algorithms in order to provide algorithm redundancy in the case that one algorithm becomes cryptographically broken. In this case a Verifier would be expected to validate all SignatureBlocks. Alternatively, the HSM's Attesting Service may hold multiple Attestion Keys (or multiple X.509 certificates for the same key) from multiple operational environments to which it belongs. In this case a Verifier would be expected to only validate the SignatureBlock corresponding to its own environment. Alternatively, multiple SignatureBlocks could be used to convey counter-signatures from external parties, in which case the Verifier will need to be equipped with environment-specific verification logic. Multiple of these cases, and potentially others, could be present in a single PkixEvidence object.<a href="#section-7-3" class="pilcrow">¶</a></p>
<p id="section-7-4">Note that each SignatureBlock is a fully detached signature over the tbs content with no binding between the signed content and the SignatureBlocks, or between SignatureBlocks, meaning that a third party can add a
counter-signature of the evidence after the fact, or an attacker can remove a SignatureBlock without leaving any artifact. See {#sec-detached-sigs} for further discussion.<a href="#section-7-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-profiles">
<section id="section-8">
      <h2 id="name-appraisal-policies-and-prof">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-appraisal-policies-and-prof" class="section-name selfRef">Appraisal Policies and Profiles</a>
      </h2>
<p id="section-8-1">This section provides some sample profiles of appraisal policies that verifiers
<span class="bcp14">MAY</span> apply when evaluating evidence. These appraisal profiles represent environment-specific requirements
on the contents of the evidence and / or endorsement certificate chain.<a href="#section-8-1" class="pilcrow">¶</a></p>
<div id="key-import-into-an-hsm">
<section id="section-8.1">
        <h3 id="name-key-import-into-an-hsm">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-key-import-into-an-hsm" class="section-name selfRef">Key Import into an HSM</a>
        </h3>
<p id="section-8.1-1">An HSM which is compliant with this draft <span class="bcp14">SHOULD</span> validate any PKIX Key Attestations that are provided
along with the key being imported.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<p id="section-8.1-2">The SignatureBlocks <span class="bcp14">MUST</span> be validated and <span class="bcp14">MUST</span> chain to a trust anchor known to the HSM. In most cases this will
be the same trust anchor that endorsed the HSMs own AK, but the HSM <span class="bcp14">MAY</span> be configured with set of third party trust anchors from which it will accept key attestations.<a href="#section-8.1-2" class="pilcrow">¶</a></p>
<p id="section-8.1-3">If the HSM is operating in FIPS Mode, then it <span class="bcp14">MUST</span> only import keys from HSMs also operating in FIPS Mode.<a href="#section-8.1-3" class="pilcrow">¶</a></p>
<p id="section-8.1-4">The claims <code>key-purpose</code>, <code>key-extractable</code>, <code>key-never-extractable</code>, <code>key-local</code> <span class="bcp14">MUST</span> be checked and honoured during key import, which typically means that after import, the key <span class="bcp14">MUST NOT</span> claim a stronger protection property than it had on the previous hardware. In other words, Key Attestation allows and requires that key protection properties be preserved over export / import operations between different HSMs, and this format provides a vendor-agnostic
way to acheive this.<a href="#section-8.1-4" class="pilcrow">¶</a></p>
<p id="section-8.1-5">How to handle errors is outside the scope of this specification and is left to implementors; for example the
key import <span class="bcp14">MAY</span> be aborted, or a prompt <span class="bcp14">MAY</span> be given to the user administrator, or any similar reasonable error handling logic.<a href="#section-8.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="cabrowser-forum-code-signing">
<section id="section-8.2">
        <h3 id="name-ca-browser-forum-code-signi">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-ca-browser-forum-code-signi" class="section-name selfRef">CA/Browser Forum Code-Signing</a>
        </h3>
<p id="section-8.2-1">TODO: ... intro text<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<p id="section-8.2-2">The subscriber <span class="bcp14">MUST</span>:<a href="#section-8.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.2-3.1">
            <p id="section-8.2-3.1.1">Provide the CA with a CSR containing the subscriber key.<a href="#section-8.2-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.2-3.2">
            <p id="section-8.2-3.2.1">Provide an attestation token as per this specification describing the private key protection properties of the subscriber's private key. This token <span class="bcp14">MAY</span> be transported inside the CSR as per draft-ietf-lamps-csr-attest, or it <span class="bcp14">MAY</span> be transported adjacent to the CSR over any other certificate enrollment mechanism.<a href="#section-8.2-3.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-8.2-4">The CA / RA / RP / Verifier <span class="bcp14">MUST</span>:<a href="#section-8.2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.2-5.1">
            <p id="section-8.2-5.1.1">Ensure that the subscriber key which is the subject of the CSR is also described by a KAT by matching either the key fingerprint or full SubjectPublicKeyInfo.<a href="#section-8.2-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.2-5.2">
            <p id="section-8.2-5.2.1">The hardware root-of-trust described by a PAT has a valid and active FIPS certificate according to the NIST CMVP database.<a href="#section-8.2-5.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.2-5.3">
            <p id="section-8.2-5.3.1">The attestation signing key (AK) which has signed the attestation token chains to a root certificate that A) belongs to the hardware vendor described in the PAT token, and B) is trusted by the CA / RA / RP / Verifier to endorse hardware from this vendor, for example through a CA's partner program or through a network operator's device on-boarding process.<a href="#section-8.2-5.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.2-5.4">
            <p id="section-8.2-5.4.1">The key is protected by a module running in FIPS mode. The parsing logic is to start at the leaf KAT token that matches the key in the CSR and parsing towards the root PAT ensuring that there is at least one <code>fipsboot=true</code> and no <code>fipsboot=false</code> on that path.<a href="#section-8.2-5.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="sec-reqs">
<section id="section-9">
      <h2 id="name-attestation-requests">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-attestation-requests" class="section-name selfRef">Attestation Requests</a>
      </h2>
<p id="section-9-1">This section is informative in nature and implementers of this specification do not need to adhere to it. The aim of this section is
to provide a standard interface between a Presenter and a HSM producing PKIX evidence. The authors hope that this standard interface will
yield interoperable tools between offerings from different vendors.<a href="#section-9-1" class="pilcrow">¶</a></p>
<p id="section-9-2">The interface presented in this section might be too complex for manufacturers of HSMs with limited capabilities such as smartcards
or personal ID tokens. For devices with limited capabilities, a fix attestation message endorsed by the vendor might be installed
during manufacturing. Other approaches for constrained HSMs might be to report entities and attributes that are fixed or offer limited
variations.<a href="#section-9-2" class="pilcrow">¶</a></p>
<p id="section-9-3">On the other hand, an enterprise grade HSM with the capability to hold a large number of private keys is expected to be capable of generating
attestation messages catered to the specific constraints imposed by a Verifier and without exposing extraneous information. The aim of the request
interface is to provide the means to select and report specific information in an attestation message.<a href="#section-9-3" class="pilcrow">¶</a></p>
<p id="section-9-4">This section introduces the role of "Presenter" as shown in <a href="#fig-arch" class="auto internal xref">Figure 1</a>. The Presenter is the role that initiates the generation of an
attestation message. Since HSMs are generally servers (client/server relationship) or slaves (master/slave relationship), an entity is
required to launch the process of creating the attestation message and capturing its results. The results are then forwarded to the Verifier.<a href="#section-9-4" class="pilcrow">¶</a></p>
<span id="name-architecture"></span><div id="fig-arch">
<figure id="figure-1">
        <div id="section-9-5.1">
          <div class="alignLeft art-svg artwork" id="section-9-5.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="464" width="392" viewBox="0 0 392 464" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 8,32 L 8,336" fill="none" stroke="black"></path>
              <path d="M 48,416 L 48,448" fill="none" stroke="black"></path>
              <path d="M 64,80 L 64,160" fill="none" stroke="black"></path>
              <path d="M 64,240 L 64,288" fill="none" stroke="black"></path>
              <path d="M 112,296 L 112,408" fill="none" stroke="black"></path>
              <path d="M 128,160 L 128,232" fill="none" stroke="black"></path>
              <path d="M 136,288 L 136,408" fill="none" stroke="black"></path>
              <path d="M 184,80 L 184,160" fill="none" stroke="black"></path>
              <path d="M 184,416 L 184,448" fill="none" stroke="black"></path>
              <path d="M 216,240 L 216,288" fill="none" stroke="black"></path>
              <path d="M 248,32 L 248,336" fill="none" stroke="black"></path>
              <path d="M 280,416 L 280,448" fill="none" stroke="black"></path>
              <path d="M 384,416 L 384,448" fill="none" stroke="black"></path>
              <path d="M 8,32 L 248,32" fill="none" stroke="black"></path>
              <path d="M 64,80 L 184,80" fill="none" stroke="black"></path>
              <path d="M 64,160 L 184,160" fill="none" stroke="black"></path>
              <path d="M 64,240 L 216,240" fill="none" stroke="black"></path>
              <path d="M 64,288 L 216,288" fill="none" stroke="black"></path>
              <path d="M 8,336 L 248,336" fill="none" stroke="black"></path>
              <path d="M 48,416 L 184,416" fill="none" stroke="black"></path>
              <path d="M 280,416 L 384,416" fill="none" stroke="black"></path>
              <path d="M 192,432 L 272,432" fill="none" stroke="black"></path>
              <path d="M 48,448 L 184,448" fill="none" stroke="black"></path>
              <path d="M 280,448 L 384,448" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="280,432 268,426.4 268,437.6" fill="black" transform="rotate(0,272,432)"></polygon>
              <polygon class="arrowhead" points="144,408 132,402.4 132,413.6" fill="black" transform="rotate(90,136,408)"></polygon>
              <polygon class="arrowhead" points="136,232 124,226.4 124,237.6" fill="black" transform="rotate(90,128,232)"></polygon>
              <polygon class="arrowhead" points="120,296 108,290.4 108,301.6" fill="black" transform="rotate(270,112,296)"></polygon>
              <g class="text">
                <text x="60" y="52">Attester</text>
                <text x="120" y="52">(HSM)</text>
                <text x="100" y="100">Target</text>
                <text x="120" y="116">Environment</text>
                <text x="120" y="132">(Entities,&amp;</text>
                <text x="128" y="148">attributes)</text>
                <text x="168" y="196">Collect</text>
                <text x="164" y="212">Claims</text>
                <text x="112" y="260">Attesting</text>
                <text x="120" y="276">Environment</text>
                <text x="56" y="372">Attestation</text>
                <text x="180" y="372">PKIX</text>
                <text x="40" y="388">Request</text>
                <text x="196" y="388">Evidence</text>
                <text x="120" y="436">Presenter</text>
                <text x="332" y="436">Verifier</text>
              </g>
            </svg><a href="#section-9-5.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-architecture" class="selfRef">Architecture</a>
        </figcaption></figure>
</div>
<p id="section-9-6">An Attestation Request (request) is assembled by the Presenter and submitted to the HSM. The HSM parses the request and produces PKIX evidence,
the attestation message, which is returned to the Presenter for distribution.<a href="#section-9-6" class="pilcrow">¶</a></p>
<p id="section-9-7">The request consists of a structure TbsPkixEvidence containing one ReportedEntity for each entity expected to be attested by the HSM.
Each instance of ReportedEntity included in the request is referred to as a request entity. A request entity contains a number of instances
of ReportedAttribute known as request attributes. The collection of request entities and request attributes represent the information desired
by the Presenter.<a href="#section-9-7" class="pilcrow">¶</a></p>
<p id="section-9-8">In most cases the value of a request attribute should be left unspecified by the Presenter. In the process of generating
the evidence, the values of the desired attributes are observed by the attestation service within the HSM and reporte accordingly. For the purpose
of creating a request, the Presenter sets the values of the attributes to <code>null</code>. This is a departure from the values specified for each attribute
but serves well the purposes of the request.<a href="#section-9-8" class="pilcrow">¶</a></p>
<p id="section-9-9">On the other hand, there are circumstances where the value of a request attribute should be provided by the Presenter. For example, when a particular
cryptographic key is to be included in the attestation message, the request must include a request entity with one of its attribute set with a type
<code>id-pkix-evidence-attribute-key-identifier</code>. The value of this attribute is set to the key identifier associated with the cryptographic
key to be reported.<a href="#section-9-9" class="pilcrow">¶</a></p>
<p id="section-9-10">Some instances of ReportedEntity, such as those representing the platform or the transaction, do not need identifiers as the associated entities are
implicit in nature. Custom entity types might need selection during an attestation request and related documentation should specify how this is
achieved.<a href="#section-9-10" class="pilcrow">¶</a></p>
<p id="section-9-11">The instance of TbsPkixEvidence is unsigned and does not provided any means to maintain integrity when communicated from the Presenter to the HSM.
These details are left to the implementer. However, it is worth pointing out that the structure offered by PkixEvidence could be reused by an
implementer to provide those capabilities.<a href="#section-9-11" class="pilcrow">¶</a></p>
<div id="request-attributes-with-specified-values">
<section id="section-9.1">
        <h3 id="name-request-attributes-with-spe">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-request-attributes-with-spe" class="section-name selfRef">Request Attributes with Specified Values</a>
        </h3>
<p id="section-9.1-1">This section deals with the request attributes specified in this document where a value should be provided by a Presenter. In other words, this
sub-section defines all request attributes that should not be <code>null</code>. Request attributes not covered in this sub-section should have a value
of <code>null</code>.<a href="#section-9.1-1" class="pilcrow">¶</a></p>
<p id="section-9.1-2">Since this section is non-normative, implementers may deviate from those recommendations.<a href="#section-9.1-2" class="pilcrow">¶</a></p>
<div id="key-identifiers">
<section id="section-9.1.1">
          <h4 id="name-key-identifiers">
<a href="#section-9.1.1" class="section-number selfRef">9.1.1. </a><a href="#name-key-identifiers" class="section-name selfRef">Key Identifiers</a>
          </h4>
<p id="section-9.1.1-1">A Presenter may choose to select which cryptographic keys are reported as part of the PKIX evidence. For each selected cryptographic key,
the Presenter includes a request entity of type <code>id-pkix-evidence-entity-key</code>. Among the request attributes for this entity, the
Presenter includes one attribute with the type <code>id-pkix-evidence-attribute-key-identifier</code>. The value of this attribute should be
set to the utf8String that represents the identifiers for the specific key.<a href="#section-9.1.1-1" class="pilcrow">¶</a></p>
<p id="section-9.1.1-2">A HSM receiving an attestation request which selects a key via this approach <span class="bcp14">MUST</span> fail the transaction if it can not find the cryptographic
key associated with the specified identifier.<a href="#section-9.1.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="nonce-1">
<section id="section-9.1.2">
          <h4 id="name-nonce-2">
<a href="#section-9.1.2" class="section-number selfRef">9.1.2. </a><a href="#name-nonce-2" class="section-name selfRef">Nonce</a>
          </h4>
<p id="section-9.1.2-1">A Presenter may choose to include a nonce as part of the attestation request. When producing the PKIX evidence, the HSM repeats the
nonce that was provided as part of the request.<a href="#section-9.1.2-1" class="pilcrow">¶</a></p>
<p id="section-9.1.2-2">When providing a nonce, a Presenter includes, in the attestation request, an entity of type <code>id-pkix-evidence-entity-transaction</code>
with an attribute of type <code>id-pkix-evidence-attribute-transaction-nonce</code>. This attribute is set with the value of the
nonce as "bytes".<a href="#section-9.1.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="custom-key-selection">
<section id="section-9.1.3">
          <h4 id="name-custom-key-selection">
<a href="#section-9.1.3" class="section-number selfRef">9.1.3. </a><a href="#name-custom-key-selection" class="section-name selfRef">Custom Key Selection</a>
          </h4>
<p id="section-9.1.3-1">An implementer might desire to select multiple cryptographic keys based on a shared attribute or similar schemes. A possible approach
is to include a single request entity of type <code>id-pkix-evidence-entity-key</code> including an attribute with a set value. This attribute
would not be related to the key identifier as this is unique to each key. A HSM supporting this scheme could select all the cryptographic
keys matching the specified attribute and report them in the attestation message.<a href="#section-9.1.3-1" class="pilcrow">¶</a></p>
<p id="section-9.1.3-2">This is a departure from the base request interface, as multiple key entities are reported from a single request entity.<a href="#section-9.1.3-2" class="pilcrow">¶</a></p>
<p id="section-9.1.3-3">More elaborate selection schemes are envisaged where multiple request attributes specifying values would be tested against cryptographic keys.
Whether these attributes are combined in a logic "and" or in a logical "or" would need to be specified by the implementer.<a href="#section-9.1.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="custom-transaction-attribute">
<section id="section-9.1.4">
          <h4 id="name-custom-transaction-attribut">
<a href="#section-9.1.4" class="section-number selfRef">9.1.4. </a><a href="#name-custom-transaction-attribut" class="section-name selfRef">Custom Transaction Attribute</a>
          </h4>
<p id="section-9.1.4-1">The extensibility offered by the proposed request interface allows an implementer to add custom attributes to the transaction entity in
order to influence the way that the evidence generation is performed.<a href="#section-9.1.4-1" class="pilcrow">¶</a></p>
<p id="section-9.1.4-2">In such an approach, a new custom attribute for request entities of type <code>id-pkix-evidence-entity-transaction</code> is defined. Then, an
attribute of that type is included in the attestation request (as part of the transaction entity) while specifying a value. This value
is considered by the HSM while generating the attestation message.<a href="#section-9.1.4-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="processing-an-attestation-request">
<section id="section-9.2">
        <h3 id="name-processing-an-attestation-r">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-processing-an-attestation-r" class="section-name selfRef">Processing an Attestation Request</a>
        </h3>
<p id="section-9.2-1">This sub-section deals with the rules that should be considered when an Attester (the HSM) processes a request to generate an
attestation request. This section is non-normative and implementers <span class="bcp14">MAY</span> choose to not follow those recommendations.<a href="#section-9.2-1" class="pilcrow">¶</a></p>
<p id="section-9.2-2">These recommendations apply to any attestation request schemes and are not restricted solely to the request interface proposed
here.<a href="#section-9.2-2" class="pilcrow">¶</a></p>
<p id="section-9.2-3">An Attester <span class="bcp14">MUST</span> fail an attestation request if it contains an unrecognized entity type. This is to ensure that all the semantics expected
by the Presenter are fully understood by the Attester.<a href="#section-9.2-3" class="pilcrow">¶</a></p>
<p id="section-9.2-4">An Attester <span class="bcp14">MUST</span> fail an attestation request if it contains a request attribute of an unrecognized type while specifying a value (other than
null). This represents a situation where the Presenter is selecting specific information that is not understood by the Attester.<a href="#section-9.2-4" class="pilcrow">¶</a></p>
<p id="section-9.2-5">An Attester <span class="bcp14">SHOULD</span> fail an attestation request if it contains a request attribute with an unrecognized type. An environment with an Attester
that ignores unrecognized attributes forces the Presenter to review the generated evidence for necessary information.<a href="#section-9.2-5" class="pilcrow">¶</a></p>
<p id="section-9.2-6">An Attester <span class="bcp14">MUST</span> omit including entities and attributes in the generated attestation message is these entities and attributes were
not specified as part of the request. This is to give the Presenter the control on what information is disclosed b ythe Attester.<a href="#section-9.2-6" class="pilcrow">¶</a></p>
<p id="section-9.2-7">An Attester <span class="bcp14">MUST</span> fail an attestation request is the Presenter does not have the appropriate access rights to the entities included
in the request.<a href="#section-9.2-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="verification-by-presenter">
<section id="section-9.3">
        <h3 id="name-verification-by-presenter">
<a href="#section-9.3" class="section-number selfRef">9.3. </a><a href="#name-verification-by-presenter" class="section-name selfRef">Verification by Presenter</a>
        </h3>
<p id="section-9.3-1">This sub-section deals with the rules that should be considered when a Presenter receives an attestation message from the Attester (the HSM)
prior to distribution. This section is non-normative and implementers <span class="bcp14">MAY</span> choose to not follow those recommendations.<a href="#section-9.3-1" class="pilcrow">¶</a></p>
<p id="section-9.3-2">These recommendations apply to any attestation messages and are not restricted solely messages generated from the proposed request interface.<a href="#section-9.3-2" class="pilcrow">¶</a></p>
<p id="section-9.3-3">A Presenter <span class="bcp14">MUST</span> review the attestation message produced by an Attester for fitness prior to distribution.<a href="#section-9.3-3" class="pilcrow">¶</a></p>
<p id="section-9.3-4">A Presenter <span class="bcp14">MUST</span> not disclose an attestation message if it contains information it can not parse. This restriction applies to entity types and
attributes type. This is to ensure that the information provided b ythe Attester can be evaluated by the Presenter.<a href="#section-9.3-4" class="pilcrow">¶</a></p>
<p id="section-9.3-5">A Presenter <span class="bcp14">MUST</span> not disclose an attestation message if it contains entities others than the ones that were requested of the Attester. This is
to ensure that only the selected entities are exposed to the Verifier.<a href="#section-9.3-5" class="pilcrow">¶</a></p>
<p id="section-9.3-6">A Predenter <span class="bcp14">MUST</span> not disclose an attestation message if it contains an entity with an attribute that was not requested of the Attester. This is
to ensure that only the selected information is disclosed to the Verifier.<a href="#section-9.3-6" class="pilcrow">¶</a></p>
<p id="section-9.3-7">Further privacy concerns are discussed in <a href="#sec-cons-privacy" class="auto internal xref">Section 12.4</a>.<a href="#section-9.3-7" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-asn1-mod">
<section id="section-10">
      <h2 id="name-asn1-module">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-asn1-module" class="section-name selfRef">ASN.1 Module</a>
      </h2>
<div class="breakable lang-asn.1 sourcecode" id="section-10-1">
<pre>
&lt;CODE STARTS&gt;

PKIX-Evidence-2025
      { iso(1) identified-organization(3) dod(6) internet(1)
        security(5) mechanisms(5) pkix(7) id-mod(0)
        id-mod-pkix-evidence-2025(TBDMOD) }


PkixEvidence ::= SEQUENCE {
    tbs TbsPkixAttestation,
    signatures SEQUENCE SIZE (0..MAX) of SignatureBlock
}

TbsPkixEvidence ::= SEQUENCE {
    version INTEGER,
    reportedEntities SEQUENCE SIZE (1..MAX) OF ReportedEntity
}

ReportedEntity ::= SEQUENCE {
    entityType         OBJECT IDENTIFIER,
    reportedAttributes SEQUENCE SIZE (1..MAX) OF ReportedAttribute
}

ReportedAttribute ::= SEQUENCE {
    attributeType      OBJECT IDENTIFIER,
    value              AttributeValue
}

AttributeValue :== CHOICE {
   bytes       [0] IMPLICIT OCTET STRING
   utf8String  [1] IMPLICIT UTF8String,
   bool        [2] IMPLICIT BOOLEAN,
   time        [3] IMPLICIT GeneralizedTime,
   int         [4] IMPLICIT INTEGER,
   oid         [5] IMPLICIT OBJECT IDENTIFIER,
   null        [6] IMPLICIT NULL
}

SignatureBlock ::= SEQUENCE {
   certChain SEQUENCE of Certificate,
   signatureAlgorithm AlgorithmIdentifier,
   signatureValue OCTET STRING
}

id-pkix-evidence OBJECT IDENTIFIER ::= { 1 2 3 999 }

id-pkix-evidence-entity-type        OBJECT IDENTIFIER ::= { id-pkix-evidence- 0 }
id-pkix-evidence-entity-transaction OBJECT IDENTIFIER ::= { id-pkix-evidence-entity-type 0 }
id-pkix-evidence-entity-platform    OBJECT IDENTIFIER ::= { id-pkix-evidence-entity-type 1 }
id-pkix-evidence-entity-key         OBJECT IDENTIFIER ::= { id-pkix-evidence-entity-type 2 }

id-pkix-evidence-attribute-type OBJECT IDENTIFIER ::= { id-pkix-evidence- 1 }

id-pkix-evidence-attribute-transaction           OBJECT IDENTIFIER ::= { id-pkix-evidence-attribute-type 0 }
id-pkix-evidence-attribute-transaction-nonce     OBJECT IDENTIFIER ::= { id-pkix-evidence-attribute-transaction 0 }
id-pkix-evidence-attribute-transaction-timestamp OBJECT IDENTIFIER ::= { id-pkix-evidence-attribute-transaction 1 }

id-pkix-evidence-attribute-platform            OBJECT IDENTIFIER ::= { id-pkix-evidence-attribute-type 1 }
id-pkix-evidence-attribute-platform-vendor     OBJECT IDENTIFIER ::= { id-pkix-evidence-attribute-platform 0 }
id-pkix-evidence-attribute-platform-hwserial   OBJECT IDENTIFIER ::= { id-pkix-evidence-attribute-platform 1 }
id-pkix-evidence-attribute-platform-fipsboot   OBJECT IDENTIFIER ::= { id-pkix-evidence-attribute-platform 2 }
id-pkix-evidence-attribute-platform-model      OBJECT IDENTIFIER ::= { id-pkix-evidence-attribute-platform 3 }
id-pkix-evidence-attribute-platform-swversion  OBJECT IDENTIFIER ::= { id-pkix-evidence-attribute-platform 4 }
id-pkix-evidence-attribute-platform-oemid      OBJECT IDENTIFIER ::= { id-pkix-evidence-attribute-platform 5 }
id-pkix-evidence-attribute-platform-debugstat  OBJECT IDENTIFIER ::= { id-pkix-evidence-attribute-platform 6 }
id-pkix-evidence-attribute-platform-uptime     OBJECT IDENTIFIER ::= { id-pkix-evidence-attribute-platform 7 }
id-pkix-evidence-attribute-platform-bootcount  OBJECT IDENTIFIER ::= { id-pkix-evidence-attribute-platform 8 }
id-pkix-evidence-attribute-platform-usermods   OBJECT IDENTIFIER ::= { id-pkix-evidence-attribute-platform 9 }
id-pkix-evidence-attribute-platform-envid      OBJECT IDENTIFIER ::= { id-pkix-evidence-attribute-platform 10 }
id-pkix-evidence-attribute-platform-envdesc    OBJECT IDENTIFIER ::= { id-pkix-evidence-attribute-platform 11 }
id-pkix-evidence-attribute-platform-fipsver    OBJECT IDENTIFIER ::= { id-pkix-evidence-attribute-platform 12 }
id-pkix-evidence-attribute-platform-fipslevel  OBJECT IDENTIFIER ::= { id-pkix-evidence-attribute-platform 13 }



id-pkix-evidence-attribute-key                   OBJECT IDENTIFIER ::= { id-pkix-evidence-attribute-type 2 }
id-pkix-evidence-attribute-key-identifier        OBJECT IDENTIFIER ::= { id-pkix-evidence-attribute-key 0 }
id-pkix-evidence-attribute-key-spki              OBJECT IDENTIFIER ::= { id-pkix-evidence-attribute-key 1 }
id-pkix-evidence-attribute-key-purpose           OBJECT IDENTIFIER ::= { id-pkix-evidence-attribute-key 2 }
id-pkix-evidence-attribute-key-extractable       OBJECT IDENTIFIER ::= { id-pkix-evidence-attribute-key 3 }
id-pkix-evidence-attribute-key-never-extractable OBJECT IDENTIFIER ::= { id-pkix-evidence-attribute-key 4 }
id-pkix-evidence-attribute-key-local             OBJECT IDENTIFIER ::= { id-pkix-evidence-attribute-key 5 }
id-pkix-evidence-attribute-key-expiry            OBJECT IDENTIFIER ::= { id-pkix-evidence-attribute-key 6 }
id-pkix-evidence-attribute-key-protection        OBJECT IDENTIFIER ::= { id-pkix-evidence-attribute-key 7 }
id-pkix-evidence-attribute-key-sensitive         OBJECT IDENTIFIER ::= { id-pkix-evidence-attribute-key 8 }

&lt;CODE ENDS&gt;

</pre><a href="#section-10-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-11">
      <h2 id="name-iana-considerations">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-11-1">Please replace "RFCthis" with the RFC number assigned to this document.<a href="#section-11-1" class="pilcrow">¶</a></p>
<p id="section-11-2">TODO: list out all the OIDs that need IANA registration.<a href="#section-11-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-considerations">
<section id="section-12">
      <h2 id="name-security-considerations">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<div id="policies-relating-to-verifier-and-relying-party">
<section id="section-12.1">
        <h3 id="name-policies-relating-to-verifi">
<a href="#section-12.1" class="section-number selfRef">12.1. </a><a href="#name-policies-relating-to-verifi" class="section-name selfRef">Policies relating to Verifier and Relying Party</a>
        </h3>
<p id="section-12.1-1">The generation of PKIX evidence by a HSM is to provide sufficient information to
a Verifier and a Relying Party to appraise the Target Environment (the HSM) and make
decisions based on this appraisal.<a href="#section-12.1-1" class="pilcrow">¶</a></p>
<p id="section-12.1-2">The Appraisal Policy associated with the Verifier influences the generation of the Attestation
Results. Those results, in turn, are consumed by Relying Party to make decisions about
the HSM, which might be based on a set of rules and policies. Therefore, the interpretation of
PKIX evidence may greatly influence the outcome of some decisions.<a href="#section-12.1-2" class="pilcrow">¶</a></p>
<p id="section-12.1-3">A Verifier <span class="bcp14">MAY</span> reject a PKIX Attestation if it lacks required attributes per their
appraisal policy. For example, if a Relying Party mandates a FIPS-certified device,
it <span class="bcp14">SHOULD</span> reject evidence lacking sufficient information to verify the device's FIPS
certification status.<a href="#section-12.1-3" class="pilcrow">¶</a></p>
<p id="section-12.1-4">If a Verifier encounters an attribute with an unrecognized attribute type, it <span class="bcp14">MAY</span> ignore it and
treat it as extraneous information. By ignoring an attribute, the Verifier may accept PKIX evidence
that would be deemed malformed to a Verifier with different policies. However, this approach
fosters a higher likelihood of achieving interoperability.<a href="#section-12.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-cons-simple">
<section id="section-12.2">
        <h3 id="name-simple-to-implement">
<a href="#section-12.2" class="section-number selfRef">12.2. </a><a href="#name-simple-to-implement" class="section-name selfRef">Simple to Implement</a>
        </h3>
<p id="section-12.2-1">The nature of attestation requires the attestation service to be implemented in an extremely privileged position within the HSM so that it can collect measurements of both the hardware environment and the user keys being attested. For many HSM and TPM architectures, this will place the Attestation Service inside the "HSM kernel" and potentially subject to FIPS 140-3 or Common Criteria validation and change control. For both security and compliance reasons there is incentive for the generation and parsing logic to be simple and easy to implement correctly. Additionally, when the data formats contained in this specification are parsed within an HSM boundary -- that would be parsing a request entity, or parsing an attestation produced by a different HSM -- implementers <span class="bcp14">SHOULD</span> opt for simple logic that rejects any data that does not match the expected format instead of attempting to be flexible.<a href="#section-12.2-1" class="pilcrow">¶</a></p>
<p id="section-12.2-2">In particular, Attesting Services <span class="bcp14">SHOULD</span> generate the attestation object from scratch and avoid copying any content from the request. Attesting Services <span class="bcp14">MUST NOT</span> allow unrecognized attributes or any attribute value other than the nonce to be echoed from the request into the attestation object.<a href="#section-12.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-detached-sigs">
<section id="section-12.3">
        <h3 id="name-detached-signatures">
<a href="#section-12.3" class="section-number selfRef">12.3. </a><a href="#name-detached-signatures" class="section-name selfRef">Detached Signatures</a>
        </h3>
<p id="section-12.3-1">TODO beef this up<a href="#section-12.3-1" class="pilcrow">¶</a></p>
<p id="section-12.3-2">No indication within the tbs content about what or how many signatures to expect.<a href="#section-12.3-2" class="pilcrow">¶</a></p>
<p id="section-12.3-3">A SignatureBlock can be trivially stripped off without leaving any evidence.<a href="#section-12.3-3" class="pilcrow">¶</a></p>
<p id="section-12.3-4">When multiple SignatureBlocks are used for providing third party counter-signatures, note that the counter signature only covers the tbs content and not existing SignatureBlocks.<a href="#section-12.3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-cons-privacy">
<section id="section-12.4">
        <h3 id="name-privacy">
<a href="#section-12.4" class="section-number selfRef">12.4. </a><a href="#name-privacy" class="section-name selfRef">Privacy</a>
        </h3>
<p id="section-12.4-1">Often, a TPM will host cryptographic keys for both the kernel and userspace of a local operating system but a Presenter may only represents a single user or application.
Similarly, a single enterprise-grade Hardware Security Module will often host cryptographic keys for an entire multi-tenant cloud service and the Presenter or Reciever or Recipient belongs only to a single tenant. For example the HSM backing a TLS-terminating loadbalancer fronting thousands of un-related web domains.
In these cases, disclosing that two different keys reside on the same hardware, or in some cases even disclosing the existance of a given key, let alone its attributes, to an unauthorized party would constitute an egregious privacy violation.<a href="#section-12.4-1" class="pilcrow">¶</a></p>
<p id="section-12.4-2">Implementions <span class="bcp14">SHOULD</span> be careful to avoid over-disclosure of information, for example by authenticating the Presenter as described in <a href="#sec-cons-auth-the-presenter" class="auto internal xref">Section 12.5</a> and only returning results for keys and envirnments for which it is authorized.
In absence of an existing mechanism for authenticating and authorizing administrative connections to the HSM, the attestation request <span class="bcp14">MAY</span> be authenticated by embedding the ClaimDescriptionTbs of the request inside a PkixEvidence signed with a certificate belogning to the Presenter.<a href="#section-12.4-2" class="pilcrow">¶</a></p>
<p id="section-12.4-3">Furthermore, enterprise and cloud-services grade HSMs <span class="bcp14">SHOULD</span> support the full set of attestation request functionality described in <a href="#sec-reqs" class="auto internal xref">Section 9</a> so that Presenters can fine-tune the content of a PKIX Attestation such that it is appropriate for the intended Recipient.<a href="#section-12.4-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-cons-auth-the-presenter">
<section id="section-12.5">
        <h3 id="name-authenticating-and-authoriz">
<a href="#section-12.5" class="section-number selfRef">12.5. </a><a href="#name-authenticating-and-authoriz" class="section-name selfRef">Authenticating and Authorizing the Presenter</a>
        </h3>
<p id="section-12.5-1">The Presenter represents a priviledged role within the architecture of this specification as it gets to learn about the existence of user keys and their protection properties, as well as details of the platform.
The Presenter is in the position of deciding how much information to disclose to the Recipient, and to request a suitably redacted attestation from the HSM.<a href="#section-12.5-1" class="pilcrow">¶</a></p>
<p id="section-12.5-2">For personal cryptographic tokens it might be appropriate for the attestation request interface to be un-authenticated. However, for enterprise and cloud-services grade HSMs the Presenter <span class="bcp14">SHOULD</span> be authenticated using the HSM's native authentication mechanism. The details will be HSM-specific and are thus left up to the implementer, however it is <span class="bcp14">RECOMMENDED</span> to implement an authorization framework similar to the following.<a href="#section-12.5-2" class="pilcrow">¶</a></p>
<p id="section-12.5-3">A Presenter <span class="bcp14">SHOULD</span> be allowed to request attestation for any user keys which it is allowed to use.
For example, a TLS application that is correctly authenticated to the HSM in order to use its TLS keys <span class="bcp14">SHOULD</span> be able to request attestation of those same keys without needing to perform any additional authentication or requiring any additional roles or permissions.
HSMs that wish to allow a Presenter to request attestation of keys which is not allowed to use, for example for the purposes of displaying HSM status information on an administrative console or UI, <span class="bcp14">SHOULD</span> have a "Attestation Requester" role or permission and <span class="bcp14">SHOULD</span> enforce the HSM's native access controls such that the Presenter can only retrieve attestations for keys for which it has read access.<a href="#section-12.5-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="proof-of-possession-of-user-keys">
<section id="section-12.6">
        <h3 id="name-proof-of-possession-of-user">
<a href="#section-12.6" class="section-number selfRef">12.6. </a><a href="#name-proof-of-possession-of-user" class="section-name selfRef">Proof-of-Possession of User Keys</a>
        </h3>
<p id="section-12.6-1">With asymmetric keys within a Public Key Infrastructure (PKI) it is common to require a key holder to prove that they are in control of the private key by using it. This is called "proof-of-possession (PoP)". This specification intentionally does not provide a mechanism for PoP of user keys and relies on the Presenter, Recipient, Verifier, and Relying Party trusting the Attester to correctly report the cryptographic keys that it is holding.<a href="#section-12.6-1" class="pilcrow">¶</a></p>
<p id="section-12.6-2">It would be easy to add a PoP Key Attribute that uses the attested user key to sign over, for example, the Transaction Entity, however this is a bad idea and <span class="bcp14">MUST NOT</span> be added as a custom attribute for several reasons.<a href="#section-12.6-2" class="pilcrow">¶</a></p>
<p id="section-12.6-3">First, an application key intended, for example, for TLS <span class="bcp14">SHOULD</span> only be used with the TLS protocol and introducing a signature oracle whereby the TLS application key is used to sign attestation content could lead to cross-protocol attacks whereby the attacker submits a nonce value which is in fact not random but is crafted in such a way as to appear as a valid message in some other protocol context or exploit some other weakness in the signature algorithm.<a href="#section-12.6-3" class="pilcrow">¶</a></p>
<p id="section-12.6-4">Second, the Presenter who has connected to the HSM to request an attestation may have permissions to view the requested application keys but not permission to use them, as in the case where the Presenter is an administrative UI displaying HSM status information to an systems administrator or auditor.
Requiring the Attestation Service to use the attested application keys could, in some architectures, require the Attestation Service to resolve complex access control logic and handle complex error conditions for each requested key, which violates the "simple to implement" design principle outlined in <a href="#sec-cons-simple" class="auto internal xref">Section 12.2</a>. More discussion of authenticating the Presenter can be found in <a href="#sec-cons-auth-the-presenter" class="auto internal xref">Section 12.5</a>.<a href="#section-12.6-4" class="pilcrow">¶</a></p>
<p id="section-12.6-5">In cases where explicit PoP is required for a given attested application key, it <span class="bcp14">MUST</span> be done as part of the regular usage protocol for which that key is intended and performed through the HSM's regular application interface, not its attestation interface. For example, PoP could be performed by signing a Certificate Signing Request (CSR), through a PKI enrollment protocol such as Certificate Management Protocol (CMP) which includes a challenge-response PoP, by using the key within a TLS handshake, or some other protocol which is part of the key's intended usage.<a href="#section-12.6-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-combined-references">
<section id="section-13">
      <h2 id="name-references">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-13.1">
        <h3 id="name-normative-references">
<a href="#section-13.1" class="section-number selfRef">13.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="FIPS.140-3">[FIPS.140-3]</dt>
        <dd>
<span class="refAuthor">NIST - Information Technology Laboratory</span>, <span class="refTitle">"SECURITY REQUIREMENTS FOR CRYPTOGRAPHIC MODULES"</span>, <span class="seriesInfo">FIPS 140-3</span>, <span>n.d.</span>, <span>&lt;<a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.140-3.pdf">https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.140-3.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="PKCS11">[PKCS11]</dt>
        <dd>
<span class="refAuthor">Cox, D. B. T.</span>, <span class="refTitle">"PKCS #11 Specification Version 3.1"</span>, <span>n.d.</span>, <span>&lt;<a href="https://docs.oasis-open.org/pkcs11/pkcs11-spec/v3.1/cs01/pkcs11-spec-v3.1-cs01.html">https://docs.oasis-open.org/pkcs11/pkcs11-spec/v3.1/cs01/pkcs11-spec-v3.1-cs01.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5280">[RFC5280]</dt>
        <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Boeyen, S.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time datetime="2008-05" class="refDate">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5280">https://www.rfc-editor.org/rfc/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9334">[RFC9334]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Thaler, D.</span>, <span class="refAuthor">Richardson, M.</span>, <span class="refAuthor">Smith, N.</span>, and <span class="refAuthor">W. Pan</span>, <span class="refTitle">"Remote ATtestation procedureS (RATS) Architecture"</span>, <span class="seriesInfo">RFC 9334</span>, <span class="seriesInfo">DOI 10.17487/RFC9334</span>, <time datetime="2023-01" class="refDate">January 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9334">https://www.rfc-editor.org/rfc/rfc9334</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9711">[RFC9711]</dt>
        <dd>
<span class="refAuthor">Lundblade, L.</span>, <span class="refAuthor">Mandyam, G.</span>, <span class="refAuthor">O'Donoghue, J.</span>, and <span class="refAuthor">C. Wallace</span>, <span class="refTitle">"The Entity Attestation Token (EAT)"</span>, <span class="seriesInfo">RFC 9711</span>, <span class="seriesInfo">DOI 10.17487/RFC9711</span>, <time datetime="2025-04" class="refDate">April 2025</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9711">https://www.rfc-editor.org/rfc/rfc9711</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="X.680">[X.680]</dt>
        <dd>
<span class="refAuthor">ITU-T</span>, <span class="refTitle">"Information technology -- Abstract Syntax Notation One (ASN.1): Specification of basic notation"</span>, <span>n.d.</span>, <span>&lt;<a href="https://www.itu.int/rec/T-REC-X.680">https://www.itu.int/rec/T-REC-X.680</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="X.690">[X.690]</dt>
      <dd>
<span class="refAuthor">ITU-T</span>, <span class="refTitle">"Information technology - ASN.1 encoding Rules: Specification of Basic Encoding Rules (BER), Canonical Encoding Rules (CER) and Distinguished Encoding Rules (DER)"</span>, <span class="seriesInfo">ISO/IEC 8825-1:2015</span>, <time datetime="2015-11" class="refDate">November 2015</time>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-13.2">
        <h3 id="name-informative-references">
<a href="#section-13.2" class="section-number selfRef">13.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="CNSA2.0">[CNSA2.0]</dt>
        <dd>
<span class="refTitle">"Commercial National Security Algorithm Suite 2.0"</span>, <span>n.d.</span>, <span>&lt;<a href="https://media.defense.gov/2022/Sep/07/2003071834/-1/-1/0/CSA_CNSA_2.0_ALGORITHMS_.PDF">https://media.defense.gov/2022/Sep/07/2003071834/-1/-1/0/CSA_CNSA_2.0_ALGORITHMS_.PDF</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="codesigningbrsv3.8">[codesigningbrsv3.8]</dt>
        <dd>
<span class="refTitle">"Baseline Requirements for the Issuance and Management of Publicly‐Trusted Code Signing Certificates Version 3.8.0"</span>, <span>n.d.</span>, <span>&lt;<a href="https://cabforum.org/working-groups/code-signing/documents/">https://cabforum.org/working-groups/code-signing/documents/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.fossati-tls-attestation">[I-D.fossati-tls-attestation]</dt>
        <dd>
<span class="refAuthor">Tschofenig, H.</span>, <span class="refAuthor">Sheffer, Y.</span>, <span class="refAuthor">Howard, P.</span>, <span class="refAuthor">Mihalcea, I.</span>, <span class="refAuthor">Deshpande, Y.</span>, <span class="refAuthor">Niemi, A.</span>, and <span class="refAuthor">T. Fossati</span>, <span class="refTitle">"Using Attestation in Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-fossati-tls-attestation-09</span>, <time datetime="2025-04-30" class="refDate">30 April 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-fossati-tls-attestation-09">https://datatracker.ietf.org/doc/html/draft-fossati-tls-attestation-09</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-lamps-csr-attestation">[I-D.ietf-lamps-csr-attestation]</dt>
        <dd>
<span class="refAuthor">Ounsworth, M.</span>, <span class="refAuthor">Tschofenig, H.</span>, <span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Wiseman, M.</span>, and <span class="refAuthor">N. Smith</span>, <span class="refTitle">"Use of Remote Attestation with Certification Signing Requests"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-lamps-csr-attestation-19</span>, <time datetime="2025-05-25" class="refDate">25 May 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-lamps-csr-attestation-19">https://datatracker.ietf.org/doc/html/draft-ietf-lamps-csr-attestation-19</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-rats-msg-wrap">[I-D.ietf-rats-msg-wrap]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Smith, N.</span>, <span class="refAuthor">Fossati, T.</span>, <span class="refAuthor">Tschofenig, H.</span>, and <span class="refAuthor">D. Glaze</span>, <span class="refTitle">"RATS Conceptual Messages Wrapper (CMW)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-rats-msg-wrap-15</span>, <time datetime="2025-05-30" class="refDate">30 May 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-msg-wrap-15">https://datatracker.ietf.org/doc/html/draft-ietf-rats-msg-wrap-15</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2986">[RFC2986]</dt>
        <dd>
<span class="refAuthor">Nystrom, M.</span> and <span class="refAuthor">B. Kaliski</span>, <span class="refTitle">"PKCS #10: Certification Request Syntax Specification Version 1.7"</span>, <span class="seriesInfo">RFC 2986</span>, <span class="seriesInfo">DOI 10.17487/RFC2986</span>, <time datetime="2000-11" class="refDate">November 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2986">https://www.rfc-editor.org/rfc/rfc2986</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4211">[RFC4211]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate Request Message Format (CRMF)"</span>, <span class="seriesInfo">RFC 4211</span>, <span class="seriesInfo">DOI 10.17487/RFC4211</span>, <time datetime="2005-09" class="refDate">September 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4211">https://www.rfc-editor.org/rfc/rfc4211</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6024">[RFC6024]</dt>
        <dd>
<span class="refAuthor">Reddy, R.</span> and <span class="refAuthor">C. Wallace</span>, <span class="refTitle">"Trust Anchor Management Requirements"</span>, <span class="seriesInfo">RFC 6024</span>, <span class="seriesInfo">DOI 10.17487/RFC6024</span>, <time datetime="2010-10" class="refDate">October 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6024">https://www.rfc-editor.org/rfc/rfc6024</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9019">[RFC9019]</dt>
      <dd>
<span class="refAuthor">Moran, B.</span>, <span class="refAuthor">Tschofenig, H.</span>, <span class="refAuthor">Brown, D.</span>, and <span class="refAuthor">M. Meriac</span>, <span class="refTitle">"A Firmware Update Architecture for Internet of Things"</span>, <span class="seriesInfo">RFC 9019</span>, <span class="seriesInfo">DOI 10.17487/RFC9019</span>, <time datetime="2021-04" class="refDate">April 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9019">https://www.rfc-editor.org/rfc/rfc9019</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="samples">
<section id="appendix-A">
      <h2 id="name-samples">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-samples" class="section-name selfRef">Samples</a>
      </h2>
<p id="appendix-A-1">A reference implementation of this specification can be found at https://github.com/ietf-rats-wg/key-attestation<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<p id="appendix-A-2">It produces the following sample attestation:<a href="#appendix-A-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A-3">
<pre>
PkixAttestation:
 tbs=TbsPkixAttestation:
  version=2
  reportedEntities=SequenceOf:
   ReportedEntity:
    entityType=1.2.3.999.0.0
    reportedAttributes=SequenceOf:
     ReportedAttribute:
      attributeType=1.2.3.999.1.0.0
      value=AttributeValue:
       bytes=0102030405


   ReportedEntity:
    entityType=1.2.3.999.0.1
    reportedAttributes=SequenceOf:
     ReportedAttribute:
      attributeType=1.2.3.999.1.1.1
      value=AttributeValue:
       utf8String=HSM-123

     ReportedAttribute:
      attributeType=1.2.3.999.1.1.2
      value=AttributeValue:
       bool=True

     ReportedAttribute:
      attributeType=1.2.3.999.1.1.3
      value=AttributeValue:
       utf8String=Model ABC

     ReportedAttribute:
      attributeType=1.2.3.999.1.1.4
      value=AttributeValue:
       utf8String=3.1.9


   ReportedEntity:
    entityType=1.2.3.999.0.2
    reportedAttributes=SequenceOf:
     ReportedAttribute:
      attributeType=1.2.3.999.1.2.0
      value=AttributeValue:
       utf8String=26d765d8-1afd-4dfb-a290-cf867ddecfa1

     ReportedAttribute:
      attributeType=1.2.3.999.1.2.3
      value=AttributeValue:
       bool=False

     ReportedAttribute:
      attributeType=1.2.3.999.1.2.1
      value=AttributeValue:
       bytes=0x3059301306072a8648ce3d020106082a8648ce3d03010703420004422548f88fb782ffb5eca3744452c72a1e558fbd6f73be5e48e93232cc45c5b16c4cd10c4cb8d5b8a17139e94882c8992572993425f41419ab7e90a42a494272


   ReportedEntity:
    entityType=1.2.3.999.0.2
    reportedAttributes=SequenceOf:
     ReportedAttribute:
      attributeType=1.2.3.999.1.2.0
      value=AttributeValue:
       utf8String=49a96ace-e39a-4fd2-bec1-13165a99621c

     ReportedAttribute:
      attributeType=1.2.3.999.1.2.3
      value=AttributeValue:
       bool=True

     ReportedAttribute:
      attributeType=1.2.3.999.1.2.1
      value=AttributeValue:
       bytes=0x3059301306072a8648ce3d020106082a8648ce3d03010703420004422548f88fb782ffb5eca3744452c72a1e558fbd6f73be5e48e93232cc45c5b16c4cd10c4cb8d5b8a17139e94882c8992572993425f41419ab7e90a42a494272


   ReportedEntity:
    entityType=1.2.3.888.0
    reportedAttributes=SequenceOf:
     ReportedAttribute:
      attributeType=1.2.3.888.1
      value=AttributeValue:
       utf8String=partition 1




 signatures=SequenceOf:
  SignatureBlock:
   certChain=SequenceOf:
    Certificate:
     tbsCertificate=TBSCertificate:
      version=v3
      serialNumber=510501933685942792810365453374472870755160518925
      signature=AlgorithmIdentifier:
       algorithm=1.2.840.113549.1.1.11
       parameters=0x0500

      issuer=Name:
       rdnSequence=RDNSequence:
        RelativeDistinguishedName:
         AttributeTypeAndValue:
          type=2.5.4.10
          value=0x0c0449455446
        RelativeDistinguishedName:
         AttributeTypeAndValue:
          type=2.5.4.11
          value=0x0c0452415453
        RelativeDistinguishedName:
         AttributeTypeAndValue:
          type=2.5.4.3
          value=0x0c06414b20525341


      validity=Validity:
       notBefore=Time:
        utcTime=250117171303Z

       notAfter=Time:
        generalTime=20520604171303Z


      subject=Name:
       rdnSequence=RDNSequence:
        RelativeDistinguishedName:
         AttributeTypeAndValue:
          type=2.5.4.10
          value=0x0c0449455446
        RelativeDistinguishedName:
         AttributeTypeAndValue:
          type=2.5.4.11
          value=0x0c0452415453
        RelativeDistinguishedName:
         AttributeTypeAndValue:
          type=2.5.4.3
          value=0x0c06414b20525341


      subjectPublicKeyInfo=SubjectPublicKeyInfo:
       algorithm=AlgorithmIdentifier:
        algorithm=1.2.840.113549.1.1.1
        parameters=0x0500

       subjectPublicKey=31795268810366627125468059984427145931784542919710733587190808152893606542214208096328883077225607136393362795609997601968312039001251339428349101203532726047646450301142882318337709398316574407647199690000689245113739552615279534528145776090813314822312012607567736073057936820713733090928849092672110937300300755561797808000438134839458043673852453722969649609202093945235393494912138691342219564365300965387743701570507112064401758218314760153081271981340812350365663466513620853326534252424706992841033652817461354632316129312597825542820569667842318342646457447037125609399476844336456206583416539426479221164971369788464727307915820767918489601

      extensions=Extensions:
       Extension:
        extnID=2.5.29.14
        critical=False
        extnValue=0x04148919595e0ef169f5cbbd47e134fce298cc693091
       Extension:
        extnID=2.5.29.35
        critical=False
        extnValue=0x301680148919595e0ef169f5cbbd47e134fce298cc693091
       Extension:
        extnID=2.5.29.19
        critical=True
        extnValue=0x30030101ff


     signatureAlgorithm=AlgorithmIdentifier:
      algorithm=1.2.840.113549.1.1.11
      parameters=0x0500

     signature=12977775424631768289542539102653382982431795551146145281750189553757940982572813264428982985997740595878077027853994515775116752030963858469651548765808775269857271167748512795017916284867051302884465315751010913658016640170608413935780119349866986170148033301955753116984041271273907756544780231564646860424999020990745523383622980115200446260103173103500647838758197610238552349053064525420240826193553395378873725256584269666918504793674497748455574822238022085054752185687440807655337724821853332688158460379554906105417720665175648371832825939577039874730442790337726004105878168375998123110331993348833629325492

   signatureAlgorithm=AlgorithmIdentifier:
    algorithm=1.2.840.113549.1.1.10
    parameters=RSASSA_PSS_params:
     hashAlgorithm=AlgorithmIdentifier:
      algorithm=2.16.840.1.101.3.4.2.1

     maskGenAlgorithm=AlgorithmIdentifier:
      algorithm=1.2.840.113549.1.1.8

     saltLength=20
     trailerField=1


   signatureValue=0xab7fd2b0f854daa4e867fd16955cd3b9910e93b70c7403cfa8077f04193909d14ec6bed859b67476c84cc2c28842b9a087d5c39e11ca95f6961d272d97297cb6ed3c062717696b032f4bf1f0f41ac20ae9706a8a4c17845ae2512950774173737010d6692cb726d1ab3a022092efcf27f0dd875b62e4df546814186f9e744cc34cf0778c877c571d006be094aa683a5f66d6816d22dba104334163020c62d81903c41d353eaba9421247fc354fd3288a01921d93014100960324c3122feebfffc1007c83e98136e1b1fca115835b9e67fa9056f290208fb99e1c8144839a5e13ccb1217dceeecc253fc7785bc8308382e052ffb867b40a0cd593176ed6ddc7b0
  SignatureBlock:
   certChain=SequenceOf:
    Certificate:
     tbsCertificate=TBSCertificate:
      version=v3
      serialNumber=43752118382009037811618748949928339462896457144
      signature=AlgorithmIdentifier:
       algorithm=1.2.840.10045.4.3.2

      issuer=Name:
       rdnSequence=RDNSequence:
        RelativeDistinguishedName:
         AttributeTypeAndValue:
          type=2.5.4.10
          value=0x0c0449455446
        RelativeDistinguishedName:
         AttributeTypeAndValue:
          type=2.5.4.11
          value=0x0c0452415453
        RelativeDistinguishedName:
         AttributeTypeAndValue:
          type=2.5.4.3
          value=0x0c07414b2050323536


      validity=Validity:
       notBefore=Time:
        utcTime=250117171428Z

       notAfter=Time:
        generalTime=20520604171428Z


      subject=Name:
       rdnSequence=RDNSequence:
        RelativeDistinguishedName:
         AttributeTypeAndValue:
          type=2.5.4.10
          value=0x0c0449455446
        RelativeDistinguishedName:
         AttributeTypeAndValue:
          type=2.5.4.11
          value=0x0c0452415453
        RelativeDistinguishedName:
         AttributeTypeAndValue:
          type=2.5.4.3
          value=0x0c07414b2050323536


      subjectPublicKeyInfo=SubjectPublicKeyInfo:
       algorithm=AlgorithmIdentifier:
        algorithm=1.2.840.10045.2.1
        parameters=0x06082a8648ce3d030107

       subjectPublicKey=57095560233504924588952816185508037812996307929249104847846164660564888397123390877585670462836285725041261897550020311481127562655774333675293173915140722

      extensions=Extensions:
       Extension:
        extnID=2.5.29.14
        critical=False
        extnValue=0x04145b70a79817f79ff637d2f7e3dc446c2109d7bbd4
       Extension:
        extnID=2.5.29.35
        critical=False
        extnValue=0x301680145b70a79817f79ff637d2f7e3dc446c2109d7bbd4
       Extension:
        extnID=2.5.29.19
        critical=True
        extnValue=0x30030101ff


     signatureAlgorithm=AlgorithmIdentifier:
      algorithm=1.2.840.10045.4.3.2

     signature=182167519797146035745575043154801415115532979136731128676399180692664821804883990401552040789643013103202424486088058364982966709324496782518079519267269438816178719668437

   signatureAlgorithm=AlgorithmIdentifier:
    algorithm=1.2.840.10045.2.1
    parameters=0x06082a8648ce3d030107

   signatureValue=0x3046022100e416af2483667e73345ee297e563cf1639e41ab9bdcd01f98872fddb101e779d022100d06c6e1054292640eea1873230a399af0936760cbfc8023a8a2874f9c5fc5ba8



DER Base64:
MIIIszCCAgsCAQIwggIEMCEGBioDh2cAADAXMBUGByoDh2cBAAAECjAxMDIwMzA0MDUwVAYGKgOHZwABMEowEgYHKgOHZwEBAQwHSFNNLTEyMzAMBgcqA4dnAQECAQH/MBQGByoDh2cBAQMMCU1vZGVsIEFCQzAQBgcqA4dnAQEEDAUzLjEuOTCBsgYGKgOHZwACMIGnMC8GByoDh2cBAgAMJDI2ZDc2NWQ4LTFhZmQtNGRmYi1hMjkwLWNmODY3ZGRlY2ZhMTAMBgcqA4dnAQIDAQEAMGYGByoDh2cBAgEEWzBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABEIlSPiPt4L/teyjdERSxyoeVY+9b3O+XkjpMjLMRcWxbEzRDEy41bihcTnpSILImSVymTQl9BQZq36QpCpJQnIwgbIGBioDh2cAAjCBpzAvBgcqA4dnAQIADCQ0OWE5NmFjZS1lMzlhLTRmZDItYmVjMS0xMzE2NWE5OTYyMWMwDAYHKgOHZwECAwEB/zBmBgcqA4dnAQIBBFswWTATBgcqhkjOPQIBBggqhkjOPQMBBwNCAARCJUj4j7eC/7Xso3REUscqHlWPvW9zvl5I6TIyzEXFsWxM0QxMuNW4oXE56UiCyJklcpk0JfQUGat+kKQqSUJyMB8GBSoDhngAMBYwFAYFKgOGeAEMC3BhcnRpdGlvbiAxMIIGoDCCBHowggNFMIIDQTCCAimgAwIBAgIUWWuyy9RGarWD+k6k4ZswYmQ7cQ0wDQYJKoZIhvcNAQELBQAwLzENMAsGA1UECgwESUVURjENMAsGA1UECwwEUkFUUzEPMA0GA1UEAwwGQUsgUlNBMCAXDTI1MDExNzE3MTMwM1oYDzIwNTIwNjA0MTcxMzAzWjAvMQ0wCwYDVQQKDARJRVRGMQ0wCwYDVQQLDARSQVRTMQ8wDQYDVQQDDAZBSyBSU0EwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCw+egZQ6eumJKq3hfKfED4dE/tL4FI5sjqont9ABVI+1GSqyi1bFBgsRjM0THllIdMbKmJtWwnKW8J+5OgNN8y6Xxv8JmM/Y5vQt2lis0fqXmG8UTz0VTWdlAXXmhUs6lSADvAaIe4RVrCsZ97L3ZQTryY7JRVcbB4khUN3Gp0yg+801SXzoFTTa+UGIRLE66jH51aa5VXu99hnv1OiH8tQrjdi8mH6uG/icq4XuIeNWMF32wHqIOOPvQcWV3M5D2vxJEj702Ku6k9OQXkAo17qRSEonWW4HtLbtmS8He1JNPc/n3dVUm+fM6NoDXPoLP7j55G9zKyqGtGAWXAj1MTAgMBAAGjUzBRMB0GA1UdDgQWBBSJGVleDvFp9cu9R+E0/OKYzGkwkTAfBgNVHSMEGDAWgBSJGVleDvFp9cu9R+E0/OKYzGkwkTAPBgNVHRMBAf8EBTADAQH/MA0GCSqGSIb3DQEBCwUAA4IBAQBmzcTIPYhVNtMdrOb9ee9qYADlTuQl1y1mdrDPcC+zmwZuwKLJu89hvxmFdDrVNc6QsNKnH0fWtMZxU5UQTrqW2Wf0jLY3bjfJkCmTQahOK8XD3oQqfXVKCe+MGFUSh71BUXc4FIQzMJ6phG+5qiCqsD9BL/gFXf4ao+BI4SQhVWi6FR+JOBMxd91DYDyYr6NfddAbzaW7iDoVEWR1pvQAZbycWfv1KIY6ne2yQ0dSedOqIE9Odjqi2QkW4kD7qXRLYKcMPqe1SPao2xoS2Kz8SIdoLInLu7Cb3QC7n/oEbiK4JIVD29giMpudJ8gbBLLjwDrCls0yA+ng8n/wkki0MCsGCSqGSIb3DQEBCjAeoA0wCwYJYIZIAWUDBAIBoQ0wCwYJKoZIhvcNAQEIBIIBAKt/0rD4VNqk6Gf9FpVc07mRDpO3DHQDz6gHfwQZOQnRTsa+2Fm2dHbITMLCiEK5oIfVw54RypX2lh0nLZcpfLbtPAYnF2lrAy9L8fD0GsIK6XBqikwXhFriUSlQd0Fzc3AQ1mkstybRqzoCIJLvzyfw3YdbYuTfVGgUGG+edEzDTPB3jId8Vx0Aa+CUqmg6X2bWgW0i26EEM0FjAgxi2BkDxB01PqupQhJH/DVP0yiKAZIdkwFBAJYDJMMSL+6//8EAfIPpgTbhsfyhFYNbnmf6kFbykCCPuZ4cgUSDml4TzLEhfc7uzCU/x3hbyDCDguBS/7hntAoM1ZMXbtbdx7AwggIeMIIBuzCCAbcwggFdoAMCAQICFAep6a/8hKR/Xf8D7fMOi6OQH5W4MAoGCCqGSM49BAMCMDAxDTALBgNVBAoMBElFVEYxDTALBgNVBAsMBFJBVFMxEDAOBgNVBAMMB0FLIFAyNTYwIBcNMjUwMTE3MTcxNDI4WhgPMjA1MjA2MDQxNzE0MjhaMDAxDTALBgNVBAoMBElFVEYxDTALBgNVBAsMBFJBVFMxEDAOBgNVBAMMB0FLIFAyNTYwWTATBgcqhkjOPQIBBggqhkjOPQMBBwNCAARCJUj4j7eC/7Xso3REUscqHlWPvW9zvl5I6TIyzEXFsWxM0QxMuNW4oXE56UiCyJklcpk0JfQUGat+kKQqSUJyo1MwUTAdBgNVHQ4EFgQUW3CnmBf3n/Y30vfj3ERsIQnXu9QwHwYDVR0jBBgwFoAUW3CnmBf3n/Y30vfj3ERsIQnXu9QwDwYDVR0TAQH/BAUwAwEB/zAKBggqhkjOPQQDAgNIADBFAiEAkH8Erj/TLNoEfJIvokEEDVmhH5f7UQHdrrCyQWEhJegCICRsy/1Vqjo3qg/WrHospwcB2PaHYy+FnH79mznqO7jVMBMGByqGSM49AgEGCCqGSM49AwEHBEgwRgIhAOQWrySDZn5zNF7il+VjzxY55Bq5vc0B+Yhy/dsQHnedAiEA0GxuEFQpJkDuoYcyMKOZrwk2dgy/yAI6iih0+cX8W6g=
</pre><a href="#appendix-A-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="acknowledgements">
<section id="appendix-B">
      <h2 id="name-acknowledgements">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="appendix-B-1">This specification is the work of a design team created by the chairs
of the RATS working group. This specification has been developed
based on discussions in that design team and also with great amounts of
input taken from discussions on the RATS mailing list.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-C">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Mike Ounsworth</span></div>
<div dir="auto" class="left"><span class="org">Entrust Limited</span></div>
<div dir="auto" class="left"><span class="street-address">2500 Solandt Road - Suite 100</span></div>
<div dir="auto" class="left">
<span class="locality">Ottawa, Ontario</span>  <span class="postal-code">K2K 3G5</span>
</div>
<div dir="auto" class="left"><span class="country-name">Canada</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:mike.ounsworth@entrust.com" class="email">mike.ounsworth@entrust.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Jean-Pierre Fiset</span></div>
<div dir="auto" class="left"><span class="org">Crypto4A Inc.</span></div>
<div dir="auto" class="left"><span class="street-address">1550A Laperriere Ave</span></div>
<div dir="auto" class="left">
<span class="locality">Ottawa, Ontario</span>  <span class="postal-code">K1Z 7T2</span>
</div>
<div dir="auto" class="left"><span class="country-name">Canada</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:jp@crypto4a.com" class="email">jp@crypto4a.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Hannes Tschofenig</span></div>
<div dir="auto" class="left"><span class="org">University of Applied Sciences Bonn-Rhein-Sieg</span></div>
<div dir="auto" class="left"><span class="country-name">Germany</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:Hannes.Tschofenig@gmx.net" class="email">Hannes.Tschofenig@gmx.net</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Henk Birkholz</span></div>
<div dir="auto" class="left"><span class="org">Fraunhofer SIT</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:henk.birkholz@ietf.contact" class="email">henk.birkholz@ietf.contact</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Monty Wiseman</span></div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:montywiseman32@gmail.com" class="email">montywiseman32@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Ned Smith</span></div>
<div dir="auto" class="left"><span class="org">Intel Corporation</span></div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:ned.smith@intel.com" class="email">ned.smith@intel.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
