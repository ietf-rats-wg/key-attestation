<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>PKIX Evidence for Remote Attestation of Hardware Security Modules</title>
<meta content="Mike Ounsworth" name="author">
<meta content="Jean-Pierre Fiset" name="author">
<meta content="Hannes Tschofenig" name="author">
<meta content="Henk Birkholz" name="author">
<meta content="Monty Wiseman" name="author">
<meta content="Ned Smith" name="author">
<meta content="
       This document specifies a vendor-agnostic format for Evidence produced and verified within a PKIX context.
The Evidence produced this way includes claims collected about a cryptographic module
and elements found within it such as cryptographic keys. 
       One scenario envisaged is that the state information about the cryptographic module can be securely presented
to a remote operator or auditor in a vendor-agnostic verifiable format.
A more complex scenario would be to submit this Evidence to a Certification Authority to aid in determining
whether the storage properties of this key meet the requirements of a given certificate profile. 
       This specification also offers a format for requesting a cryptographic module to produce Evidence tailored for expected use. 
    " name="description">
<meta content="xml2rfc 3.31.0" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="RATS" name="keyword">
<meta content="PKIX" name="keyword">
<meta content="HSM" name="keyword">
<meta content="draft-ietf-rats-pkix-key-attestation-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.31.0
    Python 3.12.12
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.2.1
    Jinja2 3.1.6
    lxml 6.0.2
    platformdirs 4.5.1
    pycountry 24.6.1
    PyYAML 6.0.3
    requests 2.32.5
    wcwidth 0.3.0
-->
<link href="draft-ietf-rats-pkix-key-attestation.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl:not(.dlNewline) > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">PKIX Evidence for Remote Attestation of </td>
<td class="right">January 2026</td>
</tr></thead>
<tfoot><tr>
<td class="left">Ounsworth, et al.</td>
<td class="center">Expires 26 July 2026</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">RATS</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-rats-pkix-key-attestation-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2026-01-22" class="published">22 January 2026</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2026-07-26">26 July 2026</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">M. Ounsworth</div>
<div class="org">Entrust</div>
</div>
<div class="author">
      <div class="author-name">J.-P. Fiset</div>
<div class="org">Crypto4A</div>
</div>
<div class="author">
      <div class="author-name">H. Tschofenig</div>
<div class="org">H-BRS</div>
</div>
<div class="author">
      <div class="author-name">H. Birkholz</div>
<div class="org">Fraunhofer SIT</div>
</div>
<div class="author">
      <div class="author-name">M. Wiseman</div>
</div>
<div class="author">
      <div class="author-name">N. Smith</div>
<div class="org">Intel Corporation</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">PKIX Evidence for Remote Attestation of Hardware Security Modules</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document specifies a vendor-agnostic format for Evidence produced and verified within a PKIX context.
The Evidence produced this way includes claims collected about a cryptographic module
and elements found within it such as cryptographic keys.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">One scenario envisaged is that the state information about the cryptographic module can be securely presented
to a remote operator or auditor in a vendor-agnostic verifiable format.
A more complex scenario would be to submit this Evidence to a Certification Authority to aid in determining
whether the storage properties of this key meet the requirements of a given certificate profile.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
<p id="section-abstract-3">This specification also offers a format for requesting a cryptographic module to produce Evidence tailored for expected use.<a href="#section-abstract-3" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        The latest revision of this draft can be found at <span><a href="https://ietf-rats-wg.github.io/key-attestation/draft-ietf-rats-pkix-key-attestation.html">https://ietf-rats-wg.github.io/key-attestation/draft-ietf-rats-pkix-key-attestation.html</a></span>.
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-ietf-rats-pkix-key-attestation/">https://datatracker.ietf.org/doc/draft-ietf-rats-pkix-key-attestation/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        RATS Working Group mailing list (<span><a href="mailto:rats@ietf.org">mailto:rats@ietf.org</a></span>),
        which is archived at <span><a href="https://datatracker.ietf.org/wg/rats/about/">https://datatracker.ietf.org/wg/rats/about/</a></span>.
        Subscribe at <span><a href="https://www.ietf.org/mailman/listinfo/rats/">https://www.ietf.org/mailman/listinfo/rats/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
<p id="section-note.1-4">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/ietf-rats-wg/key-attestation">https://github.com/ietf-rats-wg/key-attestation</a></span>.<a href="#section-note.1-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 26 July 2026.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2026 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-use-cases" class="internal xref">Use Cases</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-remote-audit-of-a-hardware-" class="internal xref">Remote audit of a Hardware Security Module (HSM)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1" class="keepWithNext"><a href="#section-2.2" class="auto internal xref">2.2</a>.  <a href="#name-key-import-and-hsm-clusteri" class="internal xref">Key import and HSM clustering</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="auto internal xref">2.3</a>.  <a href="#name-attesting-subject-of-a-cert" class="internal xref">Attesting subject of a certificate issuance</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-conventions-and-terminology" class="internal xref">Conventions and Terminology</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-claims-and-measurements-in-" class="internal xref">Claims and measurements in PKIX Evidence</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-attestation-key-certificate" class="internal xref">Attestation Key Certificate Chain</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-information-model" class="internal xref">Information Model</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-entity" class="internal xref">Entity</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-entity-type" class="internal xref">Entity Type</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-attribute-and-attribute-typ" class="internal xref">Attribute and Attribute Type</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-data-model" class="internal xref">Data Model</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-platform-entity" class="internal xref">Platform Entity</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.1">
                    <p id="section-toc.1-1.5.2.1.2.1.1"><a href="#section-5.1.1" class="auto internal xref">5.1.1</a>.  <a href="#name-vendor" class="internal xref">vendor</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.2">
                    <p id="section-toc.1-1.5.2.1.2.2.1"><a href="#section-5.1.2" class="auto internal xref">5.1.2</a>.  <a href="#name-oemid-hwmodel-hwversion-swn" class="internal xref">oemid, hwmodel, hwversion, swname, swversion, dbgstat, uptime, bootcount</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.3">
                    <p id="section-toc.1-1.5.2.1.2.3.1"><a href="#section-5.1.3" class="auto internal xref">5.1.3</a>.  <a href="#name-hwserial" class="internal xref">hwserial</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.4">
                    <p id="section-toc.1-1.5.2.1.2.4.1"><a href="#section-5.1.4" class="auto internal xref">5.1.4</a>.  <a href="#name-fipsboot-fipsver-fipslevel-" class="internal xref">fipsboot, fipsver, fipslevel and fipsmodule</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-key-entity" class="internal xref">Key Entity</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.1">
                    <p id="section-toc.1-1.5.2.2.2.1.1"><a href="#section-5.2.1" class="auto internal xref">5.2.1</a>.  <a href="#name-identifier" class="internal xref">identifier</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.2">
                    <p id="section-toc.1-1.5.2.2.2.2.1"><a href="#section-5.2.2" class="auto internal xref">5.2.2</a>.  <a href="#name-spki" class="internal xref">spki</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3">
                    <p id="section-toc.1-1.5.2.2.2.3.1"><a href="#section-5.2.3" class="auto internal xref">5.2.3</a>.  <a href="#name-extractable-sensitive-never" class="internal xref">extractable, sensitive, never-extractable, local</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.4">
                    <p id="section-toc.1-1.5.2.2.2.4.1"><a href="#section-5.2.4" class="auto internal xref">5.2.4</a>.  <a href="#name-expiry" class="internal xref">expiry</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.5">
                    <p id="section-toc.1-1.5.2.2.2.5.1"><a href="#section-5.2.5" class="auto internal xref">5.2.5</a>.  <a href="#name-purpose" class="internal xref">purpose</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-transaction-entity" class="internal xref">Transaction Entity</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.1">
                    <p id="section-toc.1-1.5.2.3.2.1.1"><a href="#section-5.3.1" class="auto internal xref">5.3.1</a>.  <a href="#name-nonce" class="internal xref">nonce</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.2">
                    <p id="section-toc.1-1.5.2.3.2.2.1"><a href="#section-5.3.2" class="auto internal xref">5.3.2</a>.  <a href="#name-timestamp" class="internal xref">timestamp</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.3">
                    <p id="section-toc.1-1.5.2.3.2.3.1"><a href="#section-5.3.3" class="auto internal xref">5.3.3</a>.  <a href="#name-ak-spki" class="internal xref">ak-spki</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="auto internal xref">5.4</a>.  <a href="#name-additional-entity-and-attri" class="internal xref">Additional Entity and Attribute Types</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5">
                <p id="section-toc.1-1.5.2.5.1"><a href="#section-5.5" class="auto internal xref">5.5</a>.  <a href="#name-encoding" class="internal xref">Encoding</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-signing-and-verification-pr" class="internal xref">Signing and Verification Procedures</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-attestation-requests" class="internal xref">Attestation Requests</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-request-attributes-with-spe" class="internal xref">Request Attributes with Specified Values</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1.2.1">
                    <p id="section-toc.1-1.7.2.1.2.1.1"><a href="#section-7.1.1" class="auto internal xref">7.1.1</a>.  <a href="#name-key-identifiers" class="internal xref">Key Identifiers</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1.2.2">
                    <p id="section-toc.1-1.7.2.1.2.2.1"><a href="#section-7.1.2" class="auto internal xref">7.1.2</a>.  <a href="#name-nonce-2" class="internal xref">Nonce</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1.2.3">
                    <p id="section-toc.1-1.7.2.1.2.3.1"><a href="#section-7.1.3" class="auto internal xref">7.1.3</a>.  <a href="#name-custom-key-selection" class="internal xref">Custom Key Selection</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1.2.4">
                    <p id="section-toc.1-1.7.2.1.2.4.1"><a href="#section-7.1.4" class="auto internal xref">7.1.4</a>.  <a href="#name-custom-transaction-entity-a" class="internal xref">Custom Transaction Entity Attributes</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-reporting-of-attestation-ke" class="internal xref">Reporting of Attestation Keys</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="auto internal xref">7.3</a>.  <a href="#name-processing-an-attestation-r" class="internal xref">Processing an Attestation Request</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="auto internal xref">7.4</a>.  <a href="#name-verification-by-presenter" class="internal xref">Verification by Presenter</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-asn1-module" class="internal xref">ASN.1 Module</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="auto internal xref">10.1</a>.  <a href="#name-policies-relating-to-verifi" class="internal xref">Policies relating to Verifier and Relying Party</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="auto internal xref">10.2</a>.  <a href="#name-simple-to-implement" class="internal xref">Simple to Implement</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.3">
                <p id="section-toc.1-1.10.2.3.1"><a href="#section-10.3" class="auto internal xref">10.3</a>.  <a href="#name-detached-signatures" class="internal xref">Detached Signatures</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.4">
                <p id="section-toc.1-1.10.2.4.1"><a href="#section-10.4" class="auto internal xref">10.4</a>.  <a href="#name-privacy" class="internal xref">Privacy</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.5">
                <p id="section-toc.1-1.10.2.5.1"><a href="#section-10.5" class="auto internal xref">10.5</a>.  <a href="#name-authenticating-and-authoriz" class="internal xref">Authenticating and Authorizing the Presenter</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.6">
                <p id="section-toc.1-1.10.2.6.1"><a href="#section-10.6" class="auto internal xref">10.6</a>.  <a href="#name-proof-of-possession-of-user" class="internal xref">Proof-of-Possession of User Keys</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.7">
                <p id="section-toc.1-1.10.2.7.1"><a href="#section-10.7" class="auto internal xref">10.7</a>.  <a href="#name-timestamps-and-hsms" class="internal xref">Timestamps and HSMs</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="auto internal xref">11.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="auto internal xref">11.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-samples" class="internal xref">Samples</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-acknowledgements" class="internal xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-C" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">This specification defines a format to transmit Evidence from an Attester to a Verifier within a PKIX
environment. This environment refers to the components generally used to support PKI applications
such as Certification Authorities and their clients, or more generally that rely upon X.509 certificates.
As outlined in <a href="#terminology" class="auto internal xref">Section 3</a>, this specification uses a necessary mixture of RATS and PKI terminology
in order to map concepts between the two domains.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">Within this specification, the concepts found in the Remote ATtestation procedureS (RATS <span>[<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>) are
mapped to the PKIX environment. There are many other specifications that are based on the RATS architecture
which offer formats to carry Evidence. This specification deals with peculiar aspects of the PKIX environment
which make the existing Evidence formats inappropriate:<a href="#section-1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-3.1">
          <p id="section-1-3.1.1">ASN.1 is the preferred encoding format in this environment. X.509 certificates (<span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>) are used
widely within this environment and the majority of tools are designed to support ASN.1. There are
many specialized devices (Hardware Security Modules) that are inflexible in adopting other formats because
of internal constraints or validation difficulties. This specification defines the format in ASN.1 to ease the
adoption within the community.<a href="#section-1-3.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-3.2">
          <p id="section-1-3.2.1">The claims reported within the generated Evidence is generally a small subset of all possible claims about
the Target Environment. The claims relate to elements such as "platform" and "keys" which are more numerous than
what a Verifier requires for a specific function. This specification provides the means to moderate the information
disseminated as part of the generated Evidence.<a href="#section-1-3.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-1-4">This specification also aims at providing an extensible framework to encode within Evidence claims other than
the one proposed in this document. This allows implementations to introduce new claims and their associated
semantics to the Evidence produced.<a href="#section-1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="use-cases">
<section id="section-2">
      <h2 id="name-use-cases">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-use-cases" class="section-name selfRef">Use Cases</a>
      </h2>
<p id="section-2-1">This section covers use cases that motivated the development of this specification.<a href="#section-2-1" class="pilcrow">¶</a></p>
<div id="remote-audit-of-a-hardware-security-module-hsm">
<section id="section-2.1">
        <h3 id="name-remote-audit-of-a-hardware-">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-remote-audit-of-a-hardware-" class="section-name selfRef">Remote audit of a Hardware Security Module (HSM)</a>
        </h3>
<p id="section-2.1-1">There are situations where it is necessary to verify the current running state of an HSM as part of operational or
auditing procedures. For example, there are devices that are certified to work in an environment only if certain
versions of the firmware are loaded or only if user keys are protected with specific policies.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1-2">The Evidence format offered by this specification allows a platform to report its firmware level along with
other collected claims necessary in critical deployments.<a href="#section-2.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="key-import-and-hsm-clustering">
<section id="section-2.2">
        <h3 id="name-key-import-and-hsm-clusteri">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-key-import-and-hsm-clusteri" class="section-name selfRef">Key import and HSM clustering</a>
        </h3>
<p id="section-2.2-1">Consider that an HSM is being added to a logical HSM cluster. Part of the onboarding process could involve
the newly-added HSM providing Evidence of its running state, for example that it is a genuine device from
the same manufacturer as the existing clustered HSMs, firmware patch level, FIPS mode, etc.
It could also be required to provide information about any system-level keys required to establish
secure cluster communication. In this scenario, the Verifier and Relying Party will typically be other HSMs in the cluster
deciding whether or not to admit the new HSM.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<p id="section-2.2-2">A related scenario is when performing a key export-import across HSMs.
If the key is being imported with certain properties, for example an environment running in FIPS mode at
FIPS Level 3, and the key is set to certain protection properties such as Non-Exportable and Dual-Control,
then the HSM might wish to verify that the key was previously stored under the same properties.
This specification provides an Evidence format with sufficient details to support this type of
implementation across HSM vendors.<a href="#section-2.2-2" class="pilcrow">¶</a></p>
<p id="section-2.2-3">These scenarios motivate the design requirements to have an ASN.1 based Evidence format and a data model that
more closely matches typical HSM architecture since, as shown in both scenarios,
an HSM is acting as Verifier and Relying Party.<a href="#section-2.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="attesting-subject-of-a-certificate-issuance">
<section id="section-2.3">
        <h3 id="name-attesting-subject-of-a-cert">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-attesting-subject-of-a-cert" class="section-name selfRef">Attesting subject of a certificate issuance</a>
        </h3>
<p id="section-2.3-1">Prior to a Certification Authority (CA) issuing a certificate on behalf of a subject, a number of procedures
are required to verify that the subject of the certificate is associated with the key that is certified.
In some cases, such as issuing a code signing certificate <span>[<a href="#CNSA2.0" class="cite xref">CNSA2.0</a>]</span> <span>[<a href="#CSBR" class="cite xref">CSBR</a>]</span>, a CA must ensure that
the subject key is located in a Hardware Security Module (HSM).<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<p id="section-2.3-2">The Evidence format offered by this specification is designed to carry the information necessary for a CA to
assess the location of the subject key along a number of commonly-required attributes. More specifically, a CA could
determine which HSM was used to generate the subject key, whether this device adheres
to certain jurisdiction policies (such as FIPS mode) and the constraints applied to the key (such as whether is it extractable).<a href="#section-2.3-2" class="pilcrow">¶</a></p>
<p id="section-2.3-3">For relatively simple HSM devices, storage properties such as "extractable" may always be false for all keys
since the devices are not capable of key export and so the attestation could be essentially a hard-coded template asserting these
immutable attributes. However, more complex HSM devices require a more complex Evidence format that encompasses the
mutability of these attributes.<a href="#section-2.3-3" class="pilcrow">¶</a></p>
<p id="section-2.3-4">Also, a client requesting a key attestation might wish to scope-down the content of the produced Evidence as
the HSM contains much more information than that which is relevant to the transaction.
The inability to scope-down the generated Evidence could, in some scenarios, constitute a privacy violation.<a href="#section-2.3-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="terminology">
<section id="section-3">
      <h2 id="name-conventions-and-terminology">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-conventions-and-terminology" class="section-name selfRef">Conventions and Terminology</a>
      </h2>
<p id="section-3-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">This specification uses a necessary mixture of RATS and PKI terminology
in order to map concepts between the two domains.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">The reader is assumed to be familiar with the vocabulary and concepts
defined in the RATS architecture (<span>[<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>) such as Attester,
Relying Party, Verifier.<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4">The reader is assumed to be familiar with common vocabulary and concepts
defined in <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span> such as certificate, signature, attribute, verification and validation.<a href="#section-3-4" class="pilcrow">¶</a></p>
<p id="section-3-5">In order to avoid confusion, this document generally
capitalizes RATS terms such as Attester, Relying Party, and Claim.
Therefore, for example, a "Verifier"
should be assumed to be an entity that checks the validity of Evidence as per <span>[<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>,
whereas a "verifier" could be a more general reference to a PKI entity that checks
the validity of an X.509 certificate or other digital signature as per <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>.<a href="#section-3-5" class="pilcrow">¶</a></p>
<p id="section-3-6">The following terms are used in this document:<a href="#section-3-6" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-3-7">
        <dt id="section-3-7.1">Attestation Key (AK):</dt>
        <dd style="margin-left: 1.5em" id="section-3-7.2">
          <p id="section-3-7.2.1">Cryptographic key controlled solely by the Attester and used only for the purpose
of producing Evidence. In other words, it is used to digitally sign the claims collected by
the Attester.<a href="#section-3-7.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-3-7.3">Attestation Service (AttS):</dt>
        <dd style="margin-left: 1.5em" id="section-3-7.4">
          <p id="section-3-7.4.1">A logical module within the HSM that is responsible for generating Evidence compatible with the
format outlined in this specification. It collects claims from the platform and uses the Attestation
Key to digitally sign the collection.<a href="#section-3-7.4.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-3-7.5">Attester:</dt>
        <dd style="margin-left: 1.5em" id="section-3-7.6">
          <p id="section-3-7.6.1">The term Attester respects the definition offered in <span>[<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>. In this specification, it
is also interchangeable with "platform" or "HSM".<a href="#section-3-7.6.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-3-7.7">Evidence:</dt>
        <dd style="margin-left: 1.5em" id="section-3-7.8">
          <p id="section-3-7.8.1">The term Evidence respects the definition offered in <span>[<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>. In this specification, it
refers to claims, encoded according to the format defined within this document, and signed using
the Attestation Key.<a href="#section-3-7.8.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-3-7.9">Hardware Security Module (HSM):</dt>
        <dd style="margin-left: 1.5em" id="section-3-7.10">
          <p id="section-3-7.10.1">A physical computing device that safeguards and manages secrets, such as cryptographic keys,
and performs cryptographic operations based on those secrets.
This specification takes a broad definition of what counts as an HSM to include smartcards,
USB tokens, TPMs, cryptographic co-processors (PCI cards) and "enterprise-grade" or "cloud-service grade" HSMs
(possibly rack mounted). In this specification, it is interchangeable with "platform" or "Attester".<a href="#section-3-7.10.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-3-7.11">Key Attestation:</dt>
        <dd style="margin-left: 1.5em" id="section-3-7.12">
          <p id="section-3-7.12.1">Process of producing Evidence containing claims pertaining to user keys found within an HSM. In
general, the claims include enough information about a user key and its hosting platform to allow
a Relying Party to make judicious decisions about the key, such as whether to issue a certificate for the key.<a href="#section-3-7.12.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-3-7.13">RATS:</dt>
        <dd style="margin-left: 1.5em" id="section-3-7.14">
          <p id="section-3-7.14.1">Remote ATtestation procedureS. In this document, refers to the RATS Architecture as introduced
in <span>[<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>. RATS and RATS Architecture are used interchangeably.<a href="#section-3-7.14.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-3-7.15">Platform:</dt>
        <dd style="margin-left: 1.5em" id="section-3-7.16">
          <p id="section-3-7.16.1">The module or device that embodies the Attester. In this specification, it is interchangeable with
"Attester" or "HSM".<a href="#section-3-7.16.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-3-7.17">Platform Attestation:</dt>
        <dd style="margin-left: 1.5em" id="section-3-7.18">
          <p id="section-3-7.18.1">Evidence containing claims pertaining to attributes associated with the platform itself. In general, the claims include
enough information about the platform to allow a Relying Party to make judicious decisions about the
platform, such as those carried out during audit reviews.<a href="#section-3-7.18.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-3-7.19">Presenter:</dt>
        <dd style="margin-left: 1.5em" id="section-3-7.20">
          <p id="section-3-7.20.1">Role that facilitates communication between the Attester and the Verifier. The
Presenter initiates the operation of generating Evidence at the Attester and
passes the generated Evidence to the Verifier. In the case of HSMs, the Presenter
is responsible of selecting the claims that are part of the generated Evidence.<a href="#section-3-7.20.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-3-7.21">Trust Anchor:</dt>
        <dd style="margin-left: 1.5em" id="section-3-7.22">
          <p id="section-3-7.22.1">As defined in <span>[<a href="#RFC6024" class="cite xref">RFC6024</a>]</span> and <span>[<a href="#RFC9019" class="cite xref">RFC9019</a>]</span>, a Trust Anchor
"represents an authoritative entity via a public key and
associated data. The public key is used to verify digital
signatures, and the associated data is used to constrain the types
of information for which the trust anchor is authoritative." The
Trust Anchor may be a certificate, a raw public key, or other
structure, as appropriate.<a href="#section-3-7.22.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-3-7.23">Trusted Platform Module (TPM):</dt>
        <dd style="margin-left: 1.5em" id="section-3-7.24">
          <p id="section-3-7.24.1">A tamper-resistant processor generally located on a computer's motherboard used to enhance attestation
functions for the hosting platform. TPMs are very specialized Hardware Security Modules and generally use
other protocols (than the one presented in this specification) to transmit Evidence.<a href="#section-3-7.24.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-3-7.25">User Key:</dt>
        <dd style="margin-left: 1.5em" id="section-3-7.26">
          <p id="section-3-7.26.1">A user key consists of a key hosted by an HSM (the platform) and intended to be used by a client
of the HSM. Other terms used for a user key are "application key", "client key" or "operational key".
The access and operations on a user key is controlled by the HSM.<a href="#section-3-7.26.1" class="pilcrow">¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
<div id="claims-and-measurements-in-pkix-evidence">
<section id="section-3.1">
        <h3 id="name-claims-and-measurements-in-">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-claims-and-measurements-in-" class="section-name selfRef">Claims and measurements in PKIX Evidence</a>
        </h3>
<p id="section-3.1-1"><span>[<a href="#RFC9334" class="cite xref">RFC9334</a>]</span> states that Evidence is made up of claims and that a claim is "a piece of
asserted information, often in the form of a name/value pair". The RATS Architecture also mentions
the concept of "measurements" that "can describe a variety of attributes of system components, such
as hardware, firmware, BIOS, software, etc., and how they are hardened."<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">Some HSMs have a large amount of memory and can therefore contain a substantial amount of elements that
can be observed independently by the Attestation Service. Each of those elements, in turn, can contain a
number of measurable attributes.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<p id="section-3.1-3">A certain level of complexity arises as multiple elements of the same class can be observed while generating
Evidence. In that case, the "name" of the claim must also include the "address" of the element.<a href="#section-3.1-3" class="pilcrow">¶</a></p>
<p id="section-3.1-4">To that end, in this specification, the claims are organized as tuples of "entity", "attribute" and "value":<a href="#section-3.1-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-5.1">
            <p id="section-3.1-5.1.1">the entity represents the encapsulation of an element as a set of attributes;<a href="#section-3.1-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-5.2">
            <p id="section-3.1-5.2.1">the attribute represents one property of the entity, which can be repeated to other entities of the
same class; and,<a href="#section-3.1-5.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-5.3">
            <p id="section-3.1-5.3.1">the value is the actual measurement performed by the Attestation Service.<a href="#section-3.1-5.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.1-6">Therefore, each entity is a collection of claims, where the "name/value" pair represents one attribute
and its measured value for an entity.<a href="#section-3.1-6" class="pilcrow">¶</a></p>
<p id="section-3.1-7">The grouping of claims into entities facilitates the comprehension of a large addressable space into
elements recognizable by the user. More importantly, it curtails the produced Evidence to portions of the
Target Environment that relate to the needs of the Verifier. See <a href="#sec-cons-privacy" class="auto internal xref">Section 10.4</a>.<a href="#section-3.1-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-ak-chain">
<section id="section-3.2">
        <h3 id="name-attestation-key-certificate">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-attestation-key-certificate" class="section-name selfRef">Attestation Key Certificate Chain</a>
        </h3>
<p id="section-3.2-1">The data format in this specification represents PKIX Evidence and
requires third-party endorsement in order to establish trust. Part of this
endorsement is a trust anchor that chains to the HSM's attestation key (AK)
which signs the Evidence. In practice the trust anchor will usually be a
manufacturing CA belonging to the device vendor which proves
that the device is genuine and not counterfeit. The trust anchor can also belong
to the device operator as would be the case when the AK certificate is replaced
as part of onboarding the device into a new operational network.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">The AK certificate that signs the Evidence <span class="bcp14">MUST</span> have the Extended Key Usage
<code>id-kp-attest</code>, as defined in <span>[<a href="#I-D.jpfiset-lamps-attestationkey-eku" class="cite xref">I-D.jpfiset-lamps-attestationkey-eku</a>]</span>, set.<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<p id="section-3.2-3">Note that the data format specified in <a href="#sec-data-model" class="auto internal xref">Section 5</a> allows for zero, one, or multiple
'SignatureBlock's, so a single Evidence statement could be un-protected, or could be endorsed by multiple
AK chains leading to different trust anchors. See <a href="#sec-verif-proc" class="auto internal xref">Section 6</a> for a discussion of handling multiple SignatureBlocks.<a href="#section-3.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-info-model">
<section id="section-4">
      <h2 id="name-information-model">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-information-model" class="section-name selfRef">Information Model</a>
      </h2>
<p id="section-4-1">The PKIX Evidence format is composed of two main sections:<a href="#section-4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-2.1">
          <p id="section-4-2.1.1">A claim description section which describes the information transmitted as Evidence.<a href="#section-4-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-2.2">
          <p id="section-4-2.2.1">A signature section where one or more digital signatures are offered to prove the origin of the
claims and maintain their integrity.<a href="#section-4-2.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-4-3">The details of the signature section is left to the data model. The remainder of this section
deals with the way the information is organized to form the claims.<a href="#section-4-3" class="pilcrow">¶</a></p>
<p id="section-4-4">The claims are organized into a set of entities to help with the organization and comprehension
of the information. Entities are elements observed in the Target Environment by the Attester.
Each entity, in turn, is associated with a set of attributes.<a href="#section-4-4" class="pilcrow">¶</a></p>
<p id="section-4-5">Therefore, the Claim description section is a set of entities and each entity is composed
of a set of attributes.<a href="#section-4-5" class="pilcrow">¶</a></p>
<div id="entity">
<section id="section-4.1">
        <h3 id="name-entity">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-entity" class="section-name selfRef">Entity</a>
        </h3>
<p id="section-4.1-1">An entity is a logical construct that refers to a portion of the Target Environment's state. It is
addressable via an identifier such as a UUID or a handle (as expressed in <span>[<a href="#PKCS11" class="cite xref">PKCS11</a>]</span>). In general, an
entity refers to a component recognized by users of the HSM, such as a key or the platform itself.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">An entity is composed of a type, the entity type, and a set of attributes. The entity type
describes the class of the entity while its attributes define its state.<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<p id="section-4.1-3">An entity <span class="bcp14">MUST</span> be reported at most once in a claim description. The claim description can
have multiple entities of the same type (for example reporting multiple keys), but each
entity <span class="bcp14">MUST</span> relate to different portions of the Target Environment.<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<p id="section-4.1-4">It is possible for two entities to be quite similar such as in a situation where a key is imported
twice in a HSM. In this case, the two related entities could have similar attributes. However, they
are treated as different entities as they are addressed differently.<a href="#section-4.1-4" class="pilcrow">¶</a></p>
<p id="section-4.1-5">The number of entities reported in a claim description, and their respective type, is
left to the implementer. For a simple device where there is only one key, the list of
reported entities could be fixed. For larger and more complex devices, the list of
reported entities should be tailored to the demands of the Presenter.<a href="#section-4.1-5" class="pilcrow">¶</a></p>
<p id="section-4.1-6">In particular, note that the nonce attribute contained with the Transaction entity is optional,
and therefore it is possible that an extremely simple device that holds one static key
could have its key attestation object generated at manufacture time and injected
statically into the device and act as a kind of certificate, instead of
being generated on-demand. This model would essentially
off-board the Target Environment to be part of the manufacturing infrastructure.<a href="#section-4.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="entity-type">
<section id="section-4.2">
        <h3 id="name-entity-type">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-entity-type" class="section-name selfRef">Entity Type</a>
        </h3>
<p id="section-4.2-1">An entity is defined by its type. This specification defines three entity types:<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-2.1">
            <p id="section-4.2-2.1.1">Platform : This entity holds attributes relating to the state of the platform, or device,
where the Attester is located. Entities of this type hold attributes that are global
in nature within the Target Environment.<a href="#section-4.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.2-2.2">
            <p id="section-4.2-2.2.1">Key : The entities of this type represent a cryptographic key protected within the
Target Environment and hold attributes relating to that key.<a href="#section-4.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.2-2.3">
            <p id="section-4.2-2.3.1">Transaction : This entity is logical in nature since it is associated with attributes
that are not found in the Target Environment. The attributes found in this entity relate
to the current request for Evidence such as a nonce to support freshness.<a href="#section-4.2-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.2-3">Although this document defines a short list of entity types, this list is extensible
to allow implementers to report on entities found in their implementation and not
covered by this specification. By using an Object Identifier (OID) for specifying entity types
and attribute types, this format is inherently extensible;
implementers of this specification <span class="bcp14">MAY</span> define new custom or proprietary entity types and
place them alongside the standardized entities, or define new attribute types
and place them inside standardized entities.<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<p id="section-4.2-4">Verifiers <span class="bcp14">SHOULD</span> ignore and skip over
unrecognized entity or attribute types and continue processing normally.
In other words, if a given Evidence would have been acceptable without the
unrecognized entities or attributes, then it <span class="bcp14">SHOULD</span> still be acceptable with them.<a href="#section-4.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="attribute-and-attribute-type">
<section id="section-4.3">
        <h3 id="name-attribute-and-attribute-typ">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-attribute-and-attribute-typ" class="section-name selfRef">Attribute and Attribute Type</a>
        </h3>
<p id="section-4.3-1">Each attribute found in an entity is composed of the attribute type and value.
Each attribute describes a portion of the state of the associated entity. For example,
a platform entity could have an attribute which indicates the firmware version currently running.
Another example is a key entity with an attribute that reports whether the key is extractable
or not.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">A value provided by an attribute is to be interpreted within the context
of its entity and in relation to the attribute type.<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<p id="section-4.3-3">It is <span class="bcp14">RECOMMENDED</span> that an attribute type be defined for a specific entity type, to reduce
confusion when it comes to interpretation of the value. In other words, an attribute type <span class="bcp14">SHOULD NOT</span> be used by multiple entity types. For example, if a concept of "revision" is applicable to a platform
and a key, the attribute for one entity type (platform revision) should have a different identifier
than the one for the other entity type (key revision).<a href="#section-4.3-3" class="pilcrow">¶</a></p>
<p id="section-4.3-4">The nature of the value (boolean, integer, string, bytes) is dependent on the attribute type.<a href="#section-4.3-4" class="pilcrow">¶</a></p>
<p id="section-4.3-5">This specification defines a limited set of attribute types. However, the list is extensible
through the IANA registration process or private OID allocation, enabling implementers to
report additional attributes not covered by this specification.<a href="#section-4.3-5" class="pilcrow">¶</a></p>
<p id="section-4.3-6">The number of attributes reported within an entity, and their respective type, is
left to the implementer. For a simple device, the reported list of attributes for an entity
might be fixed. However, for larger and more complex devices, the list of reported attributes
should be tailored to the demands of the Presenter.<a href="#section-4.3-6" class="pilcrow">¶</a></p>
<p id="section-4.3-7">Some attributes <span class="bcp14">MAY</span> be repeated within an entity while others <span class="bcp14">MUST NOT</span>. For example, for a
platform entity, there can only be one "firmware version" attribute. Therefore, the associated attribute
<span class="bcp14">MUST NOT</span> be repeated as it may lead to confusion. However, an attribute relating to
a "ak-spki" <span class="bcp14">MAY</span> be repeated, each attribute describing a different attesting key.
Therefore, the definition of an attribute specifies whether or not multiple copies of that
attribute are allowed.<a href="#section-4.3-7" class="pilcrow">¶</a></p>
<p id="section-4.3-8">If a Verifier encounters, within a single entity, multiple copies of an attribute specified as
"Multiple Allowed: No", it <span class="bcp14">MUST</span> reject the Evidence as malformed.<a href="#section-4.3-8" class="pilcrow">¶</a></p>
<p id="section-4.3-9">If a Verifier encounters, within the context of an entity, a repeated attribute for a type where
multiple attributes are allowed, it <span class="bcp14">MUST</span> treat each one as an independent attribute and <span class="bcp14">MUST NOT</span>
consider later ones to overwrite the previous one.<a href="#section-4.3-9" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-data-model">
<section id="section-5">
      <h2 id="name-data-model">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-data-model" class="section-name selfRef">Data Model</a>
      </h2>
<p id="section-5-1">This section describes the data model associated with PKIX Evidence. For ease of
deployment within the target ecosystem, ASN.1 definitions and DER encoding
are used. A complete ASN.1 module is provided in <a href="#sec-asn1-mod" class="auto internal xref">Section 8</a>.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">The top-level structures, as ASN.1 snippets, are:<a href="#section-5-2" class="pilcrow">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-5-3">
<pre>
PkixEvidence ::= SEQUENCE {
    tbs                           TbsPkixEvidence,
    signatures                    SEQUENCE SIZE (0..MAX) OF SignatureBlock,
    intermediateCertificates  [0] SEQUENCE OF Certificate OPTIONAL
                                  -- As defined in RFC 5280
}

TbsPkixEvidence ::= SEQUENCE {
    version INTEGER,
    reportedEntities SEQUENCE SIZE (1..MAX) OF ReportedEntity
}

SignatureBlock ::= SEQUENCE {
   sid                  SignerIdentifier,
   signatureAlgorithm   AlgorithmIdentifier,
   signatureValue       OCTET STRING
}

SignerIdentifier ::= SEQUENCE {
   keyId                [0] EXPLICIT OCTET STRING OPTIONAL,
   subjectKeyIdentifier [1] EXPLICIT SubjectPublicKeyInfo OPTIONAL,
                            -- As defined in RFC 5280
   certificate          [2] EXPLICIT Certificate OPTIONAL
                            -- As defined in RFC 5280
}
</pre><a href="#section-5-3" class="pilcrow">¶</a>
</div>
<p id="section-5-4">A <code>PkixEvidence</code> message is composed of a protected section known as the To-Be-Signed (TBS) section where the Evidence
reported by the HSM is assembled. The integrity of the TBS section is ensured with one or multiple cryptographic signatures
over the content of this section. There is a provision to carry X.509 certificates supporting each signature.
The SEQUENCE OF <code>SignatureBlock</code> allows for both multi-algorithm protection and for counter-signatures
of the Evidence.
In an effort to keep the Evidence format simple, distinguishing between these two cases is left up to Verifier policy,
potentially by making use of the certificates that accompany each signature.<a href="#section-5-4" class="pilcrow">¶</a></p>
<p id="section-5-5">This design also does not prevent an attacker from removing, adding or re-ordering signatures without leaving Evidence.
This is discussed as part of the security considerations in <a href="#sec-detached-sigs" class="auto internal xref">Section 10.3</a>.<a href="#section-5-5" class="pilcrow">¶</a></p>
<p id="section-5-6">The TBS section is composed of a version number, to ensure future extensibility, and a sequence of reported entities.
For compliance with this specification, <code>TbsPkixEvidence.version</code> <span class="bcp14">MUST</span> be <code>1</code>.
This envelope format is not extensible; future specifications which make compatibility-breaking changes <span class="bcp14">MUST</span> increment the version number.<a href="#section-5-6" class="pilcrow">¶</a></p>
<p id="section-5-7">A <code>SignatureBlock</code> is included for each signature submitted against the TBS section. The <code>SignatureBlock</code> includes
the signature algorithm (signatureAlgorithm) and the signature itself (signatureValue). It also includes
information to identify the authority that provided the signature which is the structure <code>SignerIdentifier</code> (sid).
The signer identifier includes a combination of X.509 certificate, SubjectPublicKeyInfo (SPKI) and/or
key identifier (keyId). It is expected that a X.509 certificate will be generally used, as it provides the public key needed
to verify the signature and clearly identifies the subject that provided the signature. The SPKI and keyId are allowed
to support environments where X.509 certificates are not used.<a href="#section-5-7" class="pilcrow">¶</a></p>
<p id="section-5-8">The optional certificates provided in <code>PkixEvidence.intermediateCertificates</code> enable the insertion
of X.509 certificates to support trusting the signatures found in signature blocks. This information is intended to provide
the certificates required by the Verifier to verify the endorsement on the certificates included
with the signatures. <code>intermediateCertificates</code> <span class="bcp14">MAY</span> include any or all intermediate CA certificates needed to build paths (excluding trust anchors). Order is not significant.<a href="#section-5-8" class="pilcrow">¶</a></p>
<p id="section-5-9">As described in <a href="#sec-info-model" class="auto internal xref">Section 4</a>, the <code>TbsPkixEvidence</code> is a set of entities. Each entity
is associated with a type that defines its class. The entity types are represented by object identifiers
(OIDs). The following ASN.1 definition defines the structures associated with entities:<a href="#section-5-9" class="pilcrow">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-5-10">
<pre>
ReportedEntity ::= SEQUENCE {
    entityType         OBJECT IDENTIFIER,
    reportedAttributes SEQUENCE SIZE (1..MAX) OF ReportedAttribute
}

id-pkix-evidence                    OBJECT IDENTIFIER ::= { 1 2 3 999 }
id-pkix-evidence-entity-type        OBJECT IDENTIFIER ::= { id-pkix-evidence 0 }
id-pkix-evidence-entity-transaction OBJECT IDENTIFIER ::= { id-pkix-evidence-entity-type 0 }
id-pkix-evidence-entity-platform    OBJECT IDENTIFIER ::= { id-pkix-evidence-entity-type 1 }
id-pkix-evidence-entity-key         OBJECT IDENTIFIER ::= { id-pkix-evidence-entity-type 2 }
</pre><a href="#section-5-10" class="pilcrow">¶</a>
</div>
<p id="section-5-11">In turn, entities are composed of attributes. Each attribute is composed of a type and a value.
The attribute types are represented by object identifiers (OIDs). The
following ASN.1 definition defines the structures associated with attributes:<a href="#section-5-11" class="pilcrow">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-5-12">
<pre>
ReportedAttribute ::= SEQUENCE {
    attributeType      OBJECT IDENTIFIER,
    value              AttributeValue OPTIONAL
}

AttributeValue ::= CHOICE {
   bytes       [0] IMPLICIT OCTET STRING,
   utf8String  [1] IMPLICIT UTF8String,
   bool        [2] IMPLICIT BOOLEAN,
   time        [3] IMPLICIT GeneralizedTime,
   int         [4] IMPLICIT INTEGER,
   oid         [5] IMPLICIT OBJECT IDENTIFIER
}
</pre><a href="#section-5-12" class="pilcrow">¶</a>
</div>
<p id="section-5-13">The attributes <span class="bcp14">SHOULD</span> be associated with a single entity type. Therefore, it is encouraged
to define attribute types grouped with their respective entity type.<a href="#section-5-13" class="pilcrow">¶</a></p>
<p id="section-5-14">The type of an attribute value is dictated by the attribute type. When an attribute type is defined, the
definition must include the type of the value, its semantic and interpretation.<a href="#section-5-14" class="pilcrow">¶</a></p>
<p id="section-5-15">The remainder of this section describes the entity types and their associated attributes.<a href="#section-5-15" class="pilcrow">¶</a></p>
<div id="platform-entity">
<section id="section-5.1">
        <h3 id="name-platform-entity">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-platform-entity" class="section-name selfRef">Platform Entity</a>
        </h3>
<p id="section-5.1-1">A platform entity reports information about the device where the Evidence is generated and is
composed of a set of attributes that are global to the Target Environment.
It is associated with the type identifier <code>id-pkix-evidence-entity-platform</code>.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">A platform entity, if provided, <span class="bcp14">MUST</span> be included only once within the reported entities. If a
Verifier encounters multiple entities of type <code>id-pkix-evidence-entity-platform</code>, it <span class="bcp14">MUST</span>
reject the Evidence as malformed.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<p id="section-5.1-3">The following table lists the attributes for a platform entity (platform attributes) defined
within this specification. In cases where the attribute is borrowed from another specification,
the "Reference" column refers to the specification where the semantics
for the attribute value can be found.
Attributes defined in this specification have further details below.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
<table class="center" id="table-1">
          <caption><a href="#table-1" class="selfRef">Table 1</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Attribute</th>
              <th class="text-left" rowspan="1" colspan="1">AttributeValue</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
              <th class="text-left" rowspan="1" colspan="1">Multiple?</th>
              <th class="text-left" rowspan="1" colspan="1">OID</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">vendor</td>
              <td class="text-left" rowspan="1" colspan="1">utf8String</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
              <td class="text-left" rowspan="1" colspan="1">No</td>
              <td class="text-left" rowspan="1" colspan="1">id-pkix-evidence-attribute-platform-vendor</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">oemid</td>
              <td class="text-left" rowspan="1" colspan="1">bytes</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#RFC9711" class="cite xref">RFC9711</a>]</span>
</td>
              <td class="text-left" rowspan="1" colspan="1">No</td>
              <td class="text-left" rowspan="1" colspan="1">id-pkix-evidence-attribute-platform-oemid</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">hwmodel</td>
              <td class="text-left" rowspan="1" colspan="1">bytes</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#RFC9711" class="cite xref">RFC9711</a>]</span>
</td>
              <td class="text-left" rowspan="1" colspan="1">No</td>
              <td class="text-left" rowspan="1" colspan="1">id-pkix-evidence-attribute-platform-hwmodel</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">hwversion</td>
              <td class="text-left" rowspan="1" colspan="1">utf8String</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#RFC9711" class="cite xref">RFC9711</a>]</span>
</td>
              <td class="text-left" rowspan="1" colspan="1">No</td>
              <td class="text-left" rowspan="1" colspan="1">id-pkix-evidence-attribute-platform-hwversion</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">hwserial</td>
              <td class="text-left" rowspan="1" colspan="1">utf8String</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
              <td class="text-left" rowspan="1" colspan="1">No</td>
              <td class="text-left" rowspan="1" colspan="1">id-pkix-evidence-attribute-platform-hwserial</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">swname</td>
              <td class="text-left" rowspan="1" colspan="1">utf8String</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#RFC9711" class="cite xref">RFC9711</a>]</span>
</td>
              <td class="text-left" rowspan="1" colspan="1">No</td>
              <td class="text-left" rowspan="1" colspan="1">id-pkix-evidence-attribute-platform-swname</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">swversion</td>
              <td class="text-left" rowspan="1" colspan="1">utf8String</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#RFC9711" class="cite xref">RFC9711</a>]</span>
</td>
              <td class="text-left" rowspan="1" colspan="1">No</td>
              <td class="text-left" rowspan="1" colspan="1">id-pkix-evidence-attribute-platform-swversion</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">dbgstat</td>
              <td class="text-left" rowspan="1" colspan="1">int</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#RFC9711" class="cite xref">RFC9711</a>]</span>
</td>
              <td class="text-left" rowspan="1" colspan="1">No</td>
              <td class="text-left" rowspan="1" colspan="1">id-pkix-evidence-attribute-platform-debugstat</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">uptime</td>
              <td class="text-left" rowspan="1" colspan="1">int</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#RFC9711" class="cite xref">RFC9711</a>]</span>
</td>
              <td class="text-left" rowspan="1" colspan="1">No</td>
              <td class="text-left" rowspan="1" colspan="1">id-pkix-evidence-attribute-platform-uptime</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">bootcount</td>
              <td class="text-left" rowspan="1" colspan="1">int</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#RFC9711" class="cite xref">RFC9711</a>]</span>
</td>
              <td class="text-left" rowspan="1" colspan="1">No</td>
              <td class="text-left" rowspan="1" colspan="1">id-pkix-evidence-attribute-platform-bootcount</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">fipsboot</td>
              <td class="text-left" rowspan="1" colspan="1">bool</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#FIPS140-3" class="cite xref">FIPS140-3</a>]</span>
</td>
              <td class="text-left" rowspan="1" colspan="1">No</td>
              <td class="text-left" rowspan="1" colspan="1">id-pkix-evidence-attribute-platform-fipsboot</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">fipsver</td>
              <td class="text-left" rowspan="1" colspan="1">utf8String</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#FIPS140-3" class="cite xref">FIPS140-3</a>]</span>
</td>
              <td class="text-left" rowspan="1" colspan="1">No</td>
              <td class="text-left" rowspan="1" colspan="1">id-pkix-evidence-attribute-platform-fipsver</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">fipslevel</td>
              <td class="text-left" rowspan="1" colspan="1">int</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#FIPS140-3" class="cite xref">FIPS140-3</a>]</span>
</td>
              <td class="text-left" rowspan="1" colspan="1">No</td>
              <td class="text-left" rowspan="1" colspan="1">id-pkix-evidence-attribute-platform-fipslevel</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">fipsmodule</td>
              <td class="text-left" rowspan="1" colspan="1">utf8String</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#FIPS140-3" class="cite xref">FIPS140-3</a>]</span>
</td>
              <td class="text-left" rowspan="1" colspan="1">No</td>
              <td class="text-left" rowspan="1" colspan="1">id-pkix-evidence-attribute-platform-fipsmodule</td>
            </tr>
          </tbody>
        </table>
<p id="section-5.1-5">Each attribute defined in the table above is described in the following sub-sections.<a href="#section-5.1-5" class="pilcrow">¶</a></p>
<div id="vendor">
<section id="section-5.1.1">
          <h4 id="name-vendor">
<a href="#section-5.1.1" class="section-number selfRef">5.1.1. </a><a href="#name-vendor" class="section-name selfRef">vendor</a>
          </h4>
<p id="section-5.1.1-1">A human-readable string that reports the name of the device's manufacturer. If the device is submitted to
FIPS validation, this string should correspond to the vendor field of the submission.<a href="#section-5.1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="oemid-hwmodel-hwversion-swname-swversion-dbgstat-uptime-bootcount">
<section id="section-5.1.2">
          <h4 id="name-oemid-hwmodel-hwversion-swn">
<a href="#section-5.1.2" class="section-number selfRef">5.1.2. </a><a href="#name-oemid-hwmodel-hwversion-swn" class="section-name selfRef">oemid, hwmodel, hwversion, swname, swversion, dbgstat, uptime, bootcount</a>
          </h4>
<p id="section-5.1.2-1">These attributes are defined in <span>[<a href="#RFC9711" class="cite xref">RFC9711</a>]</span> and reused in this specification for interoperability. Small
descriptions are offered for each to ease the reading of this specification. In case of confusion between the
description offered here and the one in <span>[<a href="#RFC9711" class="cite xref">RFC9711</a>]</span>, the definition offered in the latter shall prevail.<a href="#section-5.1.2-1" class="pilcrow">¶</a></p>
<p id="section-5.1.2-2">The attribute "oemid" uniquely identifies the Original Equipment Manufacturer (OEM) of the HSM. This is a
sequence of bytes and is not meant to be a human readable string.<a href="#section-5.1.2-2" class="pilcrow">¶</a></p>
<p id="section-5.1.2-3">The attribute "hwmodel" differentiates models, products, and variants manufactured by a particular OEM. A model
must be unique within a given "oemid". This is a sequence of bytes and is not meant to be a human readable string.<a href="#section-5.1.2-3" class="pilcrow">¶</a></p>
<p id="section-5.1.2-4">The attribute "hwversion" is a text string reporting the version of the hardware. This attribute must be
interpreted along with the attribute "hwmodel".<a href="#section-5.1.2-4" class="pilcrow">¶</a></p>
<p id="section-5.1.2-5">The attribute "swname" is a text string reporting the name of the firmware running on the platform.<a href="#section-5.1.2-5" class="pilcrow">¶</a></p>
<p id="section-5.1.2-6">The attribute "swversion" differentiates between the various revisions of a firmware offered for the platform. This
is a string that is expected to be human readable.<a href="#section-5.1.2-6" class="pilcrow">¶</a></p>
<p id="section-5.1.2-7">The attribute "dbgstat" refers to the state of the debug facilities offered by the HSM. This is an integer
value describing the current state as described in <span>[<a href="#RFC9711" class="cite xref">RFC9711</a>]</span>.<a href="#section-5.1.2-7" class="pilcrow">¶</a></p>
<p id="section-5.1.2-8">The attribute "uptime" reports the number of seconds that have elapsed since the HSM was last booted.<a href="#section-5.1.2-8" class="pilcrow">¶</a></p>
<p id="section-5.1.2-9">The attribute "bootcount" reports the number of times the HSM was booted.<a href="#section-5.1.2-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="hwserial">
<section id="section-5.1.3">
          <h4 id="name-hwserial">
<a href="#section-5.1.3" class="section-number selfRef">5.1.3. </a><a href="#name-hwserial" class="section-name selfRef">hwserial</a>
          </h4>
<p id="section-5.1.3-1">A human-readable string that reports the serial number of the hardware module. This serial number often matches the number engraved
on the case or on an applied sticker.<a href="#section-5.1.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="fipsboot-fipsver-fipslevel-and-fipsmodule">
<section id="section-5.1.4">
          <h4 id="name-fipsboot-fipsver-fipslevel-">
<a href="#section-5.1.4" class="section-number selfRef">5.1.4. </a><a href="#name-fipsboot-fipsver-fipslevel-" class="section-name selfRef">fipsboot, fipsver, fipslevel and fipsmodule</a>
          </h4>
<p id="section-5.1.4-1">FIPS 140-3 CMVP validation places stringent requirements on the mode of operation of the device and the cryptography offered by the module, including only enabling FIPS-approved algorithms, certain requirements on entropy sources, and extensive start-up self-tests. FIPS 140-3 offers compliance levels 1 through 4 with increasingly strict requirements. Many HSMs include a configuration setting that allows the device to be taken out of FIPS mode and thus enable additional functionality or performance, and some offer configuration settings to change between compliance levels.<a href="#section-5.1.4-1" class="pilcrow">¶</a></p>
<p id="section-5.1.4-2">The boolean attribute <code>fipsboot</code> indicates whether the device is currently operating in FIPS mode. When the attribute value is "true", the HSM is running in compliance with the
FIPS 140 restrictions. Among other restrictions, it means that only FIPS-approved algorithms are available. If the value of this attribute is "false", then the HSM is not
restricted to the behavior limited by compliance.<a href="#section-5.1.4-2" class="pilcrow">¶</a></p>
<p id="section-5.1.4-3">The textual attribute <code>fipsver</code> indicates the version of the FIPS CMVP specification with which the device's operational mode is compliant. At the time of writing, the strings "FIPS 140-2" or "FIPS 140-3" <span class="bcp14">SHOULD</span> be used.<a href="#section-5.1.4-3" class="pilcrow">¶</a></p>
<p id="section-5.1.4-4">The integer attribute <code>fipslevel</code> indicates the compliance level to which the device is currently operating and <span class="bcp14">MUST</span> only be 1, 2, 3, or 4. The <code>fipslevel</code> attribute has no meaning if <code>fipsboot</code> is absent or <code>false</code>.<a href="#section-5.1.4-4" class="pilcrow">¶</a></p>
<p id="section-5.1.4-5">The attribute <code>fipsmodule</code> is a textual field used to represent the name of the module that was submitted to CMVP for validation. The information derived by combining this attribute with the vendor name shall
be sufficient to find the associated records in the CMVP database.<a href="#section-5.1.4-5" class="pilcrow">¶</a></p>
<p id="section-5.1.4-6">The FIPS status information in PKIX Evidence indicates only the mode of operation of the device and is not authoritative of its validation status.
This information is available on the NIST CMVP website or by contacting the device vendor.
As an example, some devices may have the option to enable FIPS mode in configuration even if the vendor has not submitted this model for validation. As another example, a device may be running in a mode consistent with FIPS Level 3 but the device was only validated and certified to Level 2.
A Relying Party wishing to know the validation status of the device <span class="bcp14">MUST</span> couple the device state information contained in the Evidence with a valid FIPS CMVP certificate for the device.<a href="#section-5.1.4-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="key-entity">
<section id="section-5.2">
        <h3 id="name-key-entity">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-key-entity" class="section-name selfRef">Key Entity</a>
        </h3>
<p id="section-5.2-1">A key entity is associated with the type <code>id-pkix-evidence-entity-key</code>. Each instance of a
key entity represents a different addressable key found in the Target Environment. There can
be multiple key entities found in a claim description, but each reported key entity <span class="bcp14">MUST</span>
describe a different key. Two key entities may represent the same underlying cryptographic key
(keys with the exact same value) but they must be different portions of the Target Environment's
state.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">A key entity is composed of a set of attributes relating to the cryptographic key. At
minimum, a key entity <span class="bcp14">MUST</span> report the attribute "identifier" to uniquely identify this cryptographic
key from any others found in the same Target Environment.<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<p id="section-5.2-3">A Verifier that encounters a claim description with multiple key entities referring to the
same addressable key <span class="bcp14">MUST</span> reject the Evidence.<a href="#section-5.2-3" class="pilcrow">¶</a></p>
<p id="section-5.2-4">The following table lists the attributes for a key entity defined
within this specification. The "Reference" column refers to the specification where the semantics
for the attribute value can be found.<a href="#section-5.2-4" class="pilcrow">¶</a></p>
<table class="center" id="table-2">
          <caption><a href="#table-2" class="selfRef">Table 2</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Attribute</th>
              <th class="text-left" rowspan="1" colspan="1">AttributeValue</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
              <th class="text-left" rowspan="1" colspan="1">Multiple?</th>
              <th class="text-left" rowspan="1" colspan="1">OID</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">identifier</td>
              <td class="text-left" rowspan="1" colspan="1">utf8String</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
              <td class="text-left" rowspan="1" colspan="1">Yes</td>
              <td class="text-left" rowspan="1" colspan="1">id-pkix-evidence-attribute-key-identifier</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">spki</td>
              <td class="text-left" rowspan="1" colspan="1">bytes</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
              <td class="text-left" rowspan="1" colspan="1">No</td>
              <td class="text-left" rowspan="1" colspan="1">id-pkix-evidence-attribute-key-spki</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">extractable</td>
              <td class="text-left" rowspan="1" colspan="1">bool</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#PKCS11" class="cite xref">PKCS11</a>]</span>
</td>
              <td class="text-left" rowspan="1" colspan="1">No</td>
              <td class="text-left" rowspan="1" colspan="1">id-pkix-evidence-attribute-key-extractable</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">sensitive</td>
              <td class="text-left" rowspan="1" colspan="1">bool</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#PKCS11" class="cite xref">PKCS11</a>]</span>
</td>
              <td class="text-left" rowspan="1" colspan="1">No</td>
              <td class="text-left" rowspan="1" colspan="1">id-pkix-evidence-attribute-key-sensitive</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">never-extractable</td>
              <td class="text-left" rowspan="1" colspan="1">bool</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#PKCS11" class="cite xref">PKCS11</a>]</span>
</td>
              <td class="text-left" rowspan="1" colspan="1">No</td>
              <td class="text-left" rowspan="1" colspan="1">id-pkix-evidence-attribute-key-never-extractable</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">local</td>
              <td class="text-left" rowspan="1" colspan="1">bool</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#PKCS11" class="cite xref">PKCS11</a>]</span>
</td>
              <td class="text-left" rowspan="1" colspan="1">No</td>
              <td class="text-left" rowspan="1" colspan="1">id-pkix-evidence-attribute-key-local</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">expiry</td>
              <td class="text-left" rowspan="1" colspan="1">time</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
              <td class="text-left" rowspan="1" colspan="1">No</td>
              <td class="text-left" rowspan="1" colspan="1">id-pkix-evidence-attribute-key-expiry</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">purpose</td>
              <td class="text-left" rowspan="1" colspan="1">bytes</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
              <td class="text-left" rowspan="1" colspan="1">No</td>
              <td class="text-left" rowspan="1" colspan="1">id-pkix-evidence-attribute-key-purpose</td>
            </tr>
          </tbody>
        </table>
<p id="section-5.2-6">An attestation key might be visible to a client of the device and be reported along with other cryptographic keys. Therefore,
it is acceptable to include a key entity providing claims about an attestation key like any other cryptographic key. An
implementation <span class="bcp14">MAY</span> reject the generation of PKIX Evidence if it relates to an attestation key.<a href="#section-5.2-6" class="pilcrow">¶</a></p>
<div id="identifier">
<section id="section-5.2.1">
          <h4 id="name-identifier">
<a href="#section-5.2.1" class="section-number selfRef">5.2.1. </a><a href="#name-identifier" class="section-name selfRef">identifier</a>
          </h4>
<p id="section-5.2.1-1">A human-readable string that uniquely identifies the cryptographic key. This value often contains
a UUID but could also have a numeric value expressed as text or any other textual description.<a href="#section-5.2.1-1" class="pilcrow">¶</a></p>
<p id="section-5.2.1-2">This attribute <span class="bcp14">MAY</span> be repeated as some environments have more than one way to refer to a
cryptographic key.<a href="#section-5.2.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="spki">
<section id="section-5.2.2">
          <h4 id="name-spki">
<a href="#section-5.2.2" class="section-number selfRef">5.2.2. </a><a href="#name-spki" class="section-name selfRef">spki</a>
          </h4>
<p id="section-5.2.2-1">The value of this attribute contains the DER-encoded field SubjectPublicKeyInfo (see <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>) associated with the cryptographic
key.<a href="#section-5.2.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="extractable-sensitive-never-extractable-local">
<section id="section-5.2.3">
          <h4 id="name-extractable-sensitive-never">
<a href="#section-5.2.3" class="section-number selfRef">5.2.3. </a><a href="#name-extractable-sensitive-never" class="section-name selfRef">extractable, sensitive, never-extractable, local</a>
          </h4>
<p id="section-5.2.3-1">These attributes are defined in <span>[<a href="#PKCS11" class="cite xref">PKCS11</a>]</span> and reused in this specification for interoperability. Small
descriptions are offered for each to ease the reading of this specification. In case of confusion between the
description offered here and the one in <span>[<a href="#PKCS11" class="cite xref">PKCS11</a>]</span>, the definition offered in the latter shall prevail.<a href="#section-5.2.3-1" class="pilcrow">¶</a></p>
<p id="section-5.2.3-2">The attribute "extractable" indicates that the key can be exported from the HSM. Corresponds directly to the attribute CKA_EXTRACTABLE
found in PKCS#11.<a href="#section-5.2.3-2" class="pilcrow">¶</a></p>
<p id="section-5.2.3-3">The attribute "sensitive" indicates that the key cannot leave the HSM in plaintext. Corresponds directly to the attribute CKA_SENSITIVE
found in PKCS#11.<a href="#section-5.2.3-3" class="pilcrow">¶</a></p>
<p id="section-5.2.3-4">The attribute "never-extractable" indicates if the key was never extractable from the HSM throughout the life of the key. Corresponds
directly to the attribute CKA_NEVER_EXTRACTABLE found in PKCS#11.<a href="#section-5.2.3-4" class="pilcrow">¶</a></p>
<p id="section-5.2.3-5">The attribute "local" indicates whether the key was generated locally or imported. Corresponds directly to the attribute CKA_LOCAL
found in PKCS#11.<a href="#section-5.2.3-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="expiry">
<section id="section-5.2.4">
          <h4 id="name-expiry">
<a href="#section-5.2.4" class="section-number selfRef">5.2.4. </a><a href="#name-expiry" class="section-name selfRef">expiry</a>
          </h4>
<p id="section-5.2.4-1">Reports a time after which the key is not to be used. The device <span class="bcp14">MAY</span> enforce this policy based on its internal clock.<a href="#section-5.2.4-1" class="pilcrow">¶</a></p>
<p id="section-5.2.4-2">Note that security considerations should be taken relating to HSMs and their internal clocks. See <a href="#sec-cons-hsm-timestamps" class="auto internal xref">Section 10.7</a>.<a href="#section-5.2.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="purpose">
<section id="section-5.2.5">
          <h4 id="name-purpose">
<a href="#section-5.2.5" class="section-number selfRef">5.2.5. </a><a href="#name-purpose" class="section-name selfRef">purpose</a>
          </h4>
<p id="section-5.2.5-1">Reports the key capabilities associated with the subject key. Since multiple capabilities can be associated with a single key,
the value of this attribute is a list of capabilities, each reported as an object identifier (OID).<a href="#section-5.2.5-1" class="pilcrow">¶</a></p>
<p id="section-5.2.5-2">The value of this attribute is the DER encoding of the following structure:<a href="#section-5.2.5-2" class="pilcrow">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-5.2.5-3">
<pre>
&lt;CODE STARTS&gt;

PkixEvidenceKeyCapabilities ::= SEQUENCE OF OBJECT IDENTIFIER

&lt;CODE ENDS&gt;

</pre><a href="#section-5.2.5-3" class="pilcrow">¶</a>
</div>
<p id="section-5.2.5-4">The following table describes the key capabilities defined in this specification. The key capabilities offered are based on key
attributes provided by PKCS#11. Each capability is assigned an object identifier (OID).<a href="#section-5.2.5-4" class="pilcrow">¶</a></p>
<table class="center" id="table-3">
            <caption><a href="#table-3" class="selfRef">Table 3</a></caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Capability</th>
                <th class="text-left" rowspan="1" colspan="1">PKCS#11</th>
                <th class="text-left" rowspan="1" colspan="1">OID</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">encrypt</td>
                <td class="text-left" rowspan="1" colspan="1">CKA_ENCRYPT</td>
                <td class="text-left" rowspan="1" colspan="1">id-pkix-evidence-key-capability-encrypt</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">decrypt</td>
                <td class="text-left" rowspan="1" colspan="1">CKA_DECRYPT</td>
                <td class="text-left" rowspan="1" colspan="1">id-pkix-evidence-key-capability-decrypt</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">wrap</td>
                <td class="text-left" rowspan="1" colspan="1">CKA_WRAP</td>
                <td class="text-left" rowspan="1" colspan="1">id-pkix-evidence-key-capability-wrap</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">unwrap</td>
                <td class="text-left" rowspan="1" colspan="1">CKA_UNWRAP</td>
                <td class="text-left" rowspan="1" colspan="1">id-pkix-evidence-key-capability-unwrap</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">sign</td>
                <td class="text-left" rowspan="1" colspan="1">CKA_SIGN</td>
                <td class="text-left" rowspan="1" colspan="1">id-pkix-evidence-key-capability-sign</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">sign-recover</td>
                <td class="text-left" rowspan="1" colspan="1">CKA_SIGN_RECOVER</td>
                <td class="text-left" rowspan="1" colspan="1">id-pkix-evidence-key-capability-sign-recover</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">verify</td>
                <td class="text-left" rowspan="1" colspan="1">CKA_VERIFY</td>
                <td class="text-left" rowspan="1" colspan="1">id-pkix-evidence-key-capability-verify</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">verify-recover</td>
                <td class="text-left" rowspan="1" colspan="1">CKA_VERIFY_RECOVER</td>
                <td class="text-left" rowspan="1" colspan="1">id-pkix-evidence-key-capability-verify-recover</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">derive</td>
                <td class="text-left" rowspan="1" colspan="1">CKA_DERIVE</td>
                <td class="text-left" rowspan="1" colspan="1">id-pkix-evidence-key-capability-derive</td>
              </tr>
            </tbody>
          </table>
<p id="section-5.2.5-6">The use of an object identifier to report a capability allows third parties to extend this list to support
implementations that have other key capabilities.<a href="#section-5.2.5-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="transaction-entity">
<section id="section-5.3">
        <h3 id="name-transaction-entity">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-transaction-entity" class="section-name selfRef">Transaction Entity</a>
        </h3>
<p id="section-5.3-1">A transaction entity is associated with the type <code>id-pkix-evidence-entity-transaction</code>. This is
a logical entity and does not relate to an element found in the Target Environment. Instead, it
groups together attributes that relate to the request of generating the Evidence.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<p id="section-5.3-2">For example, it is possible to include a "nonce" as part of the request to produce Evidence. This
nonce is repeated as part of the Evidence to prove
the freshness of the claims. This "nonce" is not related to any element in the Target Environment
and the transaction entity is used to gather those values into attributes.<a href="#section-5.3-2" class="pilcrow">¶</a></p>
<p id="section-5.3-3">A transaction entity, if provided, <span class="bcp14">MUST</span> be included only once within the reported entities. If a
Verifier encounters multiple entities of type <code>id-pkix-evidence-entity-transaction</code>, it <span class="bcp14">MUST</span>
reject the Evidence.<a href="#section-5.3-3" class="pilcrow">¶</a></p>
<p id="section-5.3-4">The following table lists the attributes for a transaction entity defined
within this specification. The "Reference" column refers to the specification where the semantics
for the attribute value can be found.<a href="#section-5.3-4" class="pilcrow">¶</a></p>
<table class="center" id="table-4">
          <caption><a href="#table-4" class="selfRef">Table 4</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Attribute</th>
              <th class="text-left" rowspan="1" colspan="1">AttributeValue</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
              <th class="text-left" rowspan="1" colspan="1">Multiple?</th>
              <th class="text-left" rowspan="1" colspan="1">OID</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">nonce</td>
              <td class="text-left" rowspan="1" colspan="1">bytes</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#RFC9711" class="cite xref">RFC9711</a>]</span>
</td>
              <td class="text-left" rowspan="1" colspan="1">No</td>
              <td class="text-left" rowspan="1" colspan="1">id-pkix-evidence-attribute-transaction-nonce</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">timestamp</td>
              <td class="text-left" rowspan="1" colspan="1">time</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#RFC9711" class="cite xref">RFC9711</a>]</span>
</td>
              <td class="text-left" rowspan="1" colspan="1">No</td>
              <td class="text-left" rowspan="1" colspan="1">id-pkix-evidence-attribute-transaction-timestamp</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">ak-spki</td>
              <td class="text-left" rowspan="1" colspan="1">bytes</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
              <td class="text-left" rowspan="1" colspan="1">Yes</td>
              <td class="text-left" rowspan="1" colspan="1">id-pkix-evidence-attribute-transaction-ak-spki</td>
            </tr>
          </tbody>
        </table>
<div id="nonce">
<section id="section-5.3.1">
          <h4 id="name-nonce">
<a href="#section-5.3.1" class="section-number selfRef">5.3.1. </a><a href="#name-nonce" class="section-name selfRef">nonce</a>
          </h4>
<p id="section-5.3.1-1">The attribute "nonce" is used to provide "freshness" quality as to the claims provided in the PkixEvidence message. A Presenter requesting a PkixEvidence message <span class="bcp14">MAY</span> provide a nonce value as part of the request. This nonce value, if provided, <span class="bcp14">SHOULD</span> be repeated in the generated Evidence as an attribute within the transaction entity. Unlike EAT, only a single <code>transaction.nonce</code> is permitted to simplify verifier logic and reduce ambiguity.<a href="#section-5.3.1-1" class="pilcrow">¶</a></p>
<p id="section-5.3.1-2">This is similar to the attribute "eat_nonce" as defined in <span>[<a href="#RFC9711" class="cite xref">RFC9711</a>]</span>. According to that specification, this attribute may be specified multiple times with
different values. However, within the scope of this specification, the "nonce" value can be specified only once within a transaction.<a href="#section-5.3.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="timestamp">
<section id="section-5.3.2">
          <h4 id="name-timestamp">
<a href="#section-5.3.2" class="section-number selfRef">5.3.2. </a><a href="#name-timestamp" class="section-name selfRef">timestamp</a>
          </h4>
<p id="section-5.3.2-1">The time at which the PKIX Evidence was generated, according to the internal system clock of the Attester. This is similar to the
"iat" claim in <span>[<a href="#RFC9711" class="cite xref">RFC9711</a>]</span>.<a href="#section-5.3.2-1" class="pilcrow">¶</a></p>
<p id="section-5.3.2-2">Note that security considerations should be taken relating to the evaluation of timestamps generated by HSMs. See <a href="#sec-cons-hsm-timestamps" class="auto internal xref">Section 10.7</a>.<a href="#section-5.3.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ak-spki">
<section id="section-5.3.3">
          <h4 id="name-ak-spki">
<a href="#section-5.3.3" class="section-number selfRef">5.3.3. </a><a href="#name-ak-spki" class="section-name selfRef">ak-spki</a>
          </h4>
<p id="section-5.3.3-1">This field contains the encoded Subject Public Key Information (SPKI) for the attestation key used to sign the Evidence. The definition
and encoding for SPKIs are defined in X.509 certificates (<span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>).<a href="#section-5.3.3-1" class="pilcrow">¶</a></p>
<p id="section-5.3.3-2">This transaction attribute is used to bind the content of the Evidence with the key(s) used to sign that Evidence. The importance
of this binding is discussed in <a href="#sec-detached-sigs" class="auto internal xref">Section 10.3</a>.<a href="#section-5.3.3-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-additional-attr-types">
<section id="section-5.4">
        <h3 id="name-additional-entity-and-attri">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-additional-entity-and-attri" class="section-name selfRef">Additional Entity and Attribute Types</a>
        </h3>
<p id="section-5.4-1">It is expected that HSM vendors will register additional Entity and Attribute types by assigning OIDs from their own proprietary OID arcs to hold data describing additional proprietary key properties.<a href="#section-5.4-1" class="pilcrow">¶</a></p>
<p id="section-5.4-2">When new entity and attribute types are used, documentation similar to the one produced in this specification <span class="bcp14">SHOULD</span> be distributed to
explain the meaning of the types and the frequency that values can be provided.<a href="#section-5.4-2" class="pilcrow">¶</a></p>
<p id="section-5.4-3">See <a href="#sec-req-processing" class="auto internal xref">Section 7.3</a>, <a href="#sec-req-verification" class="auto internal xref">Section 7.4</a> and <a href="#sec-cons-verifier" class="auto internal xref">Section 10.1</a> for handling of unrecognized custom types.<a href="#section-5.4-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="encoding">
<section id="section-5.5">
        <h3 id="name-encoding">
<a href="#section-5.5" class="section-number selfRef">5.5. </a><a href="#name-encoding" class="section-name selfRef">Encoding</a>
        </h3>
<p id="section-5.5-1">A PkixEvidence is to be DER encoded <span>[<a href="#X.690" class="cite xref">X.690</a>]</span>.<a href="#section-5.5-1" class="pilcrow">¶</a></p>
<p id="section-5.5-2">If a textual representation is required, then the DER encoding <span class="bcp14">MAY</span> be subsequently encoded into Standard Base64 as defined in <span>[<a href="#RFC4648" class="cite xref">RFC4648</a>]</span>.<a href="#section-5.5-2" class="pilcrow">¶</a></p>
<p id="section-5.5-3">PEM-like representations are also allowed where a MIME-compliant Base64 transformation of the DER encoding is used, provided that the
header label is "EVIDENCE". For example:<a href="#section-5.5-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.5-4">
<pre>
-----BEGIN EVIDENCE-----
(...)
-----END EVIDENCE-----
</pre><a href="#section-5.5-4" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="sec-verif-proc">
<section id="section-6">
      <h2 id="name-signing-and-verification-pr">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-signing-and-verification-pr" class="section-name selfRef">Signing and Verification Procedures</a>
      </h2>
<p id="section-6-1">The <code>SignatureBlock.signatureValue</code> signs over the DER-encoded to-be-signed Evidence data
<code>PkixEvidence.tbs</code> and <span class="bcp14">MUST</span> be validated with the subject public key of the leaf
X.509 certificate contained in the <code>SignerIdentifier.certificate</code>. Verifiers <span class="bcp14">MAY</span> also use
<code>PkixEvidence.intermediateCertificates</code> to build a certification path to a trust anchor.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">Note that a PkixEvidence <span class="bcp14">MAY</span> contain zero or more SignatureBlocks.
A PkixEvidence with zero SignatureBlocks is unsigned and unprotected; Verifiers <span class="bcp14">MUST</span> treat it as untrusted and <span class="bcp14">MUST NOT</span> rely on its claims.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">More than one SignatureBlock <span class="bcp14">MAY</span> be used to convey a number of different semantics.
For example, the HSM's Attesting Service might hold multiple Attestation Keys on different cryptographic
algorithms in order to provide algorithm redundancy in the case that one algorithm becomes cryptographically broken. In this case a Verifier would be expected to validate all SignatureBlocks. Alternatively, the HSM's Attesting Service may hold multiple Attestation Keys (or multiple X.509 certificates for the same key) from multiple operational environments to which it belongs. In this case a Verifier would be expected to only validate the SignatureBlock corresponding to its own environment. Alternatively, multiple SignatureBlocks could be used to convey counter-signatures from external parties, in which case the Verifier will need to be equipped with environment-specific verification logic. Multiple of these cases, and potentially others, could be supported by a single PkixEvidence object.<a href="#section-6-3" class="pilcrow">¶</a></p>
<p id="section-6-4">Note that each SignatureBlock is a fully detached signature over the tbs content with no binding between the signed content and the SignatureBlocks, or between SignatureBlocks, meaning that a third-party can add a
counter-signature of the Evidence after the fact, or an attacker can remove a SignatureBlock without leaving any artifact. See <a href="#sec-detached-sigs" class="auto internal xref">Section 10.3</a> for further discussion.<a href="#section-6-4" class="pilcrow">¶</a></p>
<p id="section-6-5">If any <code>transaction.ak-spki</code> attributes are present, the Verifier <span class="bcp14">SHOULD</span> verify that each <code>SignerIdentifier</code>’s SubjectPublicKeyInfo (or the SPKI of its <code>certificate</code>) matches at least one <code>ak-spki</code> value.<a href="#section-6-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-reqs">
<section id="section-7">
      <h2 id="name-attestation-requests">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-attestation-requests" class="section-name selfRef">Attestation Requests</a>
      </h2>
<p id="section-7-1">This section is informative in nature and implementers of this specification do not need to adhere to it. The aim of this section is
to provide a standard interface between a Presenter and an HSM producing PKIX Evidence. The authors hope that this standard interface will
yield interoperable tools between offerings from different vendors.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">The interface presented in this section might be too complex for manufacturers of HSMs with limited capabilities such as smartcards
or personal ID tokens. For devices with limited capabilities, a fixed PKIX Evidence endorsed by the vendor might be installed
during manufacturing. Other approaches for constrained HSMs might be to report entities and attributes that are fixed or offer limited
variations.<a href="#section-7-2" class="pilcrow">¶</a></p>
<p id="section-7-3">On the other hand, an enterprise-grade HSM with the capability to hold a large number of private keys is expected to be capable of generating
PKIX Evidence catered to the specific constraints imposed by a Verifier and without exposing extraneous information. The aim of the request
interface is to provide the means to select and report specific information in the PKIX Evidence.<a href="#section-7-3" class="pilcrow">¶</a></p>
<p id="section-7-4">This section introduces the role of "Presenter" as shown in <a href="#fig-arch" class="auto internal xref">Figure 1</a>. The Presenter is the role that initiates the generation of PKIX
Evidence. Since HSMs are generally servers (client/server relationship) or peripherals (controller/peripheral relationship), a Presenter is
required to launch the process of creating the PKIX Evidence and capturing it to forward it to the Verifier.<a href="#section-7-4" class="pilcrow">¶</a></p>
<span id="name-architecture"></span><div id="fig-arch">
<figure id="figure-1">
        <div id="section-7-5.1">
          <div class="alignLeft art-svg artwork" id="section-7-5.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="464" width="392" viewBox="0 0 392 464" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 8,32 L 8,336" fill="none" stroke="black"></path>
              <path d="M 48,416 L 48,448" fill="none" stroke="black"></path>
              <path d="M 64,80 L 64,160" fill="none" stroke="black"></path>
              <path d="M 64,240 L 64,288" fill="none" stroke="black"></path>
              <path d="M 112,296 L 112,408" fill="none" stroke="black"></path>
              <path d="M 128,160 L 128,232" fill="none" stroke="black"></path>
              <path d="M 136,288 L 136,408" fill="none" stroke="black"></path>
              <path d="M 184,416 L 184,448" fill="none" stroke="black"></path>
              <path d="M 216,80 L 216,160" fill="none" stroke="black"></path>
              <path d="M 216,240 L 216,288" fill="none" stroke="black"></path>
              <path d="M 248,32 L 248,336" fill="none" stroke="black"></path>
              <path d="M 280,416 L 280,448" fill="none" stroke="black"></path>
              <path d="M 384,416 L 384,448" fill="none" stroke="black"></path>
              <path d="M 8,32 L 248,32" fill="none" stroke="black"></path>
              <path d="M 64,80 L 216,80" fill="none" stroke="black"></path>
              <path d="M 64,160 L 216,160" fill="none" stroke="black"></path>
              <path d="M 64,240 L 216,240" fill="none" stroke="black"></path>
              <path d="M 64,288 L 216,288" fill="none" stroke="black"></path>
              <path d="M 8,336 L 248,336" fill="none" stroke="black"></path>
              <path d="M 48,416 L 184,416" fill="none" stroke="black"></path>
              <path d="M 280,416 L 384,416" fill="none" stroke="black"></path>
              <path d="M 192,432 L 272,432" fill="none" stroke="black"></path>
              <path d="M 48,448 L 184,448" fill="none" stroke="black"></path>
              <path d="M 280,448 L 384,448" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="280,432 268,426.4 268,437.6" fill="black" transform="rotate(0,272,432)"></polygon>
              <polygon class="arrowhead" points="144,408 132,402.4 132,413.6" fill="black" transform="rotate(90,136,408)"></polygon>
              <polygon class="arrowhead" points="136,232 124,226.4 124,237.6" fill="black" transform="rotate(90,128,232)"></polygon>
              <polygon class="arrowhead" points="120,296 108,290.4 108,301.6" fill="black" transform="rotate(270,112,296)"></polygon>
              <g class="text">
                <text x="60" y="52">Attester</text>
                <text x="120" y="52">(HSM)</text>
                <text x="100" y="100">Target</text>
                <text x="120" y="116">Environment</text>
                <text x="112" y="132">(Entities</text>
                <text x="160" y="132">&amp;</text>
                <text x="128" y="148">attributes)</text>
                <text x="168" y="196">Collect</text>
                <text x="164" y="212">Claims</text>
                <text x="120" y="260">Attestation</text>
                <text x="104" y="276">Service</text>
                <text x="56" y="372">Attestation</text>
                <text x="180" y="372">PKIX</text>
                <text x="40" y="388">Request</text>
                <text x="196" y="388">Evidence</text>
                <text x="120" y="436">Presenter</text>
                <text x="332" y="436">Verifier</text>
              </g>
            </svg><a href="#section-7-5.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-architecture" class="selfRef">Architecture</a>
        </figcaption></figure>
</div>
<p id="section-7-6">An Attestation Request (request) is assembled by the Presenter and submitted to the HSM. The HSM parses the request and produces PKIX Evidence
which is returned to the Presenter for distribution.<a href="#section-7-6" class="pilcrow">¶</a></p>
<p id="section-7-7">In the previous figure, the HSM is represented as being composed of an attestation service and a Target Environment. This representation is offered
as a simplified view and implementations are not required to adhere to this separation of concerns.<a href="#section-7-7" class="pilcrow">¶</a></p>
<p id="section-7-8">The aim of the figure is to depict the position of the Presenter as an intermediate role between the Attester (in this case the HSM) and the Verifier.
The role of "Presenter" is privileged as it controls the Evidence being generated by the Attester. However, the role is not "trusted" as
the Verifier does not have to take into account the participation of the Presenter as part of the function of appraising the Evidence.<a href="#section-7-8" class="pilcrow">¶</a></p>
<p id="section-7-9">The attestation request, shown in the figure, consists of a structure <code>TbsPkixEvidence</code> containing one <code>ReportedEntity</code> for each entity expected to
be included in the Evidence produced by the HSM.<a href="#section-7-9" class="pilcrow">¶</a></p>
<p id="section-7-10">Each instance of <code>ReportedEntity</code> included in the request is referred to as a request entity. A request entity contains a number of instances
of <code>ReportedAttribute</code> known as request attributes. The collection of request entities and request attributes represent the information desired
by the Presenter.<a href="#section-7-10" class="pilcrow">¶</a></p>
<p id="section-7-11">In most cases the value of a request attribute should be left unspecified by the Presenter. In the process of generating
the Evidence, the values of the desired attributes are observed by the Attestation Service within the HSM and reported accordingly. For the purpose
of creating a request, the Presenter does not specify the value of the requested attributes and leaves them empty. This is possible because the definition of
the structure <code>ReportedAttribute</code> specifies the element <code>value</code> as optional.<a href="#section-7-11" class="pilcrow">¶</a></p>
<p id="section-7-12">On the other hand, there are circumstances where the value of a request attribute should be provided by the Presenter. For example, when a particular
cryptographic key is to be included in the Evidence, the request must include a key entity with one of the "identifier" attributes set to the value
corresponding to the desired key.<a href="#section-7-12" class="pilcrow">¶</a></p>
<p id="section-7-13">Some instances of <code>ReportedEntity</code>, such as those representing the platform or the transaction, do not need identifiers as the associated elements are
implicit in nature. Custom entity types might need selection during an attestation request and related documentation should specify how this is
achieved.<a href="#section-7-13" class="pilcrow">¶</a></p>
<p id="section-7-14">The instance of <code>TbsPkixEvidence</code> is unsigned and does not provide any means to maintain integrity when communicated from the Presenter to the HSM.
These details are left to the implementer. However, it is worth pointing out that the structure offered by <code>PkixEvidence</code> could be reused by an
implementer to provide those capabilities, as described in <a href="#sec-cons-auth-the-presenter" class="auto internal xref">Section 10.5</a>.<a href="#section-7-14" class="pilcrow">¶</a></p>
<div id="request-attributes-with-specified-values">
<section id="section-7.1">
        <h3 id="name-request-attributes-with-spe">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-request-attributes-with-spe" class="section-name selfRef">Request Attributes with Specified Values</a>
        </h3>
<p id="section-7.1-1">This section deals with the request attributes specified in this document where a value should be provided by a Presenter. In other words, this
section defines all request attributes that should set in the structure <code>ReportedAttribute</code>. Request attributes not covered in this sub-section
should not have a specified value (left empty).<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">Since this section is non-normative, implementers may deviate from those recommendations.<a href="#section-7.1-2" class="pilcrow">¶</a></p>
<div id="key-identifiers">
<section id="section-7.1.1">
          <h4 id="name-key-identifiers">
<a href="#section-7.1.1" class="section-number selfRef">7.1.1. </a><a href="#name-key-identifiers" class="section-name selfRef">Key Identifiers</a>
          </h4>
<p id="section-7.1.1-1">A Presenter may choose to select which cryptographic keys are reported as part of the PKIX Evidence. For each selected cryptographic key,
the Presenter includes a request entity of type <code>id-pkix-evidence-entity-key</code>. Among the request attributes for this entity, the
Presenter includes one attribute with the type <code>id-pkix-evidence-attribute-key-identifier</code>. The value of this attribute should be
set to the utf8String that represents the identifier for the specific key.<a href="#section-7.1.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1.1-2">An HSM receiving an attestation request which selects a key via this approach <span class="bcp14">SHOULD</span> fail the transaction if it cannot find the cryptographic
key associated with the specified identifier.<a href="#section-7.1.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="nonce-1">
<section id="section-7.1.2">
          <h4 id="name-nonce-2">
<a href="#section-7.1.2" class="section-number selfRef">7.1.2. </a><a href="#name-nonce-2" class="section-name selfRef">Nonce</a>
          </h4>
<p id="section-7.1.2-1">A Presenter may choose to include a nonce as part of the attestation request. When producing the PKIX Evidence, the HSM repeats the
nonce that was provided as part of the request.<a href="#section-7.1.2-1" class="pilcrow">¶</a></p>
<p id="section-7.1.2-2">When providing a nonce, a Presenter includes, in the attestation request, an entity of type <code>id-pkix-evidence-entity-transaction</code>
with an attribute of type <code>id-pkix-evidence-attribute-transaction-nonce</code>. This attribute is set with the value of the
nonce as "bytes".<a href="#section-7.1.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="custom-key-selection">
<section id="section-7.1.3">
          <h4 id="name-custom-key-selection">
<a href="#section-7.1.3" class="section-number selfRef">7.1.3. </a><a href="#name-custom-key-selection" class="section-name selfRef">Custom Key Selection</a>
          </h4>
<p id="section-7.1.3-1">An implementer might desire to select multiple cryptographic keys based on a shared attribute. A possible approach
is to include a single request entity of type <code>id-pkix-evidence-entity-key</code> including an attribute with a set value. This attribute
would not be related to the key identifier as this is unique to each key. A HSM supporting this scheme could select all the cryptographic
keys matching the specified attribute and report them in the PKIX Evidence.<a href="#section-7.1.3-1" class="pilcrow">¶</a></p>
<p id="section-7.1.3-2">This is a departure from the base request interface, as multiple key entities are reported from a single request entity.<a href="#section-7.1.3-2" class="pilcrow">¶</a></p>
<p id="section-7.1.3-3">More elaborate selection schemes can be envisaged where multiple request attributes specifying values would be tested against cryptographic keys.
Whether these attributes are combined in a logical "and" or in a logical "or" would need to be specified by the implementer.<a href="#section-7.1.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="custom-transaction-entity-attributes">
<section id="section-7.1.4">
          <h4 id="name-custom-transaction-entity-a">
<a href="#section-7.1.4" class="section-number selfRef">7.1.4. </a><a href="#name-custom-transaction-entity-a" class="section-name selfRef">Custom Transaction Entity Attributes</a>
          </h4>
<p id="section-7.1.4-1">The extensibility offered by the proposed request interface allows an implementer to add custom attributes to the transaction entity in
order to influence the way that the Evidence generation is performed.<a href="#section-7.1.4-1" class="pilcrow">¶</a></p>
<p id="section-7.1.4-2">In such an approach, a new custom attribute for request entities of type "transaction" is defined. Then, an
attribute of that type is included in the attestation request (as part of the transaction entity) while specifying a value. This value
is considered by the HSM while generating the PKIX Evidence.<a href="#section-7.1.4-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="reporting-of-attestation-keys">
<section id="section-7.2">
        <h3 id="name-reporting-of-attestation-ke">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-reporting-of-attestation-ke" class="section-name selfRef">Reporting of Attestation Keys</a>
        </h3>
<p id="section-7.2-1">There is a provision for the Attester to report the Attestation Key(s) used during the generation of the Evidence. To this end,
the transaction attribute "ak-spki" is used.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<p id="section-7.2-2">A Presenter invokes this provision by submitting an attestation request with a transaction attribute of type "ak-spki" with a
non-specified value (left empty).<a href="#section-7.2-2" class="pilcrow">¶</a></p>
<p id="section-7.2-3">In this case, the Attester adds a transaction attribute of type "ak-spki" for each Attestation Key used to sign the Evidence. The
value of this attribute is an octet string (bytes) which is the encoding of the Subject Public Key Information (SPKI) associated
with the Attestation Key. Details on SPKIs and their encoding can be found in X.509 certificates (<span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>).<a href="#section-7.2-3" class="pilcrow">¶</a></p>
<p id="section-7.2-4">This reporting effectively binds the signature blocks to the content (see <a href="#sec-detached-sigs" class="auto internal xref">Section 10.3</a>).<a href="#section-7.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-req-processing">
<section id="section-7.3">
        <h3 id="name-processing-an-attestation-r">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-processing-an-attestation-r" class="section-name selfRef">Processing an Attestation Request</a>
        </h3>
<p id="section-7.3-1">This sub-section deals with the rules that should be considered when an Attester (the HSM) processes a request to generate
Evidence. This section is non-normative and implementers <span class="bcp14">MAY</span> choose to not follow these recommendations.<a href="#section-7.3-1" class="pilcrow">¶</a></p>
<p id="section-7.3-2">These recommendations apply to any attestation request schemes and are not restricted solely to the request interface proposed
here.<a href="#section-7.3-2" class="pilcrow">¶</a></p>
<p id="section-7.3-3">An Attester <span class="bcp14">SHOULD</span> fail an attestation request if it contains an unrecognized entity type. This is to ensure that all the semantics expected
by the Presenter are fully understood by the Attester.<a href="#section-7.3-3" class="pilcrow">¶</a></p>
<p id="section-7.3-4">An Attester <span class="bcp14">MUST</span> fail an attestation request if it contains a request attribute of an unrecognized type with a specified a value (not
empty). This represents a situation where the Presenter is selecting specific information that is not understood by the Attester.<a href="#section-7.3-4" class="pilcrow">¶</a></p>
<p id="section-7.3-5">An Attester <span class="bcp14">SHOULD</span> ignore unrecognized attribute types in an attestation request. In this situation, the Attester <span class="bcp14">SHOULD NOT</span> include
the attribute as part of the response. This guidance is to increase the likelihood of interoperability between tools of various
vendors.<a href="#section-7.3-5" class="pilcrow">¶</a></p>
<p id="section-7.3-6">An Attester <span class="bcp14">MUST NOT</span> include entities and attributes in the generated Evidence if these entities and attributes were
not specified as part of the request. This is to give the Presenter the control on what information is disclosed by the Attester.<a href="#section-7.3-6" class="pilcrow">¶</a></p>
<p id="section-7.3-7">An Attester <span class="bcp14">MUST</span> fail an attestation request if the Presenter does not have the appropriate access rights to the entities included
in the request.<a href="#section-7.3-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-req-verification">
<section id="section-7.4">
        <h3 id="name-verification-by-presenter">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-verification-by-presenter" class="section-name selfRef">Verification by Presenter</a>
        </h3>
<p id="section-7.4-1">This sub-section deals with the rules that should be considered when a Presenter receives PKIX Evidence from the Attester (the HSM)
prior to distribution. This section is non-normative and implementers <span class="bcp14">MAY</span> choose to not follow these recommendations.<a href="#section-7.4-1" class="pilcrow">¶</a></p>
<p id="section-7.4-2">These recommendations apply to any PKIX Evidence and are not restricted solely to Evidence generated from the proposed request interface.<a href="#section-7.4-2" class="pilcrow">¶</a></p>
<p id="section-7.4-3">A Presenter <span class="bcp14">MUST</span> review the Evidence produced by an Attester for fitness prior to distribution.<a href="#section-7.4-3" class="pilcrow">¶</a></p>
<p id="section-7.4-4">A Presenter <span class="bcp14">MUST NOT</span> disclose Evidence if it contains information it
cannot parse. This restriction applies to entity types and attributes type. This is
to ensure that the information provided by the Attester can be evaluated by the
Presenter.<a href="#section-7.4-4" class="pilcrow">¶</a></p>
<p id="section-7.4-5">A Presenter <span class="bcp14">MUST NOT</span> disclose Evidence if it contains entities others
than the ones that were requested of the Attester. This is to ensure that only the
selected entities are exposed to the Verifier.<a href="#section-7.4-5" class="pilcrow">¶</a></p>
<p id="section-7.4-6">A Presenter <span class="bcp14">MUST NOT</span> disclose Evidence if it contains an entity with an attribute
that was not requested of the Attester. This is to ensure that only the selected
information is disclosed to the Verifier.<a href="#section-7.4-6" class="pilcrow">¶</a></p>
<p id="section-7.4-7">Further privacy concerns are discussed in <a href="#sec-cons-privacy" class="auto internal xref">Section 10.4</a>.<a href="#section-7.4-7" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-asn1-mod">
<section id="section-8">
      <h2 id="name-asn1-module">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-asn1-module" class="section-name selfRef">ASN.1 Module</a>
      </h2>
<div class="breakable lang-asn.1 sourcecode" id="section-8-1">
<pre>
&lt;CODE STARTS&gt;

=============== NOTE: '\' line wrapping per RFC 8792 ================

PKIX-Evidence-2025
      { iso(1) identified-organization(3) dod(6) internet(1)
        security(5) mechanisms(5) pkix(7) id-mod(0)
        id-mod-pkix-evidence-2025(TBDMOD) }

DEFINITIONS IMPLICIT TAGS ::=
BEGIN

PkixEvidence ::= SEQUENCE {
    tbs                           TbsPkixEvidence,
    signatures                    SEQUENCE SIZE (0..MAX) OF \
                                                      SignatureBlock,
    intermediateCertificates  [0] SEQUENCE OF Certificate OPTIONAL
                                  -- As defined in RFC 5280
}

TbsPkixEvidence ::= SEQUENCE {
    version INTEGER,
    reportedEntities SEQUENCE SIZE (1..MAX) OF ReportedEntity
}

ReportedEntity ::= SEQUENCE {
    entityType         OBJECT IDENTIFIER,
    reportedAttributes SEQUENCE SIZE (1..MAX) OF ReportedAttribute
}

ReportedAttribute ::= SEQUENCE {
    attributeType      OBJECT IDENTIFIER,
    value              AttributeValue OPTIONAL
}

AttributeValue ::= CHOICE {
   bytes       [0] OCTET STRING,
   utf8String  [1] UTF8String,
   bool        [2] BOOLEAN,
   time        [3] GeneralizedTime,
   int         [4] INTEGER,
   oid         [5] OBJECT IDENTIFIER,
   null        [6] NULL
}

SignatureBlock ::= SEQUENCE {
   sid                  SignerIdentifier,
   signatureAlgorithm   AlgorithmIdentifier,
   signatureValue       OCTET STRING
}

SignerIdentifier ::= SEQUENCE {
   keyId                [0] EXPLICIT OCTET STRING OPTIONAL,
   subjectKeyIdentifier [1] EXPLICIT SubjectPublicKeyInfo OPTIONAL,
                            -- As defined in RFC 5280
   certificate          [2] EXPLICIT Certificate OPTIONAL
                            -- As defined in RFC 5280
}

PkixEvidenceKeyCapabilities ::= SEQUENCE OF OBJECT IDENTIFIER

id-pkix-evidence OBJECT IDENTIFIER ::= { 1 2 3 999 }

id-pkix-evidence-entity-type        OBJECT IDENTIFIER ::= { id-pkix-\
                                                         evidence 0 }
id-pkix-evidence-entity-transaction OBJECT IDENTIFIER ::= { id-pkix-\
                                             evidence-entity-type 0 }
id-pkix-evidence-entity-platform    OBJECT IDENTIFIER ::= { id-pkix-\
                                             evidence-entity-type 1 }
id-pkix-evidence-entity-key         OBJECT IDENTIFIER ::= { id-pkix-\
                                             evidence-entity-type 2 }

id-pkix-evidence-attribute-type OBJECT IDENTIFIER ::= { id-pkix-\
                                                         evidence 1 }

id-pkix-evidence-attribute-transaction           OBJECT IDENTIFIER :\
                             := { id-pkix-evidence-attribute-type 0 }
id-pkix-evidence-attribute-transaction-nonce     OBJECT IDENTIFIER :\
                      := { id-pkix-evidence-attribute-transaction 0 }
id-pkix-evidence-attribute-transaction-timestamp OBJECT IDENTIFIER :\
                      := { id-pkix-evidence-attribute-transaction 1 }
id-pkix-evidence-attribute-transaction-ak-spki   OBJECT IDENTIFIER :\
                      := { id-pkix-evidence-attribute-transaction 2 }

id-pkix-evidence-attribute-platform            OBJECT IDENTIFIER ::\
                              = { id-pkix-evidence-attribute-type 1 }
id-pkix-evidence-attribute-platform-vendor     OBJECT IDENTIFIER ::\
                          = { id-pkix-evidence-attribute-platform 0 }
id-pkix-evidence-attribute-platform-oemid      OBJECT IDENTIFIER ::\
                          = { id-pkix-evidence-attribute-platform 1 }
id-pkix-evidence-attribute-platform-hwmodel    OBJECT IDENTIFIER ::\
                          = { id-pkix-evidence-attribute-platform 2 }
id-pkix-evidence-attribute-platform-hwversion  OBJECT IDENTIFIER ::\
                          = { id-pkix-evidence-attribute-platform 3 }
id-pkix-evidence-attribute-platform-hwserial   OBJECT IDENTIFIER ::\
                          = { id-pkix-evidence-attribute-platform 4 }
id-pkix-evidence-attribute-platform-swname     OBJECT IDENTIFIER ::\
                          = { id-pkix-evidence-attribute-platform 5 }
id-pkix-evidence-attribute-platform-swversion  OBJECT IDENTIFIER ::\
                          = { id-pkix-evidence-attribute-platform 6 }
id-pkix-evidence-attribute-platform-debugstat  OBJECT IDENTIFIER ::\
                          = { id-pkix-evidence-attribute-platform 7 }
id-pkix-evidence-attribute-platform-uptime     OBJECT IDENTIFIER ::\
                          = { id-pkix-evidence-attribute-platform 8 }
id-pkix-evidence-attribute-platform-bootcount  OBJECT IDENTIFIER ::\
                          = { id-pkix-evidence-attribute-platform 9 }
id-pkix-evidence-attribute-platform-usermods   OBJECT IDENTIFIER ::\
                         = { id-pkix-evidence-attribute-platform 10 }
id-pkix-evidence-attribute-platform-fipsboot   OBJECT IDENTIFIER ::\
                         = { id-pkix-evidence-attribute-platform 11 }
id-pkix-evidence-attribute-platform-fipsver    OBJECT IDENTIFIER ::\
                         = { id-pkix-evidence-attribute-platform 12 }
id-pkix-evidence-attribute-platform-fipslevel  OBJECT IDENTIFIER ::\
                         = { id-pkix-evidence-attribute-platform 13 }
id-pkix-evidence-attribute-platform-fipsmodule OBJECT IDENTIFIER ::\
                         = { id-pkix-evidence-attribute-platform 14 }


id-pkix-evidence-attribute-key                   OBJECT IDENTIFIER :\
                             := { id-pkix-evidence-attribute-type 2 }
id-pkix-evidence-attribute-key-identifier        OBJECT IDENTIFIER :\
                              := { id-pkix-evidence-attribute-key 0 }
id-pkix-evidence-attribute-key-spki              OBJECT IDENTIFIER :\
                              := { id-pkix-evidence-attribute-key 1 }
id-pkix-evidence-attribute-key-extractable       OBJECT IDENTIFIER :\
                              := { id-pkix-evidence-attribute-key 2 }
id-pkix-evidence-attribute-key-sensitive         OBJECT IDENTIFIER :\
                              := { id-pkix-evidence-attribute-key 3 }
id-pkix-evidence-attribute-key-never-extractable OBJECT IDENTIFIER :\
                              := { id-pkix-evidence-attribute-key 4 }
id-pkix-evidence-attribute-key-local             OBJECT IDENTIFIER :\
                              := { id-pkix-evidence-attribute-key 5 }
id-pkix-evidence-attribute-key-expiry            OBJECT IDENTIFIER :\
                              := { id-pkix-evidence-attribute-key 6 }
id-pkix-evidence-attribute-key-purpose           OBJECT IDENTIFIER :\
                              := { id-pkix-evidence-attribute-key 7 }


id-pkix-evidence-key-capability                  OBJECT IDENTIFIER :\
                                            := { id-pkix-evidence 2 }
id-pkix-evidence-key-capability-encrypt          OBJECT IDENTIFIER :\
                             := { id-pkix-evidence-key-capability 0 }
id-pkix-evidence-key-capability-decrypt          OBJECT IDENTIFIER :\
                             := { id-pkix-evidence-key-capability 1 }
id-pkix-evidence-key-capability-wrap             OBJECT IDENTIFIER :\
                             := { id-pkix-evidence-key-capability 2 }
id-pkix-evidence-key-capability-unwrap           OBJECT IDENTIFIER :\
                             := { id-pkix-evidence-key-capability 3 }
id-pkix-evidence-key-capability-sign             OBJECT IDENTIFIER :\
                             := { id-pkix-evidence-key-capability 4 }
id-pkix-evidence-key-capability-sign-recover     OBJECT IDENTIFIER :\
                             := { id-pkix-evidence-key-capability 5 }
id-pkix-evidence-key-capability-verify           OBJECT IDENTIFIER :\
                             := { id-pkix-evidence-key-capability 6 }
id-pkix-evidence-key-capability-verify-recover   OBJECT IDENTIFIER :\
                             := { id-pkix-evidence-key-capability 7 }
id-pkix-evidence-key-capability-derive           OBJECT IDENTIFIER :\
                             := { id-pkix-evidence-key-capability 8 }

END

&lt;CODE ENDS&gt;

</pre><a href="#section-8-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-9">
      <h2 id="name-iana-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-9-1">Please replace "RFCthis" with the RFC number assigned to this document.<a href="#section-9-1" class="pilcrow">¶</a></p>
<p id="section-9-2">The following OIDs are defined in this document and will require IANA registration under the assigned arc:<a href="#section-9-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9-3.1">
          <p id="section-9-3.1.1"><code>id-pkix-evidence</code><a href="#section-9-3.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-9-3.2">
          <p id="section-9-3.2.1"><code>id-pkix-evidence-entity-type</code><a href="#section-9-3.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-9-3.3">
          <p id="section-9-3.3.1"><code>id-pkix-evidence-entity-transaction</code><a href="#section-9-3.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-9-3.4">
          <p id="section-9-3.4.1"><code>id-pkix-evidence-entity-platform</code><a href="#section-9-3.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-9-3.5">
          <p id="section-9-3.5.1"><code>id-pkix-evidence-entity-key</code><a href="#section-9-3.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-9-3.6">
          <p id="section-9-3.6.1">Attribute OIDs referenced in the Platform, Key, and Transaction tables (e.g., <code>id-pkix-evidence-attribute-platform-*</code>, <code>id-pkix-evidence-attribute-key-*</code>, <code>id-pkix-evidence-attribute-transaction-*</code>).<a href="#section-9-3.6.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="security-considerations">
<section id="section-10">
      <h2 id="name-security-considerations">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<div id="sec-cons-verifier">
<section id="section-10.1">
        <h3 id="name-policies-relating-to-verifi">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-policies-relating-to-verifi" class="section-name selfRef">Policies relating to Verifier and Relying Party</a>
        </h3>
<p id="section-10.1-1">The generation of PKIX Evidence by an HSM is to provide sufficient information to
a Verifier and a Relying Party to appraise the Target Environment (the HSM) and make
decisions based on this appraisal.<a href="#section-10.1-1" class="pilcrow">¶</a></p>
<p id="section-10.1-2">The Appraisal Policy associated with the Verifier influences the generation of the Attestation
Results. Those results, in turn, are consumed by the Relying Party to make decisions about
the HSM, which might be based on a set of rules and policies. Therefore, the interpretation of
PKIX Evidence may greatly influence the outcome of some decisions.<a href="#section-10.1-2" class="pilcrow">¶</a></p>
<p id="section-10.1-3">A Verifier <span class="bcp14">MAY</span> reject a PKIX Evidence if it lacks required attributes per the Verifier's
appraisal policy. For example, if a Relying Party mandates a FIPS-certified device,
it <span class="bcp14">SHOULD</span> reject Evidence lacking sufficient information to verify the device's FIPS
certification status.<a href="#section-10.1-3" class="pilcrow">¶</a></p>
<p id="section-10.1-4">If a Verifier encounters an attribute with an unrecognized attribute type, it <span class="bcp14">MAY</span> ignore it and
treat it as extraneous information. By ignoring an attribute, the Verifier may accept PKIX Evidence
that would be deemed malformed to a Verifier with different policies. However, this approach
fosters a higher likelihood of achieving interoperability.<a href="#section-10.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-cons-simple">
<section id="section-10.2">
        <h3 id="name-simple-to-implement">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-simple-to-implement" class="section-name selfRef">Simple to Implement</a>
        </h3>
<p id="section-10.2-1">The nature of attestation requires the Attestation Service to be implemented in an extremely
privileged position within the HSM so that it can collect measurements of both the hardware
environment and the user keys being attested. For many HSM architectures, this will
place the Attestation Service inside the "security kernel" and potentially subject to FIPS 140-3
or Common Criteria validation and change control. For both security and compliance reasons
there is incentive for the generation and parsing logic to be simple and easy to implement
correctly. Additionally, when the data formats contained in this specification are parsed
within an HSM boundary -- that would be parsing a request entity, or parsing an attestation
produced by a different HSM -- implementers <span class="bcp14">SHOULD</span> opt for simple logic that rejects any
data that does not match the expected format, instead of attempting to be flexible.<a href="#section-10.2-1" class="pilcrow">¶</a></p>
<p id="section-10.2-2">In particular, the Attestation Service <span class="bcp14">SHOULD</span> generate the PKIX Evidence from scratch and
avoid copying any content from the request. The Attestation Service <span class="bcp14">MUST</span> generate PKIX Evidence
only from attributes and values that are observed by the service.<a href="#section-10.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-detached-sigs">
<section id="section-10.3">
        <h3 id="name-detached-signatures">
<a href="#section-10.3" class="section-number selfRef">10.3. </a><a href="#name-detached-signatures" class="section-name selfRef">Detached Signatures</a>
        </h3>
<p id="section-10.3-1">The construction of the Evidence structure (<code>PkixEvidence</code>) includes a collection of signature
blocks that are not explicitly bound to the content. This approach was influenced by the following
motivations:<a href="#section-10.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.3-2.1">
            <p id="section-10.3-2.1.1">Multiple simultaneous signature blocks are desired to support hybrid environments where
multiple keys using different cryptographic algorithms are required to support appraisal
policies.<a href="#section-10.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.3-2.2">
            <p id="section-10.3-2.2.1">Provide the ability to add counter-signatures without having to define an envelop scheme.<a href="#section-10.3-2.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-10.3-3">The concept of counter-signatures is important for environments where a number of heterogeneous
devices are deployed. In those environments, it is possible for a trusted actor, intermediary between
the Attester and the Verifier, to validate the original signature(s) and apply its own afterwards.<a href="#section-10.3-3" class="pilcrow">¶</a></p>
<p id="section-10.3-4">The ability to add signature blocks to the Evidence after the original generation by the Attester leads
to the unfortunate situation where signature blocks can also be removed without leaving any trace.
Therefore, the signature blocks can be deemed as "detachable" or "stapled".<a href="#section-10.3-4" class="pilcrow">¶</a></p>
<p id="section-10.3-5">Manipulation of the Evidence after it was generated can lead to undesired outcomes at the Verifier.<a href="#section-10.3-5" class="pilcrow">¶</a></p>
<p id="section-10.3-6">Therefore, Verifiers <span class="bcp14">MUST</span> be designed to accept Evidence based on their appraisal policies, regardless
of the presence or absence of certain signature(s). Consequently, Verifiers <span class="bcp14">MUST NOT</span> make any inferences
based on a missing signature, as the signature could have been removed in transit.<a href="#section-10.3-6" class="pilcrow">¶</a></p>
<p id="section-10.3-7">This specification provides the transaction attribute "ak-spki" to effectively bind the content with
the signature blocks that were generated by the Attester. When this attribute is provided, it reports
the SPKI of one of the attestation keys used by the Attester to produce the Evidence. This attribute
is repeated for each of the attestation keys used by the Attester.<a href="#section-10.3-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-cons-privacy">
<section id="section-10.4">
        <h3 id="name-privacy">
<a href="#section-10.4" class="section-number selfRef">10.4. </a><a href="#name-privacy" class="section-name selfRef">Privacy</a>
        </h3>
<p id="section-10.4-1">Some HSMs have the capacity of supporting cryptographic keys controlled by separate entities referred to as "tenants", and when the HSM is used in that mode
it is referred to as a multi-tenant configuration.<a href="#section-10.4-1" class="pilcrow">¶</a></p>
<p id="section-10.4-2">For example, an enterprise-grade HSM in a large multi-tenant cloud service could host TLS keys fronting multiple un-related web domains. Providing Evidence for
attesting attributes of any one of the keys would involve a Presenter that could potentially access any of the hosted keys.
In such a case, privacy violations could occur if the Presenter was to disclose information that does not relate to the subject key.<a href="#section-10.4-2" class="pilcrow">¶</a></p>
<p id="section-10.4-3">Implementers <span class="bcp14">SHOULD</span> be careful to avoid over-disclosure of information, for example by authenticating the Presenter as described in <a href="#sec-cons-auth-the-presenter" class="auto internal xref">Section 10.5</a> and only returning results for keys and environments for which it is authorized.
In absence of an existing mechanism for authenticating and authorizing administrative connections to the HSM, the attestation request <span class="bcp14">MAY</span> be authenticated by embedding the TbsPkixEvidence of the request inside a PkixEvidence signed with a certificate belonging to the Presenter.<a href="#section-10.4-3" class="pilcrow">¶</a></p>
<p id="section-10.4-4">Furthermore, enterprise and cloud-services grade HSMs <span class="bcp14">SHOULD</span> support the full set of attestation request functionality described in <a href="#sec-reqs" class="auto internal xref">Section 7</a> so that Presenters can fine-tune the content of a PKIX Evidence such that it is appropriate for the intended Verifier.<a href="#section-10.4-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-cons-auth-the-presenter">
<section id="section-10.5">
        <h3 id="name-authenticating-and-authoriz">
<a href="#section-10.5" class="section-number selfRef">10.5. </a><a href="#name-authenticating-and-authoriz" class="section-name selfRef">Authenticating and Authorizing the Presenter</a>
        </h3>
<p id="section-10.5-1">The Presenter represents a privileged role within the architecture of this specification as it gets to learn about the existence of user keys and their protection properties, as well as details of the platform.
The Presenter is in the position of deciding how much information to disclose to the Verifier, and to request a suitably redacted Evidence from the HSM.<a href="#section-10.5-1" class="pilcrow">¶</a></p>
<p id="section-10.5-2">For personal cryptographic tokens it might be appropriate for the attestation request interface to be un-authenticated. However, for enterprise and cloud-services grade HSMs the Presenter <span class="bcp14">SHOULD</span> be authenticated using the HSM's native authentication mechanism. The details are HSM-specific and are thus left up to the implementer. However, it is <span class="bcp14">RECOMMENDED</span> to implement an authorization framework similar to the following.<a href="#section-10.5-2" class="pilcrow">¶</a></p>
<p id="section-10.5-3">A Presenter <span class="bcp14">SHOULD</span> be allowed to request Evidence for any user keys which it is allowed to use.
For example, a TLS application that is correctly authenticated to the HSM in order to use its TLS keys <span class="bcp14">SHOULD</span> be able to request Evidence of those same keys without needing to perform any additional authentication or requiring any additional roles or permissions.
HSMs that wish to allow a Presenter to request Evidence of keys which is not allowed to use, for example for the purposes of displaying HSM status information on an administrative console or UI, <span class="bcp14">SHOULD</span> have a "Attestation Requester" role or permission and <span class="bcp14">SHOULD</span> enforce the HSM's native access controls such that the Presenter can only retrieve Evidence for keys for which it has read access.<a href="#section-10.5-3" class="pilcrow">¶</a></p>
<p id="section-10.5-4">In the absence of an existing mechanism for authenticating and authorizing administrative connections to the HSM, the attestation request <span class="bcp14">MAY</span> be authenticated by embedding the <code>TbsPkixEvidence</code> of the request inside a <code>PkixEvidence</code> signed with a certificate belonging to the Presenter.<a href="#section-10.5-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="proof-of-possession-of-user-keys">
<section id="section-10.6">
        <h3 id="name-proof-of-possession-of-user">
<a href="#section-10.6" class="section-number selfRef">10.6. </a><a href="#name-proof-of-possession-of-user" class="section-name selfRef">Proof-of-Possession of User Keys</a>
        </h3>
<p id="section-10.6-1">With asymmetric keys within a Public Key Infrastructure (PKI) it is common to require a key holder to prove that they are in control of the private key by using it. This is called "proof-of-possession (PoP)". This specification intentionally does not provide a mechanism for PoP of user keys and relies on the Presenter, Verifier, and Relying Party trusting the Attester to correctly report the cryptographic keys that it is holding.<a href="#section-10.6-1" class="pilcrow">¶</a></p>
<p id="section-10.6-2">It would be trivial to add a PoP Key Attribute that uses the attested user key to sign over, for example, the Transaction Entity. However, this approach leads to undesired consequences, as explained
below.<a href="#section-10.6-2" class="pilcrow">¶</a></p>
<p id="section-10.6-3">First, a user key intended for TLS, as an example, <span class="bcp14">SHOULD</span> only be used with the TLS protocol. Introducing a signature oracle whereby the TLS application key is used to sign PKIX Evidence could lead to cross-protocol attacks.
In this example, an attacker could submit a "nonce" value which is in fact not random but is crafted in such a way as to appear as a valid message in some other protocol context or exploit some other weakness in the signature algorithm.<a href="#section-10.6-3" class="pilcrow">¶</a></p>
<p id="section-10.6-4">Second, the Presenter who has connected to the HSM to request PKIX Evidence may have permissions to view the requested application keys but not permission to use them, as in the case where the Presenter is an administrative UI displaying HSM status information to an systems administrator or auditor.<a href="#section-10.6-4" class="pilcrow">¶</a></p>
<p id="section-10.6-5">Requiring the Attestation Service to use the attested application keys could, in some architectures, require the Attestation Service to resolve complex access control logic and handle complex error conditions for each requested key, which violates the "simple to implement" design principle outlined in <a href="#sec-cons-simple" class="auto internal xref">Section 10.2</a>. More discussion of authenticating the Presenter can be found in <a href="#sec-cons-auth-the-presenter" class="auto internal xref">Section 10.5</a>.<a href="#section-10.6-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-cons-hsm-timestamps">
<section id="section-10.7">
        <h3 id="name-timestamps-and-hsms">
<a href="#section-10.7" class="section-number selfRef">10.7. </a><a href="#name-timestamps-and-hsms" class="section-name selfRef">Timestamps and HSMs</a>
        </h3>
<p id="section-10.7-1">It is common for HSMs to have an inaccurate system clock. Most clocks have a natural drift and must be corrected periodically. HSMs, like any other devices,
are subject to these issues.<a href="#section-10.7-1" class="pilcrow">¶</a></p>
<p id="section-10.7-2">There are many situations where HSMs can not naturally correct their internal system clocks. For example, consider a HSM hosting a trust anchor and usually kept offline
and booted up infrequently in a network without a reliable time management service. Another example is a smart card which boots up only when held against an NFC reader.<a href="#section-10.7-2" class="pilcrow">¶</a></p>
<p id="section-10.7-3">When a timestamp generated from a HSM is evaluated, the expected behavior of the system clock <span class="bcp14">SHOULD</span> be considered.<a href="#section-10.7-3" class="pilcrow">¶</a></p>
<p id="section-10.7-4">More specifically, the timestamp <span class="bcp14">SHOULD NOT</span> be relied on for establishing the freshness of the Evidence generated by a HSM. Instead, Verifiers <span class="bcp14">SHOULD</span> rely on other provisions
such as the "nonce" attribute of the "transaction" entity, introduced this specification.<a href="#section-10.7-4" class="pilcrow">¶</a></p>
<p id="section-10.7-5">Furthermore, the internal system clock of HSMs <span class="bcp14">SHOULD NOT</span> be relied on to enforce expiration policies.<a href="#section-10.7-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-combined-references">
<section id="section-11">
      <h2 id="name-references">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-11.1">
        <h3 id="name-normative-references">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="FIPS140-3">[FIPS140-3]</dt>
        <dd>
<span class="refAuthor">NIST, Information Technology Laboratory</span>, <span class="refTitle">"Security Requirements for Cryptographic Modules"</span>, <span class="seriesInfo">FIPS 140-3</span>, <span>n.d.</span>, <span>&lt;<a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.140-3.pdf">https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.140-3.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.jpfiset-lamps-attestationkey-eku">[I-D.jpfiset-lamps-attestationkey-eku]</dt>
        <dd>
<span class="refAuthor">Fiset, J.</span>, <span class="refAuthor">Ounsworth, M.</span>, <span class="refAuthor">Tschofenig, H.</span>, and <span class="refAuthor">M. Wiseman</span>, <span class="refTitle">"Extended Key Usage (EKU) for X.509 Certificates associated with Attestation Keys"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-jpfiset-lamps-attestationkey-eku-01</span>, <time datetime="2025-10-20" class="refDate">20 October 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-jpfiset-lamps-attestationkey-eku-01">https://datatracker.ietf.org/doc/html/draft-jpfiset-lamps-attestationkey-eku-01</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="PKCS11">[PKCS11]</dt>
        <dd>
<span class="refAuthor">Bong, D.</span>, <span class="refAuthor">Cox, T.</span>, and <span class="refAuthor">OASIS PKCS 11 TC</span>, <span class="refTitle">"PKCS #11 Specification Version 3.1"</span>, <time datetime="2022-08-11" class="refDate">11 August 2022</time>, <span>&lt;<a href="https://docs.oasis-open.org/pkcs11/pkcs11-spec/v3.1/cs01/pkcs11-spec-v3.1-cs01.html">https://docs.oasis-open.org/pkcs11/pkcs11-spec/v3.1/cs01/pkcs11-spec-v3.1-cs01.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4648">[RFC4648]</dt>
        <dd>
<span class="refAuthor">Josefsson, S.</span>, <span class="refTitle">"The Base16, Base32, and Base64 Data Encodings"</span>, <span class="seriesInfo">RFC 4648</span>, <span class="seriesInfo">DOI 10.17487/RFC4648</span>, <time datetime="2006-10" class="refDate">October 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4648">https://www.rfc-editor.org/rfc/rfc4648</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5280">[RFC5280]</dt>
        <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Boeyen, S.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time datetime="2008-05" class="refDate">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5280">https://www.rfc-editor.org/rfc/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9334">[RFC9334]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Thaler, D.</span>, <span class="refAuthor">Richardson, M.</span>, <span class="refAuthor">Smith, N.</span>, and <span class="refAuthor">W. Pan</span>, <span class="refTitle">"Remote ATtestation procedureS (RATS) Architecture"</span>, <span class="seriesInfo">RFC 9334</span>, <span class="seriesInfo">DOI 10.17487/RFC9334</span>, <time datetime="2023-01" class="refDate">January 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9334">https://www.rfc-editor.org/rfc/rfc9334</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9711">[RFC9711]</dt>
        <dd>
<span class="refAuthor">Lundblade, L.</span>, <span class="refAuthor">Mandyam, G.</span>, <span class="refAuthor">O'Donoghue, J.</span>, and <span class="refAuthor">C. Wallace</span>, <span class="refTitle">"The Entity Attestation Token (EAT)"</span>, <span class="seriesInfo">RFC 9711</span>, <span class="seriesInfo">DOI 10.17487/RFC9711</span>, <time datetime="2025-04" class="refDate">April 2025</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9711">https://www.rfc-editor.org/rfc/rfc9711</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="X.690">[X.690]</dt>
        <dd>
<span class="refAuthor">ITU-T</span>, <span class="refTitle">"Information technology -- ASN.1 encoding rules: Specification of Basic Encoding Rules (BER), Canonical Encoding Rules (CER) and Distinguished Encoding Rules (DER)"</span>, <span class="seriesInfo">ITU-T Recommendation X.690</span>, <span class="seriesInfo">ISO/IEC 8825-1:2021</span>, <time datetime="2021-02" class="refDate">February 2021</time>, <span>&lt;<a href="https://www.itu.int/rec/T-REC-X.690">https://www.itu.int/rec/T-REC-X.690</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="X680">[X680]</dt>
        <dd>
<span class="refAuthor">ITU-T</span>, <span class="refTitle">"Information technology — ASN.1: Specification of basic notation"</span>, <span>n.d.</span>, <span>&lt;<a href="https://www.itu.int/rec/T-REC-X.680">https://www.itu.int/rec/T-REC-X.680</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="X690">[X690]</dt>
      <dd>
<span class="refAuthor">ITU-T</span>, <span class="refTitle">"Information technology — ASN.1 encoding rules: BER, CER, DER"</span>, <span>n.d.</span>, <span>&lt;<a href="https://www.itu.int/rec/T-REC-X.690">https://www.itu.int/rec/T-REC-X.690</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-11.2">
        <h3 id="name-informative-references">
<a href="#section-11.2" class="section-number selfRef">11.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="CNSA2.0">[CNSA2.0]</dt>
        <dd>
<span class="refAuthor">National Security Agency</span>, <span class="refTitle">"Commercial National Security Algorithm Suite 2.0"</span>, <span>n.d.</span>, <span>&lt;<a href="https://media.defense.gov/2022/Sep/07/2003071834/-1/-1/0/CSA_CNSA_2.0_ALGORITHMS_.PDF">https://media.defense.gov/2022/Sep/07/2003071834/-1/-1/0/CSA_CNSA_2.0_ALGORITHMS_.PDF</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="CSBR">[CSBR]</dt>
        <dd>
<span class="refAuthor">CA/Browser Forum</span>, <span class="refTitle">"Baseline Requirements for the Issuance and Management of Publicly-Trusted Code Signing Certificates Version 3.8.0"</span>, <span>n.d.</span>, <span>&lt;<a href="https://cabforum.org/working-groups/code-signing/documents/">https://cabforum.org/working-groups/code-signing/documents/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.fossati-tls-attestation">[I-D.fossati-tls-attestation]</dt>
        <dd>
<span class="refAuthor">Tschofenig, H.</span>, <span class="refAuthor">Sheffer, Y.</span>, <span class="refAuthor">Howard, P.</span>, <span class="refAuthor">Mihalcea, I.</span>, <span class="refAuthor">Deshpande, Y.</span>, <span class="refAuthor">Niemi, A.</span>, and <span class="refAuthor">T. Fossati</span>, <span class="refTitle">"Using Attestation in Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-fossati-tls-attestation-09</span>, <time datetime="2025-04-30" class="refDate">30 April 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-fossati-tls-attestation-09">https://datatracker.ietf.org/doc/html/draft-fossati-tls-attestation-09</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-lamps-csr-attestation">[I-D.ietf-lamps-csr-attestation]</dt>
        <dd>
<span class="refAuthor">Ounsworth, M.</span>, <span class="refAuthor">Tschofenig, H.</span>, <span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Wiseman, M.</span>, and <span class="refAuthor">N. Smith</span>, <span class="refTitle">"Use of Remote Attestation with Certification Signing Requests"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-lamps-csr-attestation-21</span>, <time datetime="2025-10-05" class="refDate">5 October 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-lamps-csr-attestation-21">https://datatracker.ietf.org/doc/html/draft-ietf-lamps-csr-attestation-21</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-rats-msg-wrap">[I-D.ietf-rats-msg-wrap]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Smith, N.</span>, <span class="refAuthor">Fossati, T.</span>, <span class="refAuthor">Tschofenig, H.</span>, and <span class="refAuthor">D. Glaze</span>, <span class="refTitle">"RATS Conceptual Messages Wrapper (CMW)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-rats-msg-wrap-23</span>, <time datetime="2025-12-11" class="refDate">11 December 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-msg-wrap-23">https://datatracker.ietf.org/doc/html/draft-ietf-rats-msg-wrap-23</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2986">[RFC2986]</dt>
        <dd>
<span class="refAuthor">Nystrom, M.</span> and <span class="refAuthor">B. Kaliski</span>, <span class="refTitle">"PKCS #10: Certification Request Syntax Specification Version 1.7"</span>, <span class="seriesInfo">RFC 2986</span>, <span class="seriesInfo">DOI 10.17487/RFC2986</span>, <time datetime="2000-11" class="refDate">November 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2986">https://www.rfc-editor.org/rfc/rfc2986</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4211">[RFC4211]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate Request Message Format (CRMF)"</span>, <span class="seriesInfo">RFC 4211</span>, <span class="seriesInfo">DOI 10.17487/RFC4211</span>, <time datetime="2005-09" class="refDate">September 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4211">https://www.rfc-editor.org/rfc/rfc4211</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6024">[RFC6024]</dt>
        <dd>
<span class="refAuthor">Reddy, R.</span> and <span class="refAuthor">C. Wallace</span>, <span class="refTitle">"Trust Anchor Management Requirements"</span>, <span class="seriesInfo">RFC 6024</span>, <span class="seriesInfo">DOI 10.17487/RFC6024</span>, <time datetime="2010-10" class="refDate">October 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6024">https://www.rfc-editor.org/rfc/rfc6024</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9019">[RFC9019]</dt>
      <dd>
<span class="refAuthor">Moran, B.</span>, <span class="refAuthor">Tschofenig, H.</span>, <span class="refAuthor">Brown, D.</span>, and <span class="refAuthor">M. Meriac</span>, <span class="refTitle">"A Firmware Update Architecture for Internet of Things"</span>, <span class="seriesInfo">RFC 9019</span>, <span class="seriesInfo">DOI 10.17487/RFC9019</span>, <time datetime="2021-04" class="refDate">April 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9019">https://www.rfc-editor.org/rfc/rfc9019</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="samples">
<section id="appendix-A">
      <h2 id="name-samples">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-samples" class="section-name selfRef">Samples</a>
      </h2>
<p id="appendix-A-1">A reference implementation of this specification can be found at https://github.com/ietf-rats-wg/key-attestation<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<p id="appendix-A-2">It produces the following sample Evidence:<a href="#appendix-A-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A-3">
<pre>
=============== NOTE: '\' line wrapping per RFC 8792 ================

PkixAttestation:
 tbs=TbsPkixAttestation:
  version=2
  reportedEntities=SequenceOf:
   ReportedEntity:
    entityType=1.2.3.999.0.0
    reportedAttributes=SequenceOf:
     ReportedAttribute:
      attributeType=1.2.3.999.1.0.0
      value=AttributeValue:
       bytes=0102030405


   ReportedEntity:
    entityType=1.2.3.999.0.1
    reportedAttributes=SequenceOf:
     ReportedAttribute:
      attributeType=1.2.3.999.1.1.1
      value=AttributeValue:
       utf8String=HSM-123

     ReportedAttribute:
      attributeType=1.2.3.999.1.1.2
      value=AttributeValue:
       bool=True

     ReportedAttribute:
      attributeType=1.2.3.999.1.1.3
      value=AttributeValue:
       utf8String=Model ABC

     ReportedAttribute:
      attributeType=1.2.3.999.1.1.4
      value=AttributeValue:
       utf8String=3.1.9


   ReportedEntity:
    entityType=1.2.3.999.0.2
    reportedAttributes=SequenceOf:
     ReportedAttribute:
      attributeType=1.2.3.999.1.2.0
      value=AttributeValue:
       utf8String=26d765d8-1afd-4dfb-a290-cf867ddecfa1

     ReportedAttribute:
      attributeType=1.2.3.999.1.2.3
      value=AttributeValue:
       bool=False

     ReportedAttribute:
      attributeType=1.2.3.999.1.2.1
      value=AttributeValue:
       bytes=\
0x3059301306072a8648ce3d020106082a8648ce3d03010703420004422548f88fb7\
82ffb5eca3744452c72a1e558fbd6f73be5e48e93232cc45c5b16c4cd10c4cb8d5b8\
                     a17139e94882c8992572993425f41419ab7e90a42a494272


   ReportedEntity:
    entityType=1.2.3.999.0.2
    reportedAttributes=SequenceOf:
     ReportedAttribute:
      attributeType=1.2.3.999.1.2.0
      value=AttributeValue:
       utf8String=49a96ace-e39a-4fd2-bec1-13165a99621c

     ReportedAttribute:
      attributeType=1.2.3.999.1.2.3
      value=AttributeValue:
       bool=True

     ReportedAttribute:
      attributeType=1.2.3.999.1.2.1
      value=AttributeValue:
       bytes=\
0x3059301306072a8648ce3d020106082a8648ce3d03010703420004422548f88fb7\
82ffb5eca3744452c72a1e558fbd6f73be5e48e93232cc45c5b16c4cd10c4cb8d5b8\
                     a17139e94882c8992572993425f41419ab7e90a42a494272


   ReportedEntity:
    entityType=1.2.3.888.0
    reportedAttributes=SequenceOf:
     ReportedAttribute:
      attributeType=1.2.3.888.1
      value=AttributeValue:
       utf8String=partition 1




 signatures=SequenceOf:
  SignatureBlock:
   certChain=SequenceOf:
    Certificate:
     tbsCertificate=TBSCertificate:
      version=v3
      serialNumber=510501933685942792810365453374472870755160518925
      signature=AlgorithmIdentifier:
       algorithm=1.2.840.113549.1.1.11
       parameters=0x0500

      issuer=Name:
       rdnSequence=RDNSequence:
        RelativeDistinguishedName:
         AttributeTypeAndValue:
          type=2.5.4.10
          value=0x0c0449455446
        RelativeDistinguishedName:
         AttributeTypeAndValue:
          type=2.5.4.11
          value=0x0c0452415453
        RelativeDistinguishedName:
         AttributeTypeAndValue:
          type=2.5.4.3
          value=0x0c06414b20525341


      validity=Validity:
       notBefore=Time:
        utcTime=250117171303Z

       notAfter=Time:
        generalTime=20520604171303Z


      subject=Name:
       rdnSequence=RDNSequence:
        RelativeDistinguishedName:
         AttributeTypeAndValue:
          type=2.5.4.10
          value=0x0c0449455446
        RelativeDistinguishedName:
         AttributeTypeAndValue:
          type=2.5.4.11
          value=0x0c0452415453
        RelativeDistinguishedName:
         AttributeTypeAndValue:
          type=2.5.4.3
          value=0x0c06414b20525341


      subjectPublicKeyInfo=SubjectPublicKeyInfo:
       algorithm=AlgorithmIdentifier:
        algorithm=1.2.840.113549.1.1.1
        parameters=0x0500

       subjectPublicKey=\
31795268810366627125468059984427145931784542919710733587190808152893\
60654221420809632888307722560713639336279560999760196831203900125133\
94283491012035327260476464503011428823183377093983165744076471996900\
00689245113739552615279534528145776090813314822312012607567736073057\
93682071373309092884909267211093730030075556179780800043813483945804\
36738524537229696496092020939452353934949121386913422195643653009653\
87743701570507112064401758218314760153081271981340812350365663466513\
62085332653425242470699284103365281746135463231612931259782554282056\
96678423183426464574470371256093994768443364562065834165394264792211\
                               64971369788464727307915820767918489601

      extensions=Extensions:
       Extension:
        extnID=2.5.29.14
        critical=False
        extnValue=0x04148919595e0ef169f5cbbd47e134fce298cc693091
       Extension:
        extnID=2.5.29.35
        critical=False
        extnValue=0x301680148919595e0ef169f5cbbd47e134fce298cc693091
       Extension:
        extnID=2.5.29.19
        critical=True
        extnValue=0x30030101ff


     signatureAlgorithm=AlgorithmIdentifier:
      algorithm=1.2.840.113549.1.1.11
      parameters=0x0500

     signature=\
12977775424631768289542539102653382982431795551146145281750189553757\
94098257281326442898298599774059587807702785399451577511675203096385\
84696515487658087752698572711677485127950179162848670513028844653157\
51010913658016640170608413935780119349866986170148033301955753116984\
04127127390775654478023156464686042499902099074552338362298011520044\
62601031731035006478387581976102385523490530645254202408261935533953\
78873725256584269666918504793674497748455574822238022085054752185687\
44080765533772482185333268815846037955490610541772066517564837183282\
59395770398747304427903377260041058781683759981231103319933488336293\
                                                                25492

   signatureAlgorithm=AlgorithmIdentifier:
    algorithm=1.2.840.113549.1.1.10
    parameters=RSASSA_PSS_params:
     hashAlgorithm=AlgorithmIdentifier:
      algorithm=2.16.840.1.101.3.4.2.1

     maskGenAlgorithm=AlgorithmIdentifier:
      algorithm=1.2.840.113549.1.1.8

     saltLength=20
     trailerField=1


   signatureValue=\
0xab7fd2b0f854daa4e867fd16955cd3b9910e93b70c7403cfa8077f04193909d14e\
c6bed859b67476c84cc2c28842b9a087d5c39e11ca95f6961d272d97297cb6ed3c06\
2717696b032f4bf1f0f41ac20ae9706a8a4c17845ae2512950774173737010d6692c\
b726d1ab3a022092efcf27f0dd875b62e4df546814186f9e744cc34cf0778c877c57\
1d006be094aa683a5f66d6816d22dba104334163020c62d81903c41d353eaba94212\
47fc354fd3288a01921d93014100960324c3122feebfffc1007c83e98136e1b1fca1\
15835b9e67fa9056f290208fb99e1c8144839a5e13ccb1217dceeecc253fc7785bc8\
                               308382e052ffb867b40a0cd593176ed6ddc7b0
  SignatureBlock:
   certChain=SequenceOf:
    Certificate:
     tbsCertificate=TBSCertificate:
      version=v3
      serialNumber=43752118382009037811618748949928339462896457144
      signature=AlgorithmIdentifier:
       algorithm=1.2.840.10045.4.3.2

      issuer=Name:
       rdnSequence=RDNSequence:
        RelativeDistinguishedName:
         AttributeTypeAndValue:
          type=2.5.4.10
          value=0x0c0449455446
        RelativeDistinguishedName:
         AttributeTypeAndValue:
          type=2.5.4.11
          value=0x0c0452415453
        RelativeDistinguishedName:
         AttributeTypeAndValue:
          type=2.5.4.3
          value=0x0c07414b2050323536


      validity=Validity:
       notBefore=Time:
        utcTime=250117171428Z

       notAfter=Time:
        generalTime=20520604171428Z


      subject=Name:
       rdnSequence=RDNSequence:
        RelativeDistinguishedName:
         AttributeTypeAndValue:
          type=2.5.4.10
          value=0x0c0449455446
        RelativeDistinguishedName:
         AttributeTypeAndValue:
          type=2.5.4.11
          value=0x0c0452415453
        RelativeDistinguishedName:
         AttributeTypeAndValue:
          type=2.5.4.3
          value=0x0c07414b2050323536


      subjectPublicKeyInfo=SubjectPublicKeyInfo:
       algorithm=AlgorithmIdentifier:
        algorithm=1.2.840.10045.2.1
        parameters=0x06082a8648ce3d030107

       subjectPublicKey=\
57095560233504924588952816185508037812996307929249104847846164660564\
88839712339087758567046283628572504126189755002031148112756265577433\
                                                  3675293173915140722

      extensions=Extensions:
       Extension:
        extnID=2.5.29.14
        critical=False
        extnValue=0x04145b70a79817f79ff637d2f7e3dc446c2109d7bbd4
       Extension:
        extnID=2.5.29.35
        critical=False
        extnValue=0x301680145b70a79817f79ff637d2f7e3dc446c2109d7bbd4
       Extension:
        extnID=2.5.29.19
        critical=True
        extnValue=0x30030101ff


     signatureAlgorithm=AlgorithmIdentifier:
      algorithm=1.2.840.10045.4.3.2

     signature=\
18216751979714603574557504315480141511553297913673112867639918069266\
48218048839904015520407896430131032024244860880583649829667093244967\
                                  82518079519267269438816178719668437

   signatureAlgorithm=AlgorithmIdentifier:
    algorithm=1.2.840.10045.2.1
    parameters=0x06082a8648ce3d030107

   signatureValue=\
0x3046022100e416af2483667e73345ee297e563cf1639e41ab9bdcd01f98872fddb\
101e779d022100d06c6e1054292640eea1873230a399af0936760cbfc8023a8a2874\
                                                           f9c5fc5ba8



DER Base64:
MIIIszCCAgsCAQIwggIEMCEGBioDh2cAADAXMBUGByoDh2cBAAAECjAxMDIwMzA0MDUw\
VAYGKgOHZwABMEowEgYHKgOHZwEBAQwHSFNNLTEyMzAMBgcqA4dnAQECAQH/\
MBQGByoDh2cBAQMMCU1vZGVsIEFCQzAQBgcqA4dnAQEEDAUzLjEuOTCBsgYGKgOHZwAC\
MIGnMC8GByoDh2cBAgAMJDI2ZDc2NWQ4LTFhZmQtNGRmYi1hMjkwLWNmODY3ZGRlY2Zh\
MTAMBgcqA4dnAQIDAQEAMGYGByoDh2cBAgEEWzBZMBMGByqGSM49AgEGCCqGSM49AwEH\
A0IABEIlSPiPt4L/teyjdERSxyoeVY+9b3O+\
XkjpMjLMRcWxbEzRDEy41bihcTnpSILImSVymTQl9BQZq36QpCpJQnIwgbIGBioDh2cA\
AjCBpzAvBgcqA4dnAQIADCQ0OWE5NmFjZS1lMzlhLTRmZDItYmVjMS0xMzE2NWE5OTYy\
MWMwDAYHKgOHZwECAwEB/\
zBmBgcqA4dnAQIBBFswWTATBgcqhkjOPQIBBggqhkjOPQMBBwNCAARCJUj4j7eC/\
7Xso3REUscqHlWPvW9zvl5I6TIyzEXFsWxM0QxMuNW4oXE56UiCyJklcpk0JfQUGat+\
kKQqSUJyMB8GBSoDhngAMBYwFAYFKgOGeAEMC3BhcnRpdGlvbiAxMIIGoDCCBHowggNF\
MIIDQTCCAimgAwIBAgIUWWuyy9RGarWD+\
k6k4ZswYmQ7cQ0wDQYJKoZIhvcNAQELBQAwLzENMAsGA1UECgwESUVURjENMAsGA1UEC\
wwEUkFUUzEPMA0GA1UEAwwGQUsgUlNBMCAXDTI1MDExNzE3MTMwM1oYDzIwNTIwNjA0M\
TcxMzAzWjAvMQ0wCwYDVQQKDARJRVRGMQ0wCwYDVQQLDARSQVRTMQ8wDQYDVQQDDAZBS\
yBSU0EwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCw+\
egZQ6eumJKq3hfKfED4dE/tL4FI5sjqont9ABVI+\
1GSqyi1bFBgsRjM0THllIdMbKmJtWwnKW8J+5OgNN8y6Xxv8JmM/\
Y5vQt2lis0fqXmG8UTz0VTWdlAXXmhUs6lSADvAaIe4RVrCsZ97L3ZQTryY7JRVcbB4k\
hUN3Gp0yg+801SXzoFTTa+UGIRLE66jH51aa5VXu99hnv1OiH8tQrjdi8mH6uG/\
icq4XuIeNWMF32wHqIOOPvQcWV3M5D2vxJEj702Ku6k9OQXkAo17qRSEonWW4HtLbtmS\
8He1JNPc/n3dVUm+\
fM6NoDXPoLP7j55G9zKyqGtGAWXAj1MTAgMBAAGjUzBRMB0GA1UdDgQWBBSJGVleDvFp\
9cu9R+E0/OKYzGkwkTAfBgNVHSMEGDAWgBSJGVleDvFp9cu9R+E0/\
OKYzGkwkTAPBgNVHRMBAf8EBTADAQH/\
MA0GCSqGSIb3DQEBCwUAA4IBAQBmzcTIPYhVNtMdrOb9ee9qYADlTuQl1y1mdrDPcC+\
zmwZuwKLJu89hvxmFdDrVNc6QsNKnH0fWtMZxU5UQTrqW2Wf0jLY3bjfJkCmTQahOK8X\
D3oQqfXVKCe+MGFUSh71BUXc4FIQzMJ6phG+5qiCqsD9BL/gFXf4ao+BI4SQhVWi6FR+\
JOBMxd91DYDyYr6NfddAbzaW7iDoVEWR1pvQAZbycWfv1KIY6ne2yQ0dSedOqIE9Odjq\
i2QkW4kD7qXRLYKcMPqe1SPao2xoS2Kz8SIdoLInLu7Cb3QC7n/\
oEbiK4JIVD29giMpudJ8gbBLLjwDrCls0yA+ng8n/\
wkki0MCsGCSqGSIb3DQEBCjAeoA0wCwYJYIZIAWUDBAIBoQ0wCwYJKoZIhvcNAQEIBII\
BAKt/0rD4VNqk6Gf9FpVc07mRDpO3DHQDz6gHfwQZOQnRTsa+\
2Fm2dHbITMLCiEK5oIfVw54RypX2lh0nLZcpfLbtPAYnF2lrAy9L8fD0GsIK6XBqikwX\
hFriUSlQd0Fzc3AQ1mkstybRqzoCIJLvzyfw3YdbYuTfVGgUGG+\
edEzDTPB3jId8Vx0Aa+CUqmg6X2bWgW0i26EEM0FjAgxi2BkDxB01PqupQhJH/\
DVP0yiKAZIdkwFBAJYDJMMSL+6//\
8EAfIPpgTbhsfyhFYNbnmf6kFbykCCPuZ4cgUSDml4TzLEhfc7uzCU/x3hbyDCDguBS/\
7hntAoM1ZMXbtbdx7AwggIeMIIBuzCCAbcwggFdoAMCAQICFAep6a/8hKR/\
Xf8D7fMOi6OQH5W4MAoGCCqGSM49BAMCMDAxDTALBgNVBAoMBElFVEYxDTALBgNVBAsM\
BFJBVFMxEDAOBgNVBAMMB0FLIFAyNTYwIBcNMjUwMTE3MTcxNDI4WhgPMjA1MjA2MDQx\
NzE0MjhaMDAxDTALBgNVBAoMBElFVEYxDTALBgNVBAsMBFJBVFMxEDAOBgNVBAMMB0FL\
IFAyNTYwWTATBgcqhkjOPQIBBggqhkjOPQMBBwNCAARCJUj4j7eC/\
7Xso3REUscqHlWPvW9zvl5I6TIyzEXFsWxM0QxMuNW4oXE56UiCyJklcpk0JfQUGat+\
kKQqSUJyo1MwUTAdBgNVHQ4EFgQUW3CnmBf3n/\
Y30vfj3ERsIQnXu9QwHwYDVR0jBBgwFoAUW3CnmBf3n/\
Y30vfj3ERsIQnXu9QwDwYDVR0TAQH/BAUwAwEB/\
zAKBggqhkjOPQQDAgNIADBFAiEAkH8Erj/\
TLNoEfJIvokEEDVmhH5f7UQHdrrCyQWEhJegCICRsy/1Vqjo3qg/WrHospwcB2PaHYy+\
FnH79mznqO7jVMBMGByqGSM49AgEGCCqGSM49AwEHBEgwRgIhAOQWrySDZn5zNF7il+\
VjzxY55Bq5vc0B+Yhy/dsQHnedAiEA0GxuEFQpJkDuoYcyMKOZrwk2dgy/yAI6iih0+\
                                                              cX8W6g=
</pre><a href="#appendix-A-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="acknowledgements">
<section id="appendix-B">
      <h2 id="name-acknowledgements">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="appendix-B-1">This specification is the work of a design team created by the chairs
of the RATS working group. This specification has been developed
based on discussions in that design team and also with great amounts of
input taken from discussions on the RATS mailing list.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<p id="appendix-B-2">We would like to thank Jeff Andersen for the review comments.<a href="#appendix-B-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-C">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Mike Ounsworth</span></div>
<div dir="auto" class="left"><span class="org">Entrust Limited</span></div>
<div dir="auto" class="left"><span class="street-address">2500 Solandt Road - Suite 100</span></div>
<div dir="auto" class="left">
<span class="locality">Ottawa, Ontario</span>  <span class="postal-code">K2K 3G5</span>
</div>
<div dir="auto" class="left"><span class="country-name">Canada</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:mike.ounsworth@entrust.com" class="email">mike.ounsworth@entrust.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Jean-Pierre Fiset</span></div>
<div dir="auto" class="left"><span class="org">Crypto4A Inc.</span></div>
<div dir="auto" class="left"><span class="street-address">1550A Laperriere Ave</span></div>
<div dir="auto" class="left">
<span class="locality">Ottawa, Ontario</span>  <span class="postal-code">K1Z 7T2</span>
</div>
<div dir="auto" class="left"><span class="country-name">Canada</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:jp@crypto4a.com" class="email">jp@crypto4a.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Hannes Tschofenig</span></div>
<div dir="auto" class="left"><span class="org">University of Applied Sciences Bonn-Rhein-Sieg</span></div>
<div dir="auto" class="left"><span class="country-name">Germany</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:Hannes.Tschofenig@gmx.net" class="email">Hannes.Tschofenig@gmx.net</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Henk Birkholz</span></div>
<div dir="auto" class="left"><span class="org">Fraunhofer SIT</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:henk.birkholz@ietf.contact" class="email">henk.birkholz@ietf.contact</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Monty Wiseman</span></div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:mwiseman@computer.org" class="email">mwiseman@computer.org</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Ned Smith</span></div>
<div dir="auto" class="left"><span class="org">Intel Corporation</span></div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:ned.smith@intel.com" class="email">ned.smith@intel.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
